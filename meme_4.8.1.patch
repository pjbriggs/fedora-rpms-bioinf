# All patches from the MEME website combined into one for meme RPM
diff -r 0ef6797b9782 scripts/MotifUtils.pm
--- a/scripts/MotifUtils.pm	Fri Feb 10 17:34:05 2012 -0800
+++ b/scripts/MotifUtils.pm	Thu Feb 23 17:59:34 2012 -0800
@@ -369,7 +369,7 @@
   # initialize the counts with the pseudocounts
   foreach my $residue (@residues) {
     my $pseudocount = $bg->{$residue} * $pseudo_total;
-    for (my $i = 0; $i < $width; $i++) {
+    for (my $i = 0; $i < $height; $i++) {
       $motif_pspm->{$residue}->[$i] = $pseudocount;
     }
   }
# HG changeset patch
# User James Johnson <j.johnson@imb.uq.edu.au>
# Date 1329716601 -36000
# Node ID 1d50103047dd1b7baf4f41fb1b3d5cdbbc2681dc
# Parent  a111367593e3a9a3495d4a81b5976ec013ddf024
Made the motif diagrams in the MEME text output linewrap.

diff -r a111367593e3 -r 1d50103047dd src/display.c
--- a/src/display.c	Thu Feb 16 17:51:34 2012 -0800
+++ b/src/display.c	Mon Feb 20 15:43:21 2012 +1000
@@ -662,11 +662,30 @@
     char *name = s->sample_name;
     int lseq = s->length;
     char *sequence = s->seq;
+    int col, offset;
     TILING tiling = score_tile_diagram(NULL, sequence, lseq, los, nmotifs,
       dna, stype, FALSE, xlate_dna, best_motifs, TRUE, pv, m_thresh, w_thresh,
       use_seq_p, FALSE, NULL);
-    fprintf(outfile, "%-*.*s %16.2e  %s\n", MSN, MSN, name, tiling.pv,
-      tiling.diagram);
+    fprintf(outfile, "%-*.*s %16.2e  ", MSN, MSN, name, tiling.pv);
+    col = 43; offset = 0;
+    while (tiling.diagram[offset] != '\0') {
+      int j, max, last;
+      max = offset + (PAGEWIDTH - col - 1);
+      for (j = offset, last = offset; j < max; j++) {
+        if (tiling.diagram[j] == '\0') {
+          last = j;
+          break;
+        }
+        if (tiling.diagram[j] == '_') last = j+1;
+      }
+      if (tiling.diagram[last] != '\0') {
+        fprintf(outfile, "%.*s\\\n", (last-offset), tiling.diagram+offset); col = 0;
+        fputs("    ", outfile); col += 4;
+      } else {
+        fprintf(outfile, "%s\n", tiling.diagram+offset); col = 0;
+      }
+      offset = last;
+    }
     free_tiling(tiling);
   } /* sequence */
 
# HG changeset patch
# User James Johnson <j.johnson@imb.uq.edu.au>
# Date 1329808355 -36000
# Node ID 0098088505a9c1e7c04c15c91b0a845b4492a220
# Parent  1d50103047dd1b7baf4f41fb1b3d5cdbbc2681dc
Updated the motif reading code to allow for line breaks in the combined sites block diagrams.

diff -r 1d50103047dd -r 0098088505a9 src/motif-in-meme-html.c
--- a/src/motif-in-meme-html.c	Mon Feb 20 15:43:21 2012 +1000
+++ b/src/motif-in-meme-html.c	Tue Feb 21 17:12:35 2012 +1000
@@ -454,10 +454,10 @@
           "which is not a number.\n", type, name, value);
     } else if (errno == ERANGE) {
       if (sites == 0) {
-        error(parser, "The %s of motif %s has a number of sites value \"%s\" "
+        html_error(parser, "The %s of motif %s has a number of sites value \"%s\" "
             "which is too small to represent.\n", type, name, value);
       } else {
-        error(parser, "The %s of motif %s has a number of sites value \"%s\" "
+        html_error(parser, "The %s of motif %s has a number of sites value \"%s\" "
             "which is too large to represent.\n", type, name, value);
       }
     } else {
diff -r 1d50103047dd -r 0098088505a9 src/motif-in-meme-text.c
--- a/src/motif-in-meme-text.c	Mon Feb 20 15:43:21 2012 +1000
+++ b/src/motif-in-meme-text.c	Tue Feb 21 17:12:35 2012 +1000
@@ -25,6 +25,7 @@
   MTEXT_IN_PSSM,
   MTEXT_PRE_C_SITES,
   MTEXT_IN_C_SITES,
+  MTEXT_IN_C_SITES_BLOCKS,
   MTEXT_DONE
 };
 typedef enum mtext_state MTEXT_STATE_EN;
@@ -50,7 +51,10 @@
   int motif_count;
   struct minfo* motif_lookup;
   double scanned_sites_threshold;
-  ARRAYLST_T *scanned_sites;
+  SCANNED_SITE_T *ssite_buffer;
+  int ssite_allocated;
+  int ssite_used;
+  ARRAYLST_T *scanned_seqs;
 };
 
 struct mscope {
@@ -91,6 +95,7 @@
   regex_t s_sites_seq;
   regex_t s_sites_block;
   regex_t s_sites_offset;
+  regex_t s_sites_end;
 };
 
 typedef struct mtext MTEXT_T;
@@ -159,6 +164,7 @@
 static const char * C_SITES_BLOCK_RE = "^([[<])([-+]?)([0-9]+)([abc]?)\\("
     POS_NUM_RE "\\)([]>])";
 static const char * C_SITES_OFFSET_RE = "^([0-9]+)";
+static const char * C_SITES_END_RE = "^\\\\$";
 
 
 /*
@@ -192,6 +198,7 @@
   regcomp_or_die("c sites seq", &(re->s_sites_seq), C_SITES_SEQ_RE, REG_EXTENDED);
   regcomp_or_die("c sites block", &(re->s_sites_block), C_SITES_BLOCK_RE, REG_EXTENDED);
   regcomp_or_die("c sites offset", &(re->s_sites_offset), C_SITES_OFFSET_RE, REG_EXTENDED);
+  regcomp_or_die("c sites offset", &(re->s_sites_end), C_SITES_END_RE, REG_EXTENDED);
 }
 
 /*
@@ -225,6 +232,7 @@
   regfree(&(re->s_sites_seq));
   regfree(&(re->s_sites_block));
   regfree(&(re->s_sites_offset));
+  regfree(&(re->s_sites_end));
 }
 
 /*
@@ -248,6 +256,7 @@
   }
   if (fscope->letter_freqs) free_array(fscope->letter_freqs);
   if (fscope->motif_lookup) free(fscope->motif_lookup);
+  if (fscope->ssite_buffer) free(fscope->ssite_buffer);
 }
 
 /*
@@ -987,83 +996,81 @@
   }
 }
 
-static BOOLEAN_T count_sites(MTEXT_T *parser, const char *blocks, int *seq_site_count, int* seq_length) {
+static BOOLEAN_T state_in_s_sites_blocks(MTEXT_T *parser, const char *line) {
+  SCANNED_SEQ_T *sseq;
+  int i;
+  BOOLEAN_T continued;
+  const char *substr;
   regmatch_t matches[8];
-  const char *substr;
-  int motif_i;
-  // count the number of sites and calculate the sequence length
-  substr = blocks;
-  *seq_site_count = 0;
-  *seq_length = 0;
+  
+  substr = line;
+  // skip leading whitespace
+  while (isspace(*substr)) substr++;
+  // get the scanned sequence object to store this information
+  if (parser->options & SCANNED_SITES) {
+    sseq = arraylst_get(arraylst_size(parser->fscope.scanned_seqs) - 1, 
+        parser->fscope.scanned_seqs);
+  } else {
+    sseq = NULL;
+  }
+  // tally up the components and check the structure
   while (*substr != '\0') {
     if (regexec_or_die("c sites block", &(parser->re.s_sites_block), substr, 8, matches, 0)) {
-      if ((regex_chr(matches+1, substr) == '[' && 
-            regex_chr(matches+7, substr) == '>') ||
-          (regex_chr(matches+1, substr) == '<' && 
-           regex_chr(matches+7, substr) == ']')) {
+      int motif_i;
+      // found a motif, check the brackets surrounding it match
+      // left bracket + 2 = right bracket in ascii
+      if ((regex_chr(matches+1, substr) + 2) != regex_chr(matches+7, substr)) {
         error(parser, "Brackets don't match!\n");
-        return FALSE;
+        return TRUE;
       }
+      // get the index of the motif
       motif_i = regex_int(matches+3, substr, 0) - 1; // turn into index
       if (motif_i < 0 || motif_i >= parser->fscope.motif_count) {
         error(parser, "Bad motif number %d in scanned sites.\n", motif_i +1);
-        return FALSE;
+        return TRUE;
       }
       if (parser->options & SCANNED_SITES) {
-        // motif_lookup is not avaliable unless SCANNED_SITES is set
-        *seq_length += parser->fscope.motif_lookup[motif_i].length;
-        (*seq_site_count)++;
+        BOOLEAN_T isstrong;
+        char strand;
+        double pvalue;
+        int motif_len;
+        motif_len = parser->fscope.motif_lookup[motif_i].length;
+        strand = regex_chr(matches+2, substr);
+        pvalue = regex_dbl(matches+5, substr); 
+        sseq_add_site(sseq, motif_i + 1, motif_len, strand, pvalue);
+      }
+      // move over the motif
+      substr += matches[0].rm_eo;
+    } else if (regexec_or_die("c sites offset", &(parser->re.s_sites_offset), substr, 2, matches, 0)) {
+      // found a part of the sequence with no motifs
+      if (parser->options & SCANNED_SITES) {
+        sseq_add_spacer(sseq, regex_int(matches+1, substr, 0));
       }
       substr += matches[0].rm_eo;
-    } else if (regexec_or_die("c sites offset", &(parser->re.s_sites_offset), substr, 2, matches, 0)) {
-      if (parser->options & SCANNED_SITES) {
-        *seq_length += regex_int(matches+1, substr, 0);
-      }
-      substr += matches[0].rm_eo;
-    } else if (!regexec_or_die("whitespace", &(parser->re.whitespace), substr, 0, matches, 0)) {
-      error(parser, "Expected whitespace at end of combined sites line but got: %s\n", substr);
-      return FALSE;
+    } else if (regexec_or_die("c sites end", &(parser->re.s_sites_end), substr, 0, matches, 0)) {
+      // found a line continuation indicator
+      continued = TRUE;
+      substr++;
+      break;
+    } else {
+      error(parser, "Unexpected text in combined sites: %s\n", substr);
+      return TRUE;
     }
-    if (*substr == '_') substr++;
+    if (*substr == '_') {
+      substr++;
+    } else if (*substr != '\0') {
+      error(parser, "Expected underscore!\n");
+      return TRUE;
+    }
+  }
+  if (continued) {
+    parser->state = MTEXT_IN_C_SITES_BLOCKS;
+  } else {
+    parser->state = MTEXT_IN_C_SITES;
   }
   return TRUE;
 }
 
-/*
- * Note this function is only called when SCANNED_SITES option is set
- */
-static void parse_sites(MTEXT_T *parser, const char *blocks, int seq_site_count, int seq_length, SCANNED_SEQ_T *sseq) {
-  regmatch_t matches[8];
-  const char *substr;
-  int offset, site_i, motif_num;
-  BOOLEAN_T site_strong;
-  char site_strand, site_frame;
-  double site_pvalue;
-  // read the scanned sites this time
-  substr = blocks;
-  offset = 0;
-  site_i = 0;
-  while (*substr != '\0') {
-    if (regexec_or_die("c sites block", &(parser->re.s_sites_block), substr, 8, matches, 0)) {
-      motif_num = regex_int(matches+3, substr, 0); // turn into index
-
-      site_strong = (regex_chr(matches+1, substr) == '[');
-      site_strand = regex_chr(matches+2, substr);
-      site_frame = regex_chr(matches+4, substr);
-      site_pvalue = regex_dbl(matches+5, substr); 
-
-      sseq_set(sseq, site_i++, motif_num, site_strand, offset, site_pvalue);
-
-      offset += parser->fscope.motif_lookup[motif_num - 1].length;
-      substr += matches[0].rm_eo;
-    } else if (regexec_or_die("c sites offset", &(parser->re.s_sites_offset), substr, 2, matches, 0)) {
-      offset += regex_int(matches+1, substr, 0);
-      substr += matches[0].rm_eo;
-    }      
-    if (*substr == '_') substr++;
-  }
-}
-
 static BOOLEAN_T state_in_s_sites(MTEXT_T *parser, const char *line) {
   regmatch_t matches[8];
   const char *blocks, *substr;
@@ -1073,25 +1080,19 @@
   SCANNED_SEQ_T *sseq;
 
   if (parser->options & SCANNED_SITES) {
-    if (!parser->fscope.scanned_sites) 
-      parser->fscope.scanned_sites = arraylst_create();
+    if (!parser->fscope.scanned_seqs) 
+      parser->fscope.scanned_seqs = arraylst_create();
   }
 
   if (regexec_or_die("c sites seq", &(parser->re.s_sites_seq), line, 5, matches, 0)) {
     blocks = line+(matches[4].rm_so);
-
-    if (!count_sites(parser, blocks, &seq_site_count, &seq_length)) return TRUE;
-
-    if (parser->options & SCANNED_SITES) {
-      seq_id = regex_str(matches+1, line);  
-      seq_pvalue = regex_dbl(matches+2, line);
-      sseq = sseq_create(seq_id, seq_length, seq_pvalue, seq_site_count);
-      free(seq_id);
-
-      parse_sites(parser, blocks, seq_site_count, seq_length, sseq);
-
-      arraylst_add(sseq, parser->fscope.scanned_sites);
-    }
+    seq_id = regex_str(matches+1, line);  
+    seq_pvalue = regex_dbl(matches+2, line);
+    sseq = sseq_create2(seq_id, seq_pvalue);
+    free(seq_id);
+    if (parser->options & SCANNED_SITES) 
+      arraylst_add(sseq, parser->fscope.scanned_seqs);
+    return state_in_s_sites_blocks(parser, blocks);
   } else if (regexec_or_die("dashes", &(parser->re.s_sites_dashes), line, 0, matches, 0)) {
     if (parser->options & SCANNED_SITES) parser->fscope.options_found |= SCANNED_SITES;
     parser->state = MTEXT_DONE;
@@ -1143,6 +1144,9 @@
       case MTEXT_IN_C_SITES:
         consumed = state_in_s_sites(parser, line);
         break;
+      case MTEXT_IN_C_SITES_BLOCKS:
+        consumed = state_in_s_sites_blocks(parser, line);
+        break;
       case MTEXT_DONE:
         consumed = TRUE;
         break;//do nothing
@@ -1302,7 +1306,7 @@
   }
   switch (option) {
     case SCANNED_SITES:
-      return parser->fscope.scanned_sites;
+      return parser->fscope.scanned_seqs;
     default:
       die("Option code %d does not match any single option. "
           "This means that it must contain multiple options "
diff -r 1d50103047dd -r 0098088505a9 src/scanned-sequence.c
--- a/src/scanned-sequence.c	Mon Feb 20 15:43:21 2012 +1000
+++ b/src/scanned-sequence.c	Tue Feb 21 17:12:35 2012 +1000
@@ -23,6 +23,22 @@
 }
 
 /*
+ * Create a scanned sequence structure.
+ * The seq_id is copied. The length is initially set to
+ * zero as are the number of allocated sites. This is intended
+ * to be used with the sseq_add_site and sseq_add_spacer methods
+ * to build up the correct length and sites
+ */
+SCANNED_SEQ_T* sseq_create2(const char *seq_id, double pvalue) {
+  SCANNED_SEQ_T *sseq;
+  sseq = mm_malloc(sizeof(SCANNED_SEQ_T));
+  memset(sseq, 0, sizeof(SCANNED_SEQ_T));
+  sseq->seq_id = strdup(seq_id);
+  sseq->pvalue = pvalue;
+  return sseq;
+}
+
+/*
  * Destroy the scanned sequence structure and all included scanned 
  * site structures.
  */
@@ -48,3 +64,25 @@
   ssite->position = position;
   ssite->pvalue = pvalue;
 }
+
+/*
+ * Add a scanned site. Intended to be used with sseq_create2
+ */
+void sseq_add_site(SCANNED_SEQ_T *sseq, int motif_num, int motif_len, char strand, double pvalue) {
+  SCANNED_SITE_T *ssite;
+  sseq->site_count += 1;
+  sseq->sites = mm_realloc(sseq->sites, sseq->site_count * sizeof(SCANNED_SEQ_T));
+  ssite = sseq->sites+(sseq->site_count - 1);
+  ssite->m_num = motif_num;
+  ssite->position = sseq->length;
+  ssite->strand = strand;
+  ssite->pvalue = pvalue;
+  sseq->length += motif_len;
+}
+
+/*
+ * Add a spacer. Intended to be used with sseq_create2
+ */
+void sseq_add_spacer(SCANNED_SEQ_T *sseq, int spacer_len) {
+  sseq->length += spacer_len;
+}
diff -r 1d50103047dd -r 0098088505a9 src/scanned-sequence.h
--- a/src/scanned-sequence.h	Mon Feb 20 15:43:21 2012 +1000
+++ b/src/scanned-sequence.h	Tue Feb 21 17:12:35 2012 +1000
@@ -25,6 +25,14 @@
  */
 SCANNED_SEQ_T* sseq_create(const char *seq_id, long length, double pvalue, 
     long site_count);
+/*
+ * Create a scanned sequence structure.
+ * The seq_id is copied. The length is initially set to
+ * zero as are the number of allocated sites. This is intended
+ * to be used with the sseq_add_site and sseq_add_spacer methods
+ * to build up the correct length and sites
+ */
+SCANNED_SEQ_T* sseq_create2(const char *seq_id, double pvalue);
 
 /*
  * Destroy the scanned sequence structure and all included scanned 
@@ -38,4 +46,14 @@
 void sseq_set(SCANNED_SEQ_T *sseq, int index, int m_num,
     char strand, long position, double pvalue);
 
+/*
+ * Add a scanned site. Intended to be used with sseq_create2
+ */
+void sseq_add_site(SCANNED_SEQ_T *sseq, int motif_num, int motif_len, char strand, double pvalue);
+
+/*
+ * Add a spacer. Intended to be used with sseq_create2
+ */
+void sseq_add_spacer(SCANNED_SEQ_T *sseq, int spacer_len);
+
 #endif
# HG changeset patch
# User James Johnson <j.johnson@imb.uq.edu.au>
# Date 1329875186 -36000
# Node ID d57b03b5217dbfcc6439c7b91b327b27b8df4396
# Parent  0098088505a9c1e7c04c15c91b0a845b4492a220
Fixed an unallocated variable in the motif-in-meme-text parser which annoyingly the compiler didn't complain about.

Also fixed a memory leak in fimo (not deallocating the motif parser) and a
(unimportant I think) memory bug in alignment.c

diff -r 0098088505a9 -r d57b03b5217d src/alignment.c
--- a/src/alignment.c	Tue Feb 21 17:12:35 2012 +1000
+++ b/src/alignment.c	Wed Feb 22 11:46:26 2012 +1000
@@ -62,12 +62,16 @@
       fprintf(stderr, "Warning: truncating alignment program name %s to %s.\n",
 	      name, new_alignment->name);
     }
+  } else {
+    new_alignment->name[0] = '\0';
   }
 
   // Store the description, truncating if necessary.
   if (description != NULL) {
     strncpy(new_alignment->desc, description, MAX_ALIGNMENT_COMMENT);
     new_alignment->desc[MAX_ALIGNMENT_COMMENT] = '\0';
+  } else {
+    new_alignment->desc[0] = '\0';
   }
 
   // Store the sequences.
diff -r 0098088505a9 -r d57b03b5217d src/fimo.c
--- a/src/fimo.c	Tue Feb 21 17:12:35 2012 +1000
+++ b/src/fimo.c	Wed Feb 22 11:46:26 2012 +1000
@@ -959,6 +959,7 @@
   motifs = mread_load(mread, NULL);
   options.alphabet = mread_get_alphabet(mread);
   bg_freqs = mread_get_background(mread);
+  mread_destroy(mread);
 
   // Doesn't include rev comp motifs
   int num_motif_names = arraylst_size(motifs);
diff -r 0098088505a9 -r d57b03b5217d src/motif-in-meme-text.c
--- a/src/motif-in-meme-text.c	Tue Feb 21 17:12:35 2012 +1000
+++ b/src/motif-in-meme-text.c	Wed Feb 22 11:46:26 2012 +1000
@@ -118,7 +118,7 @@
 static const char * VERSION_RE = "^[[:space:]]*MEME[[:space:]]+version"
     "[[:space:]]+([0-9]+)(\\.([0-9]+)(\\.([0-9]+))?)?([^0-9].*)?$";
 static const char * RELEASE_RE ="[[:space:]]+\\(Release[[:space:]]+date:"
-    "[[:space:]]+([^[:space:]][^\\)]+)\\)";
+    "[[:space:]]+(.+)\\)[[:space:]]*$";
 static const char * DATAFILE_RE = "^[[:space:]]*DATAFILE[[:space:]]*="
     "[[:space:]]*([^[:space:]].*)$";
 static const char * ALPHABET_RE = "^[[:space:]]*ALPHABET[[:space:]]*="
@@ -664,9 +664,11 @@
  */
 static BOOLEAN_T state_find_version(MTEXT_T *parser, const char *line) {
   regmatch_t matches[7];
+  memset(matches, 0, sizeof(regmatch_t)*7);
   if (regexec_or_die("html", &(parser->re.html), line, 0, matches, 0)) {
     parser->fscope.is_html = TRUE; 
   }
+  memset(matches, 0, sizeof(regmatch_t)*7);
   if (regexec_or_die("version", &(parser->re.version), line, 7, matches, 0)) {
     parser->fscope.vmajor = regex_int(matches+1, line, 0);
     parser->fscope.vminor = regex_int(matches+3, line, 0);
@@ -1003,6 +1005,7 @@
   const char *substr;
   regmatch_t matches[8];
   
+  continued = FALSE;
   substr = line;
   // skip leading whitespace
   while (isspace(*substr)) substr++;
@@ -1086,12 +1089,12 @@
 
   if (regexec_or_die("c sites seq", &(parser->re.s_sites_seq), line, 5, matches, 0)) {
     blocks = line+(matches[4].rm_so);
-    seq_id = regex_str(matches+1, line);  
-    seq_pvalue = regex_dbl(matches+2, line);
-    sseq = sseq_create2(seq_id, seq_pvalue);
-    free(seq_id);
-    if (parser->options & SCANNED_SITES) 
+    if (parser->options & SCANNED_SITES)  {
+      seq_id = regex_str(matches+1, line);  
+      seq_pvalue = regex_dbl(matches+2, line);
+      sseq = sseq_create2(seq_id, seq_pvalue);
       arraylst_add(sseq, parser->fscope.scanned_seqs);
+    }
     return state_in_s_sites_blocks(parser, blocks);
   } else if (regexec_or_die("dashes", &(parser->re.s_sites_dashes), line, 0, matches, 0)) {
     if (parser->options & SCANNED_SITES) parser->fscope.options_found |= SCANNED_SITES;
diff -r 0098088505a9 -r d57b03b5217d src/scanned-sequence.c
--- a/src/scanned-sequence.c	Tue Feb 21 17:12:35 2012 +1000
+++ b/src/scanned-sequence.c	Wed Feb 22 11:46:26 2012 +1000
@@ -24,16 +24,16 @@
 
 /*
  * Create a scanned sequence structure.
- * The seq_id is copied. The length is initially set to
+ * The seq_id is used (not copied). The length is initially set to
  * zero as are the number of allocated sites. This is intended
  * to be used with the sseq_add_site and sseq_add_spacer methods
  * to build up the correct length and sites
  */
-SCANNED_SEQ_T* sseq_create2(const char *seq_id, double pvalue) {
+SCANNED_SEQ_T* sseq_create2(char *seq_id, double pvalue) {
   SCANNED_SEQ_T *sseq;
   sseq = mm_malloc(sizeof(SCANNED_SEQ_T));
   memset(sseq, 0, sizeof(SCANNED_SEQ_T));
-  sseq->seq_id = strdup(seq_id);
+  sseq->seq_id = seq_id;
   sseq->pvalue = pvalue;
   return sseq;
 }
diff -r 0098088505a9 -r d57b03b5217d src/scanned-sequence.h
--- a/src/scanned-sequence.h	Tue Feb 21 17:12:35 2012 +1000
+++ b/src/scanned-sequence.h	Wed Feb 22 11:46:26 2012 +1000
@@ -27,12 +27,12 @@
     long site_count);
 /*
  * Create a scanned sequence structure.
- * The seq_id is copied. The length is initially set to
+ * The seq_id is used (not copied). The length is initially set to
  * zero as are the number of allocated sites. This is intended
  * to be used with the sseq_add_site and sseq_add_spacer methods
  * to build up the correct length and sites
  */
-SCANNED_SEQ_T* sseq_create2(const char *seq_id, double pvalue);
+SCANNED_SEQ_T* sseq_create2(char *seq_id, double pvalue);
 
 /*
  * Destroy the scanned sequence structure and all included scanned 
# HG changeset patch
# User James Johnson <j.johnson@imb.uq.edu.au>
# Date 1329878883 -36000
# Node ID 5836e70b683453aef651d1d48929dc3ccbe33e4f
# Parent  d57b03b5217dbfcc6439c7b91b327b27b8df4396
Replaced instances of ETC_DIR with calls to get_meme_etc_dir().

diff -r d57b03b5217d -r 5836e70b6834 src/beadstring.c
--- a/src/beadstring.c	Wed Feb 22 11:46:26 2012 +1000
+++ b/src/beadstring.c	Wed Feb 22 12:48:03 2012 +1000
@@ -743,10 +743,10 @@
     const char *GFF_FILENAME = "beadstring.gff";
     char *sequence_path = make_path_to_file(options->output_dirname, SEQUENCE_FILENAME);
     char *cisml_path = make_path_to_file(options->output_dirname, CISML_FILENAME);
-    char *html_stylesheet_path = make_path_to_file(ETC_DIR, HTML_STYLESHEET);
-    char *css_stylesheet_path = make_path_to_file(ETC_DIR, CSS_STYLESHEET);
-    char *text_stylesheet_path = make_path_to_file(ETC_DIR, TEXT_STYLESHEET);
-    char *gff_stylesheet_path = make_path_to_file(ETC_DIR, GFF_STYLESHEET);
+    char *html_stylesheet_path = make_path_to_file(get_meme_etc_dir(), HTML_STYLESHEET);
+    char *css_stylesheet_path = make_path_to_file(get_meme_etc_dir(), CSS_STYLESHEET);
+    char *text_stylesheet_path = make_path_to_file(get_meme_etc_dir(), TEXT_STYLESHEET);
+    char *gff_stylesheet_path = make_path_to_file(get_meme_etc_dir(), GFF_STYLESHEET);
     char *html_path = make_path_to_file(options->output_dirname, HTML_FILENAME);
     char *text_path = make_path_to_file(options->output_dirname, TEXT_FILENAME);
     char *gff_path = make_path_to_file(options->output_dirname, GFF_FILENAME);
diff -r d57b03b5217d -r 5836e70b6834 src/ceqlogo.c
--- a/src/ceqlogo.c	Wed Feb 22 11:46:26 2012 +1000
+++ b/src/ceqlogo.c	Wed Feb 22 12:48:03 2012 +1000
@@ -53,9 +53,9 @@
 
 /* ----------------------- Global Constants ---------------------------- */
 /* Path to the template file */
-#define TEMPLATE_SVG ETC_DIR"/template.svg"
+#define TEMPLATE_SVG "template.svg"
 /* Path to the template file */
-#define TEMPLATE_EPS ETC_DIR"/template.eps"
+#define TEMPLATE_EPS "template.eps"
 /* Flags to pass to Ghostscript */
 #define GHOSTSCRIPT_FLAGS " -q -r100 -dSAFER -dBATCH -dNOPAUSE " \
   "-dDOINTERPOLATE -sDEVICE=pngalpha -dBackgroundColor=16#FFFFFF " \
@@ -2071,6 +2071,7 @@
 
 void SVG_exit(LP_PARAMS_T* params, FILE *fout) {
   int    lnr;
+  char*  template;
   char*  data     = LP_get_value(params, "$DATA");
   double fs       = LP_get_doublevalue(params, "$FONTSIZE");
   double tfs      = LP_get_doublevalue(params, "$TITLEFONTSIZE");
@@ -2105,9 +2106,11 @@
 
   params->values[LP_get_index(params,"$DATA")] = data;
 
-  FILE *fin  = F_open(TEMPLATE_SVG, "r");
+  template = make_path_to_file(get_meme_etc_dir(), TEMPLATE_SVG);
+  FILE *fin  = F_open(template, "r");
     LP_file_replace(params, fin, fout, 1000);
   F_close(fin);
+  free(template);
 
   params->initialized = 0;
 }
@@ -2237,6 +2240,7 @@
 /*.......................................................................*/
 
 void EPS_exit(LP_PARAMS_T* params, FILE *fout) {
+  char*  template;
   char   buffer[1000];
   int    lnr;
   char*  data       = LP_get_value(params, "$DATA");
@@ -2307,9 +2311,11 @@
   LP_set_doublevalue(params, "$LOGOLINEHEIGHT", height/params->l_num);
   LP_set_intvalue(params, "$CHARSPERLINE", maxcharnum);
 
-  FILE *fin  = F_open(TEMPLATE_EPS, "r");
+  template = make_path_to_file(get_meme_etc_dir(), TEMPLATE_EPS);
+  FILE *fin  = F_open(template, "r");
     LP_file_replace(params, fin, fout, 1000);
   F_close(fin);
+  free(template);
 
   params->initialized = 0;
 }
diff -r d57b03b5217d -r 5836e70b6834 src/cisml.c
--- a/src/cisml.c	Wed Feb 22 11:46:26 2012 +1000
+++ b/src/cisml.c	Wed Feb 22 12:48:03 2012 +1000
@@ -23,6 +23,7 @@
 #include "qvalue.h"
 #include "xml-util.h"
 #include "cisml-dtd.h"
+#include "utils.h"
 
 #include "array.h"
 const int PATTERN_INCREMENT = 5;
@@ -3720,10 +3721,10 @@
   const char* CSS_STYLESHEET = "cisml.css";
   const char* GFF_STYLESHEET = "cisml-to-gff.xsl";
   const char* TEXT_STYLESHEET = "cisml-to-text.xsl";
-  char *html_stylesheet_path = make_path_to_file(ETC_DIR, HTML_STYLESHEET);
-  char *css_stylesheet_path = make_path_to_file(ETC_DIR, CSS_STYLESHEET);
-  char *text_stylesheet_path = make_path_to_file(ETC_DIR, TEXT_STYLESHEET);
-  char *gff_stylesheet_path = make_path_to_file(ETC_DIR, GFF_STYLESHEET);
+  char *html_stylesheet_path = make_path_to_file(get_meme_etc_dir(), HTML_STYLESHEET);
+  char *css_stylesheet_path = make_path_to_file(get_meme_etc_dir(), CSS_STYLESHEET);
+  char *text_stylesheet_path = make_path_to_file(get_meme_etc_dir(), TEXT_STYLESHEET);
+  char *gff_stylesheet_path = make_path_to_file(get_meme_etc_dir(), GFF_STYLESHEET);
   char *xml_path = make_path_to_file(output_dirname, xml_filename);
   char *html_path = make_path_to_file(output_dirname, html_filename);
   char *text_path = make_path_to_file(output_dirname, text_filename);
diff -r d57b03b5217d -r 5836e70b6834 src/fimo.c
--- a/src/fimo.c	Wed Feb 22 11:46:26 2012 +1000
+++ b/src/fimo.c	Wed Feb 22 12:48:03 2012 +1000
@@ -367,17 +367,17 @@
   options->WIGGLE_FILENAME = "fimo.wig";
   options->FIMO_FILENAME = "fimo.xml";
   options->CISML_FILENAME = "cisml.xml";
-  options->text_stylesheet_path = make_path_to_file(ETC_DIR, options->TEXT_STYLESHEET);
-  options->gff_stylesheet_path = make_path_to_file(ETC_DIR, options->GFF_STYLESHEET);
-  options->wiggle_stylesheet_path = make_path_to_file(ETC_DIR, options->WIGGLE_STYLESHEET);
+  options->text_stylesheet_path = make_path_to_file(get_meme_etc_dir(), options->TEXT_STYLESHEET);
+  options->gff_stylesheet_path = make_path_to_file(get_meme_etc_dir(), options->GFF_STYLESHEET);
+  options->wiggle_stylesheet_path = make_path_to_file(get_meme_etc_dir(), options->WIGGLE_STYLESHEET);
   options->html_path = make_path_to_file(options->output_dirname, options->HTML_FILENAME);
   options->text_path = make_path_to_file(options->output_dirname, options->TEXT_FILENAME);
   options->gff_path = make_path_to_file(options->output_dirname, options->GFF_FILENAME);
   options->wiggle_path = make_path_to_file(options->output_dirname, options->WIGGLE_FILENAME);
-  options->html_stylesheet_path = make_path_to_file(ETC_DIR, options->HTML_STYLESHEET);
+  options->html_stylesheet_path = make_path_to_file(get_meme_etc_dir(), options->HTML_STYLESHEET);
   options->html_stylesheet_local_path
     = make_path_to_file(options->output_dirname, options->HTML_STYLESHEET);
-  options->css_stylesheet_path = make_path_to_file(ETC_DIR, options->CSS_STYLESHEET);
+  options->css_stylesheet_path = make_path_to_file(get_meme_etc_dir(), options->CSS_STYLESHEET);
   options->css_stylesheet_local_path
     = make_path_to_file(options->output_dirname, options->CSS_STYLESHEET);
   options->fimo_path = make_path_to_file(options->output_dirname, options->FIMO_FILENAME);
diff -r d57b03b5217d -r 5836e70b6834 src/gomo.c
--- a/src/gomo.c	Wed Feb 22 11:46:26 2012 +1000
+++ b/src/gomo.c	Wed Feb 22 12:48:03 2012 +1000
@@ -1949,7 +1949,7 @@
       exit(1);
     }
     //copy the question mark image
-    clone_file(ETC_DIR, HELP_IMG, res_dir, HELP_IMG);
+    clone_file(get_meme_etc_dir(), HELP_IMG, res_dir, HELP_IMG);
     // Create the name of the text output file
     // "<dir>/XML_FILENAME" and open it for writing
     xml_path = make_path_to_file(out_dir, XML_FILENAME);
@@ -2042,7 +2042,7 @@
     // html files become to big for non-constrainted q-values
     if (q_threshold <= 0.5) {
       char *stylesheet_path, *html_path;
-      stylesheet_path = make_path_to_file(ETC_DIR, HTML_STYLESHEET);
+      stylesheet_path = make_path_to_file(get_meme_etc_dir(), HTML_STYLESHEET);
       html_path = make_path_to_file(out_dir, HTML_FILENAME);
       if (file_exists(stylesheet_path)) {
         print_xml_filename_to_filename_using_stylesheet(
diff -r d57b03b5217d -r 5836e70b6834 src/mast.c
--- a/src/mast.c	Wed Feb 22 11:46:26 2012 +1000
+++ b/src/mast.c	Wed Feb 22 12:48:03 2012 +1000
@@ -1987,7 +1987,7 @@
   //output alternate formats
   if (xml_path && html) {
     char *stylesheet_path, *html_path;
-    stylesheet_path = make_path_to_file(ETC_DIR, HTML_STYLESHEET);
+    stylesheet_path = make_path_to_file(get_meme_etc_dir(), HTML_STYLESHEET);
     html_path = make_path_to_file(out_dir, HTML_FILENAME);
     if (file_exists(stylesheet_path)) {
       print_xml_filename_to_filename_using_stylesheet(
diff -r d57b03b5217d -r 5836e70b6834 src/meme.c
--- a/src/meme.c	Wed Feb 22 11:46:26 2012 +1000
+++ b/src/meme.c	Wed Feb 22 12:48:03 2012 +1000
@@ -472,10 +472,10 @@
 #ifdef DEBUG_PARALLEL
   fprintf(stderr, "%d: At make_path_to_file\n", mpMyID()); fflush(stderr);
 #endif
-    char * stylesheet_path = make_path_to_file(ETC_DIR, stylesheet_filename);
+    char * stylesheet_path = make_path_to_file(get_meme_etc_dir(), stylesheet_filename);
     char * xml_path = make_path_to_file(output_dirname, xml_filename);
     char * html_path = make_path_to_file(output_dirname, html_filename);
-    char * helpimg_path = make_path_to_file(ETC_DIR, helpimg_filename);
+    char * helpimg_path = make_path_to_file(get_meme_etc_dir(), helpimg_filename);
     char * helpimg_copy_path = make_path_to_file(output_dirname, helpimg_filename);
 #ifdef DEBUG_PARALLEL
   fprintf(stderr, "%d: At print_meme_file_xml\n", mpMyID()); fflush(stderr);
diff -r d57b03b5217d -r 5836e70b6834 src/spamo-output.c
--- a/src/spamo-output.c	Wed Feb 22 11:46:26 2012 +1000
+++ b/src/spamo-output.c	Wed Feb 22 12:48:03 2012 +1000
@@ -9,6 +9,7 @@
 #include "eps2png.h"
 #include "spamo-output.h"
 #include "string-builder.h"
+#include "utils.h"
 #include "xml-out.h"
 #include "seq-reader-from-fasta.h"
 
@@ -408,7 +409,7 @@
   //check that histograms are actually wanted
   if (!(make_eps || make_png)) return;
   //check that we have access to the template, otherwise we can't create any histograms
-  template_path = make_path_to_file(ETC_DIR, SPAMO_EPS_TEMPLATE_FILE);
+  template_path = make_path_to_file(get_meme_etc_dir(), SPAMO_EPS_TEMPLATE_FILE);
   if (!file_exists(template_path)) {
     fprintf(stderr, "Warning: Can not find SpaMo histogram template file \"%s\". Skiping creation of histograms.\n", template_path);
     free(template_path);
diff -r d57b03b5217d -r 5836e70b6834 src/spamo.c
--- a/src/spamo.c	Wed Feb 22 11:46:26 2012 +1000
+++ b/src/spamo.c	Wed Feb 22 12:48:03 2012 +1000
@@ -1288,7 +1288,7 @@
   char *xsl_path, *xml_path, *html_path;
   if (!options->xslt) return;
   xml_path = make_path_to_file(options->outdir, SPAMO_XML_FILE);
-  xsl_path = make_path_to_file(ETC_DIR, SPAMO_XSL_FILE);
+  xsl_path = make_path_to_file(get_meme_etc_dir(), SPAMO_XSL_FILE);
   html_path = make_path_to_file(options->outdir, SPAMO_HTML_FILE);
   if (!file_exists(xsl_path)) {
     fprintf(stderr, "Warning: Can not find SpaMo xml to html stylesheet file \"%s\". Skiping creation of html.\n", xsl_path);
diff -r d57b03b5217d -r 5836e70b6834 src/tomtom.c
--- a/src/tomtom.c	Wed Feb 22 11:46:26 2012 +1000
+++ b/src/tomtom.c	Wed Feb 22 12:48:03 2012 +1000
@@ -2768,7 +2768,7 @@
     //generate html from xml
     if (html) {
       char *stylesheet_path, *html_path;
-      stylesheet_path = make_path_to_file(ETC_DIR, HTML_STYLESHEET);
+      stylesheet_path = make_path_to_file(get_meme_etc_dir(), HTML_STYLESHEET);
       html_path = make_path_to_file(output_dirname, HTML_FILENAME);
       if (file_exists(stylesheet_path)) {
         print_xml_filename_to_filename_using_stylesheet(
# HG changeset patch
# User James Johnson <j.johnson@imb.uq.edu.au>
# Date 1329885982 -36000
# Node ID 81f90e1597b487144ea82df256c8b1eccd8a3923
# Parent  5836e70b683453aef651d1d48929dc3ccbe33e4f
Updated meme tests.

diff -r 5836e70b6834 -r 81f90e1597b4 tests/meme/meme.INO_up800.oops
--- a/tests/meme/meme.INO_up800.oops	Wed Feb 22 12:48:03 2012 +1000
+++ b/tests/meme/meme.INO_up800.oops	Wed Feb 22 14:46:22 2012 +1000
@@ -1,7 +1,7 @@
 ********************************************************************************
 MEME - Motif discovery tool
 ********************************************************************************
-MEME version 4.0.0 (Release date: 2008-07-12 05:23:09 +1000 (Sat, 12 Jul 2008))
+MEME version 4.8.1 (Release date: Wed Feb 22 11:51:06 EST 2012)
 
 For further information on how to interpret these results or to get
 a copy of the MEME software please access http://meme.nbcr.net.
@@ -28,7 +28,7 @@
 ********************************************************************************
 TRAINING SET
 ********************************************************************************
-DATAFILE= /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/INO_up800.s
+DATAFILE= /home/james/dist/scripts/../tests/common/INO_up800.s
 ALPHABET= ACGT
 Sequence name            Weight Length  Sequence name            Weight Length  
 -------------            ------ ------  -------------            ------ ------  
@@ -44,7 +44,7 @@
 This information can also be useful in the event you wish to report a
 problem with the MEME software.
 
-command: meme /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/INO_up800.s -text -mod oops -dna -revcomp -bfile /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/yeast.nc.6.freq -x_branch -nostatus -nmotifs 2 -minw 8 
+command: meme /home/james/dist/scripts/../tests/common/INO_up800.s -text -mod oops -dna -revcomp -bfile /home/james/dist/scripts/../tests/common/yeast.nc.6.freq -x_branch -nostatus -nmotifs 2 -minw 8 
 
 model:  mod=          oops    nmotifs=         2    evt=           inf
 object function=  E-value of product of p-values
@@ -61,7 +61,7 @@
 sample: seed=            0    seqfrac=         1
 Letter frequencies in dataset:
 A 0.304 C 0.196 G 0.196 T 0.304 
-Background letter frequencies (from /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/yeast.nc.6.freq):
+Background letter frequencies (from /home/james/dist/scripts/../tests/common/yeast.nc.6.freq):
 A 0.324 C 0.176 G 0.176 T 0.324 
 ********************************************************************************
 
@@ -193,7 +193,7 @@
 
 
 
-Time 12.74 secs.
+Time  9.08 secs.
 
 ********************************************************************************
 
@@ -311,7 +311,7 @@
 
 
 
-Time 25.15 secs.
+Time 17.88 secs.
 
 ********************************************************************************
 
@@ -325,13 +325,20 @@
 --------------------------------------------------------------------------------
 SEQUENCE NAME            COMBINED P-VALUE  MOTIF DIAGRAM
 -------------            ----------------  -------------
-CHO1                             1.89e-07  152_[+2(1.11e-05)]_396_[-2(3.28e-07)]_38_[-1(2.43e-05)]_12_[-1(1.20e-08)]_148
-CHO2                             2.32e-06  349_[-1(6.52e-09)]_46_[-2(8.59e-06)]_378
-FAS1                             1.64e-06  43_[+2(6.33e-06)]_37_[-1(6.11e-09)]_693
-FAS2                             1.75e-05  184_[-2(8.59e-06)]_368_[-1(5.67e-08)]_221
-ACC1                             1.89e-07  78_[-1(1.20e-08)]_136_[+2(3.28e-07)]_559
-INO1                             1.22e-07  282_[-2(5.36e-06)]_256_[+1(9.62e-05)]_4_[+1(5.31e-05)]_32_[+1(4.64e-10)]_165
-OPI3                             5.70e-07  185_[-2(3.28e-07)]_388_[+1(3.84e-08)]_32_[-1(3.61e-05)]_151
+CHO1                             1.89e-07  152_[+2(1.11e-05)]_396_\
+    [-2(3.28e-07)]_38_[-1(2.43e-05)]_12_[-1(1.20e-08)]_148
+CHO2                             2.32e-06  349_[-1(6.52e-09)]_46_\
+    [-2(8.59e-06)]_378
+FAS1                             1.64e-06  43_[+2(6.33e-06)]_37_[-1(6.11e-09)]_\
+    693
+FAS2                             1.75e-05  184_[-2(8.59e-06)]_368_\
+    [-1(5.67e-08)]_221
+ACC1                             1.89e-07  78_[-1(1.20e-08)]_136_\
+    [+2(3.28e-07)]_559
+INO1                             1.22e-07  282_[-2(5.36e-06)]_256_\
+    [+1(9.62e-05)]_4_[+1(5.31e-05)]_32_[+1(4.64e-10)]_165
+OPI3                             5.70e-07  185_[-2(3.28e-07)]_388_\
+    [+1(3.84e-08)]_32_[-1(3.61e-05)]_151
 --------------------------------------------------------------------------------
 
 ********************************************************************************
@@ -341,6 +348,6 @@
 Stopped because nmotifs = 2 reached.
 ********************************************************************************
 
-CPU: tlb-sayonara.imb.uq.edu.au
+CPU: tlb-squirrel
 
 ********************************************************************************
diff -r 5836e70b6834 -r 81f90e1597b4 tests/meme/meme.INO_up800.tcm
--- a/tests/meme/meme.INO_up800.tcm	Wed Feb 22 12:48:03 2012 +1000
+++ b/tests/meme/meme.INO_up800.tcm	Wed Feb 22 14:46:22 2012 +1000
@@ -1,7 +1,7 @@
 ********************************************************************************
 MEME - Motif discovery tool
 ********************************************************************************
-MEME version 4.0.0 (Release date: 2008-07-12 05:23:09 +1000 (Sat, 12 Jul 2008))
+MEME version 4.8.1 (Release date: Wed Feb 22 11:51:06 EST 2012)
 
 For further information on how to interpret these results or to get
 a copy of the MEME software please access http://meme.nbcr.net.
@@ -28,7 +28,7 @@
 ********************************************************************************
 TRAINING SET
 ********************************************************************************
-DATAFILE= /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/INO_up800.s
+DATAFILE= /home/james/dist/scripts/../tests/common/INO_up800.s
 ALPHABET= ACGT
 Sequence name            Weight Length  Sequence name            Weight Length  
 -------------            ------ ------  -------------            ------ ------  
@@ -44,7 +44,7 @@
 This information can also be useful in the event you wish to report a
 problem with the MEME software.
 
-command: meme /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/INO_up800.s -text -mod tcm -dna -revcomp -bfile /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/yeast.nc.6.freq -x_branch -nostatus -nmotifs 2 -minw 8 
+command: meme /home/james/dist/scripts/../tests/common/INO_up800.s -text -mod tcm -dna -revcomp -bfile /home/james/dist/scripts/../tests/common/yeast.nc.6.freq -x_branch -nostatus -nmotifs 2 -minw 8 
 
 model:  mod=           tcm    nmotifs=         2    evt=           inf
 object function=  E-value of product of p-values
@@ -61,7 +61,7 @@
 sample: seed=            0    seqfrac=         1
 Letter frequencies in dataset:
 A 0.304 C 0.196 G 0.196 T 0.304 
-Background letter frequencies (from /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/yeast.nc.6.freq):
+Background letter frequencies (from /home/james/dist/scripts/../tests/common/yeast.nc.6.freq):
 A 0.324 C 0.176 G 0.176 T 0.324 
 ********************************************************************************
 
@@ -191,7 +191,7 @@
 
 
 
-Time 92.97 secs.
+Time 66.02 secs.
 
 ********************************************************************************
 
@@ -386,7 +386,7 @@
 
 
 
-Time 183.58 secs.
+Time 131.88 secs.
 
 ********************************************************************************
 
@@ -400,13 +400,21 @@
 --------------------------------------------------------------------------------
 SEQUENCE NAME            COMBINED P-VALUE  MOTIF DIAGRAM
 -------------            ----------------  -------------
-CHO1                             1.81e-05  33_[-2(6.95e-06)]_548_[+1(3.43e-07)]_16_[+1(7.37e-08)]_85_[+2(6.95e-06)]_34
-CHO2                             1.30e-05  62_[-2(8.56e-07)]_262_[+1(4.16e-07)]_137_[+2(1.76e-06)]_91_[+2(1.35e-06)]_148
-FAS1                             4.92e-09  94_[+1(3.29e-09)]_245_[+2(2.64e-08)]_60_[-2(1.03e-06)]_54_[+2(2.69e-06)]_247
-FAS2                             4.93e-07  107_[-2(4.38e-06)]_48_[-2(2.64e-08)]_30_[+2(7.83e-08)]_112_[+2(1.76e-06)]_153_[+1(4.16e-07)]_221
-ACC1                             4.67e-07  82_[+1(1.88e-07)]_173_[+2(2.90e-07)]_[+2(5.51e-08)]_22_[-2(1.10e-07)]_353_[+2(2.36e-07)]_41
-INO1                             9.37e-13  92_[+2(4.81e-07)]_55_[+2(1.35e-06)]_39_[+2(1.24e-06)]_216_[+2(3.82e-13)]_51_[-1(2.24e-06)]_36_[-1(3.13e-08)]_5_[+2(5.85e-07)]_21_[+1(1.72e-07)]_61_[+2(6.20e-08)]_11
-OPI3                             9.38e-05  276_[+2(1.24e-06)]_93_[+2(5.54e-06)]_101_[+2(6.45e-06)]_26_[-1(2.44e-06)]_174_[-2(2.09e-06)]_1
+CHO1                             1.81e-05  33_[-2(6.95e-06)]_548_\
+    [+1(3.43e-07)]_16_[+1(7.37e-08)]_85_[+2(6.95e-06)]_34
+CHO2                             1.30e-05  62_[-2(8.56e-07)]_262_\
+    [+1(4.16e-07)]_137_[+2(1.76e-06)]_91_[+2(1.35e-06)]_148
+FAS1                             4.92e-09  94_[+1(3.29e-09)]_245_\
+    [+2(2.64e-08)]_60_[-2(1.03e-06)]_54_[+2(2.69e-06)]_247
+FAS2                             4.93e-07  107_[-2(4.38e-06)]_48_\
+    [-2(2.64e-08)]_30_[+2(7.83e-08)]_112_[+2(1.76e-06)]_153_[+1(4.16e-07)]_221
+ACC1                             4.67e-07  82_[+1(1.88e-07)]_173_\
+    [+2(2.90e-07)]_[+2(5.51e-08)]_22_[-2(1.10e-07)]_353_[+2(2.36e-07)]_41
+INO1                             9.37e-13  92_[+2(4.81e-07)]_55_[+2(1.35e-06)]_\
+    39_[+2(1.24e-06)]_216_[+2(3.82e-13)]_51_[-1(2.24e-06)]_36_[-1(3.13e-08)]_5_\
+    [+2(5.85e-07)]_21_[+1(1.72e-07)]_61_[+2(6.20e-08)]_11
+OPI3                             9.38e-05  276_[+2(1.24e-06)]_93_\
+    [+2(5.54e-06)]_101_[+2(6.45e-06)]_26_[-1(2.44e-06)]_174_[-2(2.09e-06)]_1
 --------------------------------------------------------------------------------
 
 ********************************************************************************
@@ -416,6 +424,6 @@
 Stopped because nmotifs = 2 reached.
 ********************************************************************************
 
-CPU: tlb-sayonara.imb.uq.edu.au
+CPU: tlb-squirrel
 
 ********************************************************************************
diff -r 5836e70b6834 -r 81f90e1597b4 tests/meme/meme.INO_up800.zoops
--- a/tests/meme/meme.INO_up800.zoops	Wed Feb 22 12:48:03 2012 +1000
+++ b/tests/meme/meme.INO_up800.zoops	Wed Feb 22 14:46:22 2012 +1000
@@ -1,7 +1,7 @@
 ********************************************************************************
 MEME - Motif discovery tool
 ********************************************************************************
-MEME version 4.0.0 (Release date: 2008-07-12 05:23:09 +1000 (Sat, 12 Jul 2008))
+MEME version 4.8.1 (Release date: Wed Feb 22 11:51:06 EST 2012)
 
 For further information on how to interpret these results or to get
 a copy of the MEME software please access http://meme.nbcr.net.
@@ -28,7 +28,7 @@
 ********************************************************************************
 TRAINING SET
 ********************************************************************************
-DATAFILE= /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/INO_up800.s
+DATAFILE= /home/james/dist/scripts/../tests/common/INO_up800.s
 ALPHABET= ACGT
 Sequence name            Weight Length  Sequence name            Weight Length  
 -------------            ------ ------  -------------            ------ ------  
@@ -44,7 +44,7 @@
 This information can also be useful in the event you wish to report a
 problem with the MEME software.
 
-command: meme /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/INO_up800.s -text -mod zoops -dna -revcomp -bfile /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/yeast.nc.6.freq -x_branch -nostatus -nmotifs 2 -minw 8 
+command: meme /home/james/dist/scripts/../tests/common/INO_up800.s -text -mod zoops -dna -revcomp -bfile /home/james/dist/scripts/../tests/common/yeast.nc.6.freq -x_branch -nostatus -nmotifs 2 -minw 8 
 
 model:  mod=         zoops    nmotifs=         2    evt=           inf
 object function=  E-value of product of p-values
@@ -61,7 +61,7 @@
 sample: seed=            0    seqfrac=         1
 Letter frequencies in dataset:
 A 0.304 C 0.196 G 0.196 T 0.304 
-Background letter frequencies (from /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/yeast.nc.6.freq):
+Background letter frequencies (from /home/james/dist/scripts/../tests/common/yeast.nc.6.freq):
 A 0.324 C 0.176 G 0.176 T 0.324 
 ********************************************************************************
 
@@ -193,52 +193,51 @@
 
 
 
-Time 31.59 secs.
+Time 23.07 secs.
 
 ********************************************************************************
 
 
 ********************************************************************************
-MOTIF  2	width =   10   sites =   7   llr = 81   E-value = 4.4e+001
+MOTIF  2	width =   21   sites =   6   llr = 108   E-value = 8.3e+001
 ********************************************************************************
 --------------------------------------------------------------------------------
 	Motif 2 Description
 --------------------------------------------------------------------------------
-Simplified        A  ::31::a:6:
-pos.-specific     C  :a:::a:911
-probability       G  1::9a:::19
-matrix            T  9:7::::11:
+Simplified        A  :85:2223:7::7::8:::::
+pos.-specific     C  8:32357382:8:852a2328
+probability       G  222853222:::322:::522
+matrix            T  :::::::2:2a2::3::827:
 
-         bits    2.5  *  **    
-                 2.3  *  **    
-                 2.0  *  **   *
-                 1.8  * *** * *
-Relative         1.5  * ***** *
-Entropy          1.3 ** ***** *
-(16.8 bits)      1.0 ** ***** *
-                 0.8 ******** *
-                 0.5 ******** *
-                 0.3 **********
-                 0.0 ----------
+         bits    2.5                 *    
+                 2.3                 *    
+                 2.0                 *    
+                 1.8 *  *    *  * *  *   *
+Relative         1.5 *  *    * ** *  *   *
+Entropy          1.3 *  *    * ** *  *   *
+(26.0 bits)      1.0 ** **** * **** **** *
+                 0.8 ** **** * ***********
+                 0.5 ******* *************
+                 0.3 *********************
+                 0.0 ---------------------
 
-Multilevel           TCTGGCACAG
-consensus              A       
-sequence                       
-                               
+Multilevel           CAAGGCCACATCACCACTGTC
+consensus              C CG C    G T   C  
+sequence                                  
+                                          
 --------------------------------------------------------------------------------
 
 --------------------------------------------------------------------------------
 	Motif 2 sites sorted by position p-value
 --------------------------------------------------------------------------------
-Sequence name            Strand  Start   P-value               Site 
--------------            ------  ----- ---------            ----------
-OPI3                         -    186  3.28e-07 GAAAACCAGA TCTGGCACAG ACCGTTGTCA
-ACC1                         +    232  3.28e-07 CCAGTCGTAT TCTGGCACAG TATAGCCTAG
-CHO1                         -    559  3.28e-07 ATATTCAGTG TCTGGCACAG AAGTCTGCAC
-FAS1                         +     44  5.16e-06 TACACGAGGT GCAGGCACGG TTCACTACTC
-FAS2                         -    185  6.97e-06 TTCTTGCTTT TCTGGCACTC TTGACGGCTT
-CHO2                         -    413  6.97e-06 TTTTGCCGTT TCTGGCATCG CCGTTCATTT
-INO1                         +    332  8.18e-06 CAGAGGAATC TCAAGCACAG CCTCCAGCAT
+Sequence name            Strand  Start   P-value                    Site       
+-------------            ------  ----- ---------            ---------------------
+FAS2                         +    710  1.81e-11 GAAGGTTACA CAAGACCACATCACCACTGTC GTGCTTTTCT
+INO1                         -    369  5.01e-10 TGTTGTCCAT CAAGGGCACATCGGCACCGGC CTCATCGTCT
+OPI3                         -    504  8.36e-10 CGAATTATAC GGCGGCGCCATCACTACTGTC GTCCCACCTG
+ACC1                         +    135  5.28e-09 AGTCGAAATT CAACCGCTCATTGCCACTCTC TCTACTGCTT
+CHO1                         +    615  1.83e-08 TGAACGTTCA CACGGCACCCTCACGCCTTTG AGCTTTCACA
+FAS1                         +     45  2.47e-08 ACACGAGGTG CAGGCACGGTTCACTACTCCC CTGGCCTCCA
 --------------------------------------------------------------------------------
 
 --------------------------------------------------------------------------------
@@ -246,26 +245,24 @@
 --------------------------------------------------------------------------------
 SEQUENCE NAME            POSITION P-VALUE  MOTIF DIAGRAM
 -------------            ----------------  -------------
-OPI3                              3.3e-07  185_[-2]_605
-ACC1                              3.3e-07  231_[+2]_559
-CHO1                              3.3e-07  558_[-2]_232
-FAS1                              5.2e-06  43_[+2]_747
-FAS2                                7e-06  184_[-2]_606
-CHO2                                7e-06  412_[-2]_378
-INO1                              8.2e-06  331_[+2]_459
+FAS2                              1.8e-11  709_[+2]_70
+INO1                                5e-10  368_[-2]_411
+OPI3                              8.4e-10  503_[-2]_276
+ACC1                              5.3e-09  134_[+2]_645
+CHO1                              1.8e-08  614_[+2]_165
+FAS1                              2.5e-08  44_[+2]_735
 --------------------------------------------------------------------------------
 
 --------------------------------------------------------------------------------
 	Motif 2 in BLOCKS format
 --------------------------------------------------------------------------------
-BL   MOTIF 2 width=10 seqs=7
-OPI3                     (  186) TCTGGCACAG  1 
-ACC1                     (  232) TCTGGCACAG  1 
-CHO1                     (  559) TCTGGCACAG  1 
-FAS1                     (   44) GCAGGCACGG  1 
-FAS2                     (  185) TCTGGCACTC  1 
-CHO2                     (  413) TCTGGCATCG  1 
-INO1                     (  332) TCAAGCACAG  1 
+BL   MOTIF 2 width=21 seqs=6
+FAS2                     (  710) CAAGACCACATCACCACTGTC  1 
+INO1                     (  369) CAAGGGCACATCGGCACCGGC  1 
+OPI3                     (  504) GGCGGCGCCATCACTACTGTC  1 
+ACC1                     (  135) CAACCGCTCATTGCCACTCTC  1 
+CHO1                     (  615) CACGGCACCCTCACGCCTTTG  1 
+FAS1                     (   45) CAGGCACGGTTCACTACTCCC  1 
 //
 
 --------------------------------------------------------------------------------
@@ -273,45 +270,67 @@
 --------------------------------------------------------------------------------
 	Motif 2 position-specific scoring matrix
 --------------------------------------------------------------------------------
-log-odds matrix: alength= 4 w= 10 n= 5537 bayes= 10.2321 E= 4.4e+001 
-  -945   -945    -30    140 
-  -945    251   -945   -945 
-   -18   -945   -945    114 
-  -118   -945    229   -945 
-  -945   -945    251   -945 
-  -945    251   -945   -945 
-   162   -945   -945   -945 
-  -945    229   -945   -118 
-    82    -30    -30   -118 
-  -945    -30    229   -945 
+log-odds matrix: alength= 4 w= 21 n= 5460 bayes= 10.276 E= 8.3e+001 
+  -923    224     -7   -923 
+   136   -923     -7   -923 
+    62     92     -7   -923 
+  -923     -7    224   -923 
+   -96     92    151   -923 
+   -96    151     92   -923 
+   -96    192     -7   -923 
+     4     92     -7    -96 
+  -923    224     -7   -923 
+   104     -7   -923    -96 
+  -923   -923   -923    162 
+  -923    224   -923    -96 
+   104   -923     92   -923 
+  -923    224     -7   -923 
+  -923    151     -7      4 
+   136     -7   -923   -923 
+  -923    251   -923   -923 
+  -923     -7   -923    136 
+  -923     92    151    -96 
+  -923     -7     -7    104 
+  -923    224     -7   -923 
 --------------------------------------------------------------------------------
 
 --------------------------------------------------------------------------------
 	Motif 2 position-specific probability matrix
 --------------------------------------------------------------------------------
-letter-probability matrix: alength= 4 w= 10 nsites= 7 E= 4.4e+001 
- 0.000000  0.000000  0.142857  0.857143 
+letter-probability matrix: alength= 4 w= 21 nsites= 6 E= 8.3e+001 
+ 0.000000  0.833333  0.166667  0.000000 
+ 0.833333  0.000000  0.166667  0.000000 
+ 0.500000  0.333333  0.166667  0.000000 
+ 0.000000  0.166667  0.833333  0.000000 
+ 0.166667  0.333333  0.500000  0.000000 
+ 0.166667  0.500000  0.333333  0.000000 
+ 0.166667  0.666667  0.166667  0.000000 
+ 0.333333  0.333333  0.166667  0.166667 
+ 0.000000  0.833333  0.166667  0.000000 
+ 0.666667  0.166667  0.000000  0.166667 
+ 0.000000  0.000000  0.000000  1.000000 
+ 0.000000  0.833333  0.000000  0.166667 
+ 0.666667  0.000000  0.333333  0.000000 
+ 0.000000  0.833333  0.166667  0.000000 
+ 0.000000  0.500000  0.166667  0.333333 
+ 0.833333  0.166667  0.000000  0.000000 
  0.000000  1.000000  0.000000  0.000000 
- 0.285714  0.000000  0.000000  0.714286 
- 0.142857  0.000000  0.857143  0.000000 
- 0.000000  0.000000  1.000000  0.000000 
- 0.000000  1.000000  0.000000  0.000000 
- 1.000000  0.000000  0.000000  0.000000 
- 0.000000  0.857143  0.000000  0.142857 
- 0.571429  0.142857  0.142857  0.142857 
- 0.000000  0.142857  0.857143  0.000000 
+ 0.000000  0.166667  0.000000  0.833333 
+ 0.000000  0.333333  0.500000  0.166667 
+ 0.000000  0.166667  0.166667  0.666667 
+ 0.000000  0.833333  0.166667  0.000000 
 --------------------------------------------------------------------------------
 
 --------------------------------------------------------------------------------
 	Motif 2 regular expression
 --------------------------------------------------------------------------------
-TC[TA]GGCACAG
+CA[AC]G[GC][CG]C[AC]CATC[AG]C[CT]ACT[GC]TC
 --------------------------------------------------------------------------------
 
 
 
 
-Time 62.82 secs.
+Time 45.81 secs.
 
 ********************************************************************************
 
@@ -325,13 +344,19 @@
 --------------------------------------------------------------------------------
 SEQUENCE NAME            COMBINED P-VALUE  MOTIF DIAGRAM
 -------------            ----------------  -------------
-CHO1                             1.89e-07  558_[-2(3.28e-07)]_38_[-1(2.43e-05)]_12_[-1(1.20e-08)]_148
-CHO2                             1.91e-06  349_[-1(6.52e-09)]_46_[-2(6.97e-06)]_378
-FAS1                             1.35e-06  43_[+2(5.16e-06)]_37_[-1(6.11e-09)]_693
-FAS2                             1.45e-05  184_[-2(6.97e-06)]_368_[-1(5.67e-08)]_221
-ACC1                             1.89e-07  78_[-1(1.20e-08)]_136_[+2(3.28e-07)]_559
-INO1                             1.82e-07  331_[+2(8.18e-06)]_207_[+1(9.62e-05)]_4_[+1(5.31e-05)]_32_[+1(4.64e-10)]_165
-OPI3                             5.70e-07  185_[-2(3.28e-07)]_388_[+1(3.84e-08)]_32_[-1(3.61e-05)]_151
+CHO1                             1.20e-08  614_[+2(1.83e-08)]_[-1(1.20e-08)]_\
+    148
+CHO2                             9.89e-05  349_[-1(6.52e-09)]_434
+FAS1                             8.38e-09  44_[+2(2.47e-08)]_25_[-1(6.11e-09)]_\
+    16_[-2(5.76e-05)]_656
+FAS2                             6.93e-11  562_[-1(5.67e-08)]_130_\
+    [+2(1.81e-11)]_70
+ACC1                             3.64e-09  34_[+2(3.28e-05)]_[+2(7.06e-05)]_2_\
+    [-1(1.20e-08)]_39_[+2(5.28e-09)]_645
+INO1                             1.66e-11  239_[-2(8.16e-05)]_108_\
+    [-2(5.01e-10)]_159_[+1(9.62e-05)]_4_[+1(5.31e-05)]_32_[+1(4.64e-10)]_165
+OPI3                             1.90e-09  503_[-2(8.36e-10)]_59_\
+    [+1(3.84e-08)]_32_[-1(3.61e-05)]_151
 --------------------------------------------------------------------------------
 
 ********************************************************************************
@@ -341,6 +366,6 @@
 Stopped because nmotifs = 2 reached.
 ********************************************************************************
 
-CPU: tlb-sayonara.imb.uq.edu.au
+CPU: tlb-squirrel
 
 ********************************************************************************
diff -r 5836e70b6834 -r 81f90e1597b4 tests/meme/meme.adh.oops
--- a/tests/meme/meme.adh.oops	Wed Feb 22 12:48:03 2012 +1000
+++ b/tests/meme/meme.adh.oops	Wed Feb 22 14:46:22 2012 +1000
@@ -1,7 +1,7 @@
 ********************************************************************************
 MEME - Motif discovery tool
 ********************************************************************************
-MEME version 4.0.0 (Release date: 2008-07-12 05:23:09 +1000 (Sat, 12 Jul 2008))
+MEME version 4.8.1 (Release date: Wed Feb 22 11:51:06 EST 2012)
 
 For further information on how to interpret these results or to get
 a copy of the MEME software please access http://meme.nbcr.net.
@@ -28,7 +28,7 @@
 ********************************************************************************
 TRAINING SET
 ********************************************************************************
-DATAFILE= /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/adh.s
+DATAFILE= /home/james/dist/scripts/../tests/common/adh.s
 ALPHABET= ACDEFGHIKLMNPQRSTVWY
 Sequence name            Weight Length  Sequence name            Weight Length  
 -------------            ------ ------  -------------            ------ ------  
@@ -57,7 +57,7 @@
 This information can also be useful in the event you wish to report a
 problem with the MEME software.
 
-command: meme /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/adh.s -text -mod oops -protein -nostatus -nmotifs 2 -minw 8 
+command: meme /home/james/dist/scripts/../tests/common/adh.s -text -mod oops -protein -nostatus -nmotifs 2 -minw 8 
 
 model:  mod=          oops    nmotifs=         2    evt=           inf
 object function=  E-value of product of p-values
@@ -329,7 +329,7 @@
 
 
 
-Time 10.13 secs.
+Time  7.53 secs.
 
 ********************************************************************************
 
@@ -580,7 +580,7 @@
 
 
 
-Time 18.80 secs.
+Time 13.78 secs.
 
 ********************************************************************************
 
@@ -594,39 +594,71 @@
 --------------------------------------------------------------------------------
 SEQUENCE NAME            COMBINED P-VALUE  MOTIF DIAGRAM
 -------------            ----------------  -------------
-2BHD_STREX                       2.28e-28  6_[2(6.13e-17)]_116_[1(1.05e-18)]_75
-3BHD_COMTE                       1.13e-24  6_[2(4.59e-17)]_115_[1(8.09e-15)]_74
-ADH_DROME                        3.17e-15  6_[2(2.82e-10)]_116_[1(5.74e-12)]_75
-AP27_MOUSE                       1.27e-33  7_[2(4.83e-19)]_112_[1(6.97e-22)]_67
-BA72_EUBSP                       4.12e-26  6_[2(5.57e-17)]_121_[1(2.38e-16)]_64
-BDH_HUMAN                        1.56e-26  55_[2(2.83e-17)]_123_[1(8.60e-17)]_107
-BPHB_PSEPS                       4.63e-19  5_[2(8.10e-14)]_118_[1(1.99e-12)]_94
-BUDC_KLETE                       9.67e-34  2_[2(6.81e-20)]_120_[1(3.84e-21)]_61
-DHES_HUMAN                       1.54e-22  2_[2(2.17e-13)]_50_[2(9.48e-05)]_44_[1(1.44e-16)]_144
-DHGB_BACME                       9.81e-31  7_[2(3.38e-18)]_123_[1(7.13e-20)]_74
-DHII_HUMAN                       7.97e-30  34_[2(8.59e-22)]_119_[1(1.84e-15)]_81
-DHMA_FLAS1                       1.83e-28  14_[2(7.71e-18)]_121_[1(5.86e-18)]_77
-ENTA_ECOLI                       2.86e-27  5_[2(4.83e-19)]_109_[1(1.84e-15)]_76
-FIXR_BRAJA                       3.97e-30  36_[2(1.30e-16)]_123_[1(6.66e-21)]_61
-GUTD_ECOLI                       4.48e-25  2_[2(3.39e-13)]_122_[1(4.04e-19)]_77
-HDE_CANTR                        3.35e-32  8_[2(4.61e-18)]_125_[1(4.12e-13)]_131_[2(6.11e-23)]_115_[1(9.13e-18)]_411
-HDHA_ECOLI                       3.52e-31  11_[2(7.67e-20)]_74_[1(4.12e-05)]_15_[1(1.18e-18)]_68
-LIGD_PSEPA                       5.00e-24  6_[2(8.02e-16)]_121_[1(1.38e-15)]_120
-NODG_RHIME                       7.67e-30  6_[2(2.09e-15)]_116_[1(1.08e-21)]_65
-RIDH_KLEAE                       6.22e-29  14_[2(1.55e-19)]_116_[1(1.17e-16)]_61
-YINL_LISMO                       1.11e-28  5_[2(9.87e-22)]_119_[1(3.35e-14)]_66
-YRTP_BACSU                       5.30e-34  6_[2(9.36e-19)]_119_[1(1.57e-22)]_55
+2BHD_STREX                       2.28e-28  6_[2(6.13e-17)]_116_[1(1.05e-18)]_\
+    75
+3BHD_COMTE                       1.13e-24  6_[2(4.59e-17)]_115_[1(8.09e-15)]_\
+    74
+ADH_DROME                        3.17e-15  6_[2(2.82e-10)]_116_[1(5.74e-12)]_\
+    75
+AP27_MOUSE                       1.27e-33  7_[2(4.83e-19)]_112_[1(6.97e-22)]_\
+    67
+BA72_EUBSP                       4.12e-26  6_[2(5.57e-17)]_121_[1(2.38e-16)]_\
+    64
+BDH_HUMAN                        1.56e-26  55_[2(2.83e-17)]_123_[1(8.60e-17)]_\
+    107
+BPHB_PSEPS                       4.63e-19  5_[2(8.10e-14)]_118_[1(1.99e-12)]_\
+    94
+BUDC_KLETE                       9.67e-34  2_[2(6.81e-20)]_120_[1(3.84e-21)]_\
+    61
+DHES_HUMAN                       1.54e-22  2_[2(2.17e-13)]_50_[2(9.48e-05)]_44_\
+    [1(1.44e-16)]_144
+DHGB_BACME                       9.81e-31  7_[2(3.38e-18)]_123_[1(7.13e-20)]_\
+    74
+DHII_HUMAN                       7.97e-30  34_[2(8.59e-22)]_119_[1(1.84e-15)]_\
+    81
+DHMA_FLAS1                       1.83e-28  14_[2(7.71e-18)]_121_[1(5.86e-18)]_\
+    77
+ENTA_ECOLI                       2.86e-27  5_[2(4.83e-19)]_109_[1(1.84e-15)]_\
+    76
+FIXR_BRAJA                       3.97e-30  36_[2(1.30e-16)]_123_[1(6.66e-21)]_\
+    61
+GUTD_ECOLI                       4.48e-25  2_[2(3.39e-13)]_122_[1(4.04e-19)]_\
+    77
+HDE_CANTR                        3.35e-32  8_[2(4.61e-18)]_125_[1(4.12e-13)]_\
+    131_[2(6.11e-23)]_115_[1(9.13e-18)]_411
+HDHA_ECOLI                       3.52e-31  11_[2(7.67e-20)]_74_[1(4.12e-05)]_\
+    15_[1(1.18e-18)]_68
+LIGD_PSEPA                       5.00e-24  6_[2(8.02e-16)]_121_[1(1.38e-15)]_\
+    120
+NODG_RHIME                       7.67e-30  6_[2(2.09e-15)]_116_[1(1.08e-21)]_\
+    65
+RIDH_KLEAE                       6.22e-29  14_[2(1.55e-19)]_116_[1(1.17e-16)]_\
+    61
+YINL_LISMO                       1.11e-28  5_[2(9.87e-22)]_119_[1(3.35e-14)]_\
+    66
+YRTP_BACSU                       5.30e-34  6_[2(9.36e-19)]_119_[1(1.57e-22)]_\
+    55
 CSGA_MYXXA                       8.09e-13  [2(7.14e-07)]_58_[1(1.84e-12)]_50
-DHB2_HUMAN                       3.48e-27  82_[2(1.72e-16)]_120_[1(2.37e-18)]_127
-DHB3_HUMAN                       1.32e-25  48_[2(2.74e-18)]_120_[1(9.70e-15)]_84
-DHCA_HUMAN                       1.29e-17  4_[2(1.12e-14)]_159_[1(4.30e-10)]_55
-FABI_ECOLI                       2.56e-14  6_[2(2.85e-09)]_123_[1(4.59e-12)]_75
-FVT1_HUMAN                       3.36e-26  32_[2(1.89e-16)]_124_[1(3.01e-17)]_118
-HMTR_LEIMA                       1.32e-28  6_[2(8.96e-17)]_157_[1(3.17e-19)]_66
-MAS1_AGRRA                       3.85e-15  245_[2(8.72e-15)]_74_[1(5.81e-08)]_99
-PCR_PEA                          7.86e-19  25_[1(2.66e-08)]_32_[2(4.61e-18)]_284
-RFBB_NEIGO                       8.85e-20  6_[2(1.08e-12)]_129_[1(1.66e-14)]_153
-YURA_MYXXA                       5.81e-20  65_[2(3.85e-08)]_65_[1(5.80e-19)]_70
+DHB2_HUMAN                       3.48e-27  82_[2(1.72e-16)]_120_[1(2.37e-18)]_\
+    127
+DHB3_HUMAN                       1.32e-25  48_[2(2.74e-18)]_120_[1(9.70e-15)]_\
+    84
+DHCA_HUMAN                       1.29e-17  4_[2(1.12e-14)]_159_[1(4.30e-10)]_\
+    55
+FABI_ECOLI                       2.56e-14  6_[2(2.85e-09)]_123_[1(4.59e-12)]_\
+    75
+FVT1_HUMAN                       3.36e-26  32_[2(1.89e-16)]_124_[1(3.01e-17)]_\
+    118
+HMTR_LEIMA                       1.32e-28  6_[2(8.96e-17)]_157_[1(3.17e-19)]_\
+    66
+MAS1_AGRRA                       3.85e-15  245_[2(8.72e-15)]_74_[1(5.81e-08)]_\
+    99
+PCR_PEA                          7.86e-19  25_[1(2.66e-08)]_32_[2(4.61e-18)]_\
+    284
+RFBB_NEIGO                       8.85e-20  6_[2(1.08e-12)]_129_[1(1.66e-14)]_\
+    153
+YURA_MYXXA                       5.81e-20  65_[2(3.85e-08)]_65_[1(5.80e-19)]_\
+    70
 --------------------------------------------------------------------------------
 
 ********************************************************************************
@@ -636,6 +668,6 @@
 Stopped because nmotifs = 2 reached.
 ********************************************************************************
 
-CPU: tlb-sayonara.imb.uq.edu.au
+CPU: tlb-squirrel
 
 ********************************************************************************
diff -r 5836e70b6834 -r 81f90e1597b4 tests/meme/meme.adh.tcm
--- a/tests/meme/meme.adh.tcm	Wed Feb 22 12:48:03 2012 +1000
+++ b/tests/meme/meme.adh.tcm	Wed Feb 22 14:46:22 2012 +1000
@@ -1,7 +1,7 @@
 ********************************************************************************
 MEME - Motif discovery tool
 ********************************************************************************
-MEME version 4.0.0 (Release date: 2008-07-12 05:23:09 +1000 (Sat, 12 Jul 2008))
+MEME version 4.8.1 (Release date: Wed Feb 22 11:51:06 EST 2012)
 
 For further information on how to interpret these results or to get
 a copy of the MEME software please access http://meme.nbcr.net.
@@ -28,7 +28,7 @@
 ********************************************************************************
 TRAINING SET
 ********************************************************************************
-DATAFILE= /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/adh.s
+DATAFILE= /home/james/dist/scripts/../tests/common/adh.s
 ALPHABET= ACDEFGHIKLMNPQRSTVWY
 Sequence name            Weight Length  Sequence name            Weight Length  
 -------------            ------ ------  -------------            ------ ------  
@@ -57,7 +57,7 @@
 This information can also be useful in the event you wish to report a
 problem with the MEME software.
 
-command: meme /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/adh.s -text -mod tcm -protein -nostatus -nmotifs 2 -minw 8 
+command: meme /home/james/dist/scripts/../tests/common/adh.s -text -mod tcm -protein -nostatus -nmotifs 2 -minw 8 
 
 model:  mod=           tcm    nmotifs=         2    evt=           inf
 object function=  E-value of product of p-values
@@ -303,7 +303,7 @@
 
 
 
-Time 49.60 secs.
+Time 35.85 secs.
 
 ********************************************************************************
 
@@ -533,7 +533,7 @@
 
 
 
-Time 93.45 secs.
+Time 67.40 secs.
 
 ********************************************************************************
 
@@ -547,38 +547,67 @@
 --------------------------------------------------------------------------------
 SEQUENCE NAME            COMBINED P-VALUE  MOTIF DIAGRAM
 -------------            ----------------  -------------
-2BHD_STREX                       6.22e-18  9_[1(8.69e-12)]_121_[2(2.93e-13)]_82
-3BHD_COMTE                       3.89e-20  9_[1(9.74e-13)]_120_[2(1.49e-14)]_81
-ADH_DROME                        3.06e-09  9_[1(2.60e-05)]_121_[2(9.02e-11)]_82
-AP27_MOUSE                       1.05e-24  10_[1(2.80e-15)]_117_[2(1.24e-16)]_74
-BA72_EUBSP                       3.85e-19  9_[1(9.22e-14)]_126_[2(1.69e-12)]_71
-BDH_HUMAN                        3.49e-20  58_[1(6.84e-15)]_128_[2(9.88e-13)]_114
-BPHB_PSEPS                       3.97e-21  8_[1(4.99e-13)]_123_[2(2.37e-15)]_101
-BUDC_KLETE                       4.93e-27  5_[1(2.50e-17)]_125_[2(6.17e-17)]_68
-DHES_HUMAN                       3.43e-21  5_[1(5.43e-13)]_128_[2(1.29e-15)]_151
-DHGB_BACME                       1.08e-19  10_[1(2.56e-12)]_128_[2(1.49e-14)]_81
-DHII_HUMAN                       4.91e-23  37_[1(1.32e-16)]_124_[2(8.96e-14)]_88
-DHMA_FLAS1                       1.77e-20  17_[1(6.96e-14)]_126_[2(8.10e-14)]_84
-ENTA_ECOLI                       7.63e-20  8_[1(1.98e-15)]_114_[2(1.52e-11)]_83
-FIXR_BRAJA                       2.11e-22  39_[1(7.62e-15)]_128_[2(7.61e-15)]_68
-GUTD_ECOLI                       2.74e-18  5_[1(4.49e-10)]_127_[2(2.37e-15)]_84
-HDE_CANTR                        1.12e-21  11_[1(1.01e-13)]_130_[2(6.24e-13)]_141_[1(4.49e-16)]_120_[2(5.95e-14)]_418
-HDHA_ECOLI                       6.08e-21  14_[1(5.50e-15)]_123_[2(3.90e-13)]_75
-LIGD_PSEPA                       2.75e-16  9_[1(3.19e-11)]_126_[2(2.63e-12)]_127
-NODG_RHIME                       1.74e-22  9_[1(1.33e-13)]_121_[2(4.70e-16)]_72
-RIDH_KLEAE                       5.89e-20  17_[1(3.86e-13)]_121_[2(5.95e-14)]_68
-YINL_LISMO                       3.49e-24  8_[1(2.12e-17)]_124_[2(5.37e-14)]_73
-YRTP_BACSU                       7.95e-30  9_[1(3.13e-18)]_124_[2(7.44e-19)]_62
+2BHD_STREX                       6.22e-18  9_[1(8.69e-12)]_121_[2(2.93e-13)]_\
+    82
+3BHD_COMTE                       3.89e-20  9_[1(9.74e-13)]_120_[2(1.49e-14)]_\
+    81
+ADH_DROME                        3.06e-09  9_[1(2.60e-05)]_121_[2(9.02e-11)]_\
+    82
+AP27_MOUSE                       1.05e-24  10_[1(2.80e-15)]_117_[2(1.24e-16)]_\
+    74
+BA72_EUBSP                       3.85e-19  9_[1(9.22e-14)]_126_[2(1.69e-12)]_\
+    71
+BDH_HUMAN                        3.49e-20  58_[1(6.84e-15)]_128_[2(9.88e-13)]_\
+    114
+BPHB_PSEPS                       3.97e-21  8_[1(4.99e-13)]_123_[2(2.37e-15)]_\
+    101
+BUDC_KLETE                       4.93e-27  5_[1(2.50e-17)]_125_[2(6.17e-17)]_\
+    68
+DHES_HUMAN                       3.43e-21  5_[1(5.43e-13)]_128_[2(1.29e-15)]_\
+    151
+DHGB_BACME                       1.08e-19  10_[1(2.56e-12)]_128_[2(1.49e-14)]_\
+    81
+DHII_HUMAN                       4.91e-23  37_[1(1.32e-16)]_124_[2(8.96e-14)]_\
+    88
+DHMA_FLAS1                       1.77e-20  17_[1(6.96e-14)]_126_[2(8.10e-14)]_\
+    84
+ENTA_ECOLI                       7.63e-20  8_[1(1.98e-15)]_114_[2(1.52e-11)]_\
+    83
+FIXR_BRAJA                       2.11e-22  39_[1(7.62e-15)]_128_[2(7.61e-15)]_\
+    68
+GUTD_ECOLI                       2.74e-18  5_[1(4.49e-10)]_127_[2(2.37e-15)]_\
+    84
+HDE_CANTR                        1.12e-21  11_[1(1.01e-13)]_130_[2(6.24e-13)]_\
+    141_[1(4.49e-16)]_120_[2(5.95e-14)]_418
+HDHA_ECOLI                       6.08e-21  14_[1(5.50e-15)]_123_[2(3.90e-13)]_\
+    75
+LIGD_PSEPA                       2.75e-16  9_[1(3.19e-11)]_126_[2(2.63e-12)]_\
+    127
+NODG_RHIME                       1.74e-22  9_[1(1.33e-13)]_121_[2(4.70e-16)]_\
+    72
+RIDH_KLEAE                       5.89e-20  17_[1(3.86e-13)]_121_[2(5.95e-14)]_\
+    68
+YINL_LISMO                       3.49e-24  8_[1(2.12e-17)]_124_[2(5.37e-14)]_\
+    73
+YRTP_BACSU                       7.95e-30  9_[1(3.13e-18)]_124_[2(7.44e-19)]_\
+    62
 CSGA_MYXXA                       1.91e-09  87_[2(2.87e-12)]_57
-DHB2_HUMAN                       4.77e-21  85_[1(5.76e-14)]_125_[2(1.19e-14)]_134
-DHB3_HUMAN                       4.47e-21  51_[1(2.91e-14)]_125_[2(3.53e-14)]_91
-DHCA_HUMAN                       1.16e-12  7_[1(3.24e-13)]_164_[2(1.72e-06)]_62
+DHB2_HUMAN                       4.77e-21  85_[1(5.76e-14)]_125_[2(1.19e-14)]_\
+    134
+DHB3_HUMAN                       4.47e-21  51_[1(2.91e-14)]_125_[2(3.53e-14)]_\
+    91
+DHCA_HUMAN                       1.16e-12  7_[1(3.24e-13)]_164_[2(1.72e-06)]_\
+    62
 FABI_ECOLI                       1.39e-06  158_[2(8.74e-09)]_82
-FVT1_HUMAN                       1.46e-25  35_[1(1.09e-15)]_129_[2(2.23e-17)]_125
-HMTR_LEIMA                       3.90e-21  9_[1(1.11e-13)]_162_[2(9.54e-15)]_73
-MAS1_AGRRA                       6.26e-11  248_[1(8.26e-13)]_122_[2(1.32e-05)]_63
+FVT1_HUMAN                       1.46e-25  35_[1(1.09e-15)]_129_[2(2.23e-17)]_\
+    125
+HMTR_LEIMA                       3.90e-21  9_[1(1.11e-13)]_162_[2(9.54e-15)]_\
+    73
+MAS1_AGRRA                       6.26e-11  248_[1(8.26e-13)]_122_[2(1.32e-05)]_\
+    63
 PCR_PEA                          2.93e-12  89_[1(6.60e-16)]_289
-RFBB_NEIGO                       4.00e-16  9_[1(9.53e-11)]_134_[2(9.88e-13)]_160
+RFBB_NEIGO                       4.00e-16  9_[1(9.53e-11)]_134_[2(9.88e-13)]_\
+    160
 YURA_MYXXA                       5.03e-11  159_[2(1.85e-14)]_77
 --------------------------------------------------------------------------------
 
@@ -589,6 +618,6 @@
 Stopped because nmotifs = 2 reached.
 ********************************************************************************
 
-CPU: tlb-sayonara.imb.uq.edu.au
+CPU: tlb-squirrel
 
 ********************************************************************************
diff -r 5836e70b6834 -r 81f90e1597b4 tests/meme/meme.adh.zoops
--- a/tests/meme/meme.adh.zoops	Wed Feb 22 12:48:03 2012 +1000
+++ b/tests/meme/meme.adh.zoops	Wed Feb 22 14:46:22 2012 +1000
@@ -1,7 +1,7 @@
 ********************************************************************************
 MEME - Motif discovery tool
 ********************************************************************************
-MEME version 4.0.0 (Release date: 2008-07-12 05:23:09 +1000 (Sat, 12 Jul 2008))
+MEME version 4.8.1 (Release date: Wed Feb 22 11:51:06 EST 2012)
 
 For further information on how to interpret these results or to get
 a copy of the MEME software please access http://meme.nbcr.net.
@@ -28,7 +28,7 @@
 ********************************************************************************
 TRAINING SET
 ********************************************************************************
-DATAFILE= /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/adh.s
+DATAFILE= /home/james/dist/scripts/../tests/common/adh.s
 ALPHABET= ACDEFGHIKLMNPQRSTVWY
 Sequence name            Weight Length  Sequence name            Weight Length  
 -------------            ------ ------  -------------            ------ ------  
@@ -57,7 +57,7 @@
 This information can also be useful in the event you wish to report a
 problem with the MEME software.
 
-command: meme /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/adh.s -text -mod zoops -protein -nostatus -nmotifs 2 -minw 8 
+command: meme /home/james/dist/scripts/../tests/common/adh.s -text -mod zoops -protein -nostatus -nmotifs 2 -minw 8 
 
 model:  mod=         zoops    nmotifs=         2    evt=           inf
 object function=  E-value of product of p-values
@@ -307,7 +307,7 @@
 
 
 
-Time 34.89 secs.
+Time 25.96 secs.
 
 ********************************************************************************
 
@@ -552,7 +552,7 @@
 
 
 
-Time 66.47 secs.
+Time 50.08 secs.
 
 ********************************************************************************
 
@@ -566,38 +566,68 @@
 --------------------------------------------------------------------------------
 SEQUENCE NAME            COMBINED P-VALUE  MOTIF DIAGRAM
 -------------            ----------------  -------------
-2BHD_STREX                       4.01e-24  5_[1(2.25e-12)]_123_[2(5.67e-19)]_77
-3BHD_COMTE                       1.55e-22  5_[1(1.40e-14)]_122_[2(3.82e-15)]_76
-ADH_DROME                        3.21e-15  5_[1(8.02e-10)]_123_[2(1.98e-12)]_77
-AP27_MOUSE                       2.89e-27  6_[1(5.19e-14)]_119_[2(1.74e-20)]_69
-BA72_EUBSP                       1.55e-22  5_[1(5.72e-14)]_128_[2(9.68e-16)]_66
-BDH_HUMAN                        7.00e-24  54_[1(1.02e-14)]_130_[2(1.15e-16)]_109
-BPHB_PSEPS                       1.49e-19  4_[1(1.12e-13)]_125_[2(4.38e-13)]_96
-BUDC_KLETE                       4.14e-33  1_[1(5.79e-18)]_127_[2(1.90e-22)]_63
-DHES_HUMAN                       5.57e-23  1_[1(6.94e-14)]_130_[2(1.55e-16)]_146
-DHGB_BACME                       1.35e-26  6_[1(1.91e-14)]_130_[2(1.93e-19)]_76
-DHII_HUMAN                       7.48e-26  33_[1(6.51e-17)]_126_[2(2.54e-16)]_83
-DHMA_FLAS1                       3.81e-25  13_[1(2.59e-14)]_128_[2(3.96e-18)]_79
-ENTA_ECOLI                       2.09e-24  4_[1(2.19e-16)]_116_[2(3.19e-15)]_78
-FIXR_BRAJA                       9.83e-29  35_[1(4.81e-15)]_130_[2(4.54e-21)]_63
-GUTD_ECOLI                       6.43e-22  1_[1(1.44e-09)]_129_[2(1.51e-19)]_79
-HDE_CANTR                        7.21e-26  7_[1(9.67e-13)]_132_[2(1.71e-13)]_132_[1(1.92e-16)]_122_[2(7.66e-18)]_413
-HDHA_ECOLI                       4.92e-27  10_[1(1.10e-15)]_125_[2(1.28e-18)]_70
-LIGD_PSEPA                       1.73e-19  5_[1(6.98e-12)]_128_[2(6.52e-15)]_122
-NODG_RHIME                       6.76e-26  5_[1(3.68e-12)]_123_[2(5.97e-21)]_67
-RIDH_KLEAE                       2.61e-25  13_[1(2.47e-15)]_123_[2(3.39e-17)]_63
-YINL_LISMO                       9.60e-26  4_[1(1.50e-17)]_126_[2(2.03e-15)]_68
-YRTP_BACSU                       4.03e-33  5_[1(1.68e-16)]_126_[2(6.53e-24)]_57
+2BHD_STREX                       4.01e-24  5_[1(2.25e-12)]_123_[2(5.67e-19)]_\
+    77
+3BHD_COMTE                       1.55e-22  5_[1(1.40e-14)]_122_[2(3.82e-15)]_\
+    76
+ADH_DROME                        3.21e-15  5_[1(8.02e-10)]_123_[2(1.98e-12)]_\
+    77
+AP27_MOUSE                       2.89e-27  6_[1(5.19e-14)]_119_[2(1.74e-20)]_\
+    69
+BA72_EUBSP                       1.55e-22  5_[1(5.72e-14)]_128_[2(9.68e-16)]_\
+    66
+BDH_HUMAN                        7.00e-24  54_[1(1.02e-14)]_130_[2(1.15e-16)]_\
+    109
+BPHB_PSEPS                       1.49e-19  4_[1(1.12e-13)]_125_[2(4.38e-13)]_\
+    96
+BUDC_KLETE                       4.14e-33  1_[1(5.79e-18)]_127_[2(1.90e-22)]_\
+    63
+DHES_HUMAN                       5.57e-23  1_[1(6.94e-14)]_130_[2(1.55e-16)]_\
+    146
+DHGB_BACME                       1.35e-26  6_[1(1.91e-14)]_130_[2(1.93e-19)]_\
+    76
+DHII_HUMAN                       7.48e-26  33_[1(6.51e-17)]_126_[2(2.54e-16)]_\
+    83
+DHMA_FLAS1                       3.81e-25  13_[1(2.59e-14)]_128_[2(3.96e-18)]_\
+    79
+ENTA_ECOLI                       2.09e-24  4_[1(2.19e-16)]_116_[2(3.19e-15)]_\
+    78
+FIXR_BRAJA                       9.83e-29  35_[1(4.81e-15)]_130_[2(4.54e-21)]_\
+    63
+GUTD_ECOLI                       6.43e-22  1_[1(1.44e-09)]_129_[2(1.51e-19)]_\
+    79
+HDE_CANTR                        7.21e-26  7_[1(9.67e-13)]_132_[2(1.71e-13)]_\
+    132_[1(1.92e-16)]_122_[2(7.66e-18)]_413
+HDHA_ECOLI                       4.92e-27  10_[1(1.10e-15)]_125_[2(1.28e-18)]_\
+    70
+LIGD_PSEPA                       1.73e-19  5_[1(6.98e-12)]_128_[2(6.52e-15)]_\
+    122
+NODG_RHIME                       6.76e-26  5_[1(3.68e-12)]_123_[2(5.97e-21)]_\
+    67
+RIDH_KLEAE                       2.61e-25  13_[1(2.47e-15)]_123_[2(3.39e-17)]_\
+    63
+YINL_LISMO                       9.60e-26  4_[1(1.50e-17)]_126_[2(2.03e-15)]_\
+    68
+YRTP_BACSU                       4.03e-33  5_[1(1.68e-16)]_126_[2(6.53e-24)]_\
+    57
 CSGA_MYXXA                       2.96e-09  85_[2(1.01e-12)]_52
-DHB2_HUMAN                       9.06e-26  81_[1(3.09e-15)]_127_[2(3.54e-18)]_129
-DHB3_HUMAN                       1.11e-21  47_[1(4.26e-14)]_127_[2(5.97e-15)]_86
-DHCA_HUMAN                       4.21e-18  3_[1(1.91e-14)]_166_[2(7.76e-11)]_57
-FABI_ECOLI                       1.11e-14  5_[1(2.70e-09)]_130_[2(1.98e-12)]_77
-FVT1_HUMAN                       5.86e-25  31_[1(2.86e-14)]_131_[2(3.54e-18)]_120
-HMTR_LEIMA                       1.11e-23  5_[1(6.98e-12)]_164_[2(3.97e-19)]_68
-MAS1_AGRRA                       5.88e-10  244_[1(3.13e-12)]_124_[2(3.64e-05)]_58
+DHB2_HUMAN                       9.06e-26  81_[1(3.09e-15)]_127_[2(3.54e-18)]_\
+    129
+DHB3_HUMAN                       1.11e-21  47_[1(4.26e-14)]_127_[2(5.97e-15)]_\
+    86
+DHCA_HUMAN                       4.21e-18  3_[1(1.91e-14)]_166_[2(7.76e-11)]_\
+    57
+FABI_ECOLI                       1.11e-14  5_[1(2.70e-09)]_130_[2(1.98e-12)]_\
+    77
+FVT1_HUMAN                       5.86e-25  31_[1(2.86e-14)]_131_[2(3.54e-18)]_\
+    120
+HMTR_LEIMA                       1.11e-23  5_[1(6.98e-12)]_164_[2(3.97e-19)]_\
+    68
+MAS1_AGRRA                       5.88e-10  244_[1(3.13e-12)]_124_[2(3.64e-05)]_\
+    58
 PCR_PEA                          1.93e-11  85_[1(1.55e-14)]_293
-RFBB_NEIGO                       1.77e-19  5_[1(5.96e-12)]_136_[2(5.97e-15)]_155
+RFBB_NEIGO                       1.77e-19  5_[1(5.96e-12)]_136_[2(5.97e-15)]_\
+    155
 YURA_MYXXA                       6.41e-14  157_[2(1.46e-17)]_72
 --------------------------------------------------------------------------------
 
@@ -608,6 +638,6 @@
 Stopped because nmotifs = 2 reached.
 ********************************************************************************
 
-CPU: tlb-sayonara.imb.uq.edu.au
+CPU: tlb-squirrel
 
 ********************************************************************************
diff -r 5836e70b6834 -r 81f90e1597b4 tests/meme/meme.crp0.oops
--- a/tests/meme/meme.crp0.oops	Wed Feb 22 12:48:03 2012 +1000
+++ b/tests/meme/meme.crp0.oops	Wed Feb 22 14:46:22 2012 +1000
@@ -1,7 +1,7 @@
 ********************************************************************************
 MEME - Motif discovery tool
 ********************************************************************************
-MEME version 4.0.0 (Release date: 2008-07-12 05:23:09 +1000 (Sat, 12 Jul 2008))
+MEME version 4.8.1 (Release date: Wed Feb 22 11:51:06 EST 2012)
 
 For further information on how to interpret these results or to get
 a copy of the MEME software please access http://meme.nbcr.net.
@@ -28,7 +28,7 @@
 ********************************************************************************
 TRAINING SET
 ********************************************************************************
-DATAFILE= /Users/t.bailey/meme_svn/positional-priors/scripts/../tests/common/crp0.s
+DATAFILE= /home/james/dist/scripts/../tests/common/crp0.s
 ALPHABET= ACGT
 Sequence name            Weight Length  Sequence name            Weight Length  
 -------------            ------ ------  -------------            ------ ------  
@@ -49,7 +49,7 @@
 This information can also be useful in the event you wish to report a
 problem with the MEME software.
 
-command: meme /Users/t.bailey/meme_svn/positional-priors/scripts/../tests/common/crp0.s -text -mod oops -dna -revcomp -nostatus -nmotifs 2 -minw 8 
+command: meme /home/james/dist/scripts/../tests/common/crp0.s -text -mod oops -dna -revcomp -nostatus -nmotifs 2 -minw 8 
 
 model:  mod=          oops    nmotifs=         2    evt=           inf
 object function=  E-value of product of p-values
@@ -226,7 +226,7 @@
 
 
 
-Time  0.69 secs.
+Time  0.88 secs.
 
 ********************************************************************************
 
@@ -379,7 +379,7 @@
 
 
 
-Time  1.22 secs.
+Time  1.45 secs.
 
 ********************************************************************************
 
@@ -394,17 +394,23 @@
 SEQUENCE NAME            COMBINED P-VALUE  MOTIF DIAGRAM
 -------------            ----------------  -------------
 ce1cg                            5.40e-03  64_[+1(1.07e-05)]_26
-ara                              1.90e-06  8_[+2(1.13e-06)]_38_[-1(2.85e-06)]_2_[-2(5.49e-05)]_20
+ara                              1.90e-06  8_[+2(1.13e-06)]_38_[-1(2.85e-06)]_\
+    2_[-2(5.49e-05)]_20
 bglr1                            1.10e-03  78_[-1(9.67e-06)]_12
 crp                              1.77e-03  65_[-1(1.29e-05)]_25
 cya                              1.08e-03  52_[-1(4.88e-06)]_38
-deop2                            2.60e-04  9_[-1(9.67e-06)]_36_[-2(6.67e-05)]_34
-gale                             7.41e-05  1_[+2(2.81e-06)]_42_[+1(5.85e-05)]_2_[-2(6.67e-05)]_23
+deop2                            2.60e-04  9_[-1(9.67e-06)]_36_[-2(6.67e-05)]_\
+    34
+gale                             7.41e-05  1_[+2(2.81e-06)]_42_[+1(5.85e-05)]_\
+    2_[-2(6.67e-05)]_23
 ilv                              4.88e-04  15_[-2(8.17e-06)]_79
-lac                              1.31e-05  11_[-1(1.61e-06)]_63_[+2(1.58e-05)]_5
-male                             5.21e-04  16_[-1(1.54e-05)]_48_[+2(9.04e-05)]_15
+lac                              1.31e-05  11_[-1(1.61e-06)]_63_[+2(1.58e-05)]_\
+    5
+male                             5.21e-04  16_[-1(1.54e-05)]_48_[+2(9.04e-05)]_\
+    15
 malk                             4.44e-04  64_[+1(5.41e-06)]_26
-malt                             4.02e-05  44_[+1(1.17e-05)]_6_[+2(7.27e-06)]_29
+malt                             4.02e-05  44_[+1(1.17e-05)]_6_[+2(7.27e-06)]_\
+    29
 ompa                             1.77e-04  51_[+1(2.30e-06)]_39
 tnaa                             7.39e-04  74_[+1(3.95e-06)]_16
 uxu1                             6.93e-03  20_[+1(1.54e-05)]_70
@@ -420,6 +426,6 @@
 Stopped because nmotifs = 2 reached.
 ********************************************************************************
 
-CPU: tlb-kamikaze-lt-2.local
+CPU: tlb-squirrel
 
 ********************************************************************************
diff -r 5836e70b6834 -r 81f90e1597b4 tests/meme/meme.crp0.tcm
--- a/tests/meme/meme.crp0.tcm	Wed Feb 22 12:48:03 2012 +1000
+++ b/tests/meme/meme.crp0.tcm	Wed Feb 22 14:46:22 2012 +1000
@@ -1,7 +1,7 @@
 ********************************************************************************
 MEME - Motif discovery tool
 ********************************************************************************
-MEME version 4.0.0 (Release date: 2008-07-12 05:23:09 +1000 (Sat, 12 Jul 2008))
+MEME version 4.8.1 (Release date: Wed Feb 22 11:51:06 EST 2012)
 
 For further information on how to interpret these results or to get
 a copy of the MEME software please access http://meme.nbcr.net.
@@ -28,7 +28,7 @@
 ********************************************************************************
 TRAINING SET
 ********************************************************************************
-DATAFILE= /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/crp0.s
+DATAFILE= /home/james/dist/scripts/../tests/common/crp0.s
 ALPHABET= ACGT
 Sequence name            Weight Length  Sequence name            Weight Length  
 -------------            ------ ------  -------------            ------ ------  
@@ -49,7 +49,7 @@
 This information can also be useful in the event you wish to report a
 problem with the MEME software.
 
-command: meme /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/crp0.s -text -mod tcm -dna -revcomp -nostatus -nmotifs 2 -minw 8 
+command: meme /home/james/dist/scripts/../tests/common/crp0.s -text -mod tcm -dna -revcomp -nostatus -nmotifs 2 -minw 8 
 
 model:  mod=           tcm    nmotifs=         2    evt=           inf
 object function=  E-value of product of p-values
@@ -240,7 +240,7 @@
 
 
 
-Time  4.56 secs.
+Time  3.32 secs.
 
 ********************************************************************************
 
@@ -339,7 +339,7 @@
 
 
 
-Time  7.45 secs.
+Time  5.44 secs.
 
 ********************************************************************************
 
@@ -353,16 +353,21 @@
 --------------------------------------------------------------------------------
 SEQUENCE NAME            COMBINED P-VALUE  MOTIF DIAGRAM
 -------------            ----------------  -------------
-ce1cg                            1.11e-03  16_[-1(3.97e-06)]_28_[+1(1.12e-06)]_23
+ce1cg                            1.11e-03  16_[-1(3.97e-06)]_28_[+1(1.12e-06)]_\
+    23
 ara                              5.71e-05  57_[+1(2.90e-08)]_29
 bglr1                            8.42e-03  78_[+1(6.37e-06)]_8
 crp                              1.95e-03  65_[+1(1.40e-06)]_21
 cya                              7.48e-03  49_[-1(6.37e-06)]_37
-deop2                            1.00e-03  9_[+1(1.94e-06)]_31_[-1(9.94e-07)]_27
+deop2                            1.00e-03  9_[+1(1.94e-06)]_31_[-1(9.94e-07)]_\
+    27
 gale                             2.27e-03  44_[+1(1.40e-06)]_42
-ilv                              7.36e-06  4_[+2(2.18e-06)]_29_[+1(6.37e-06)]_45
-lac                              1.91e-02  11_[+1(3.03e-05)]_42_[-1(2.82e-05)]_14
-male                             9.43e-06  16_[+1(3.26e-06)]_5_[+2(5.56e-06)]_57
+ilv                              7.36e-06  4_[+2(2.18e-06)]_29_[+1(6.37e-06)]_\
+    45
+lac                              1.91e-02  11_[+1(3.03e-05)]_42_[-1(2.82e-05)]_\
+    14
+male                             9.43e-06  16_[+1(3.26e-06)]_5_[+2(5.56e-06)]_\
+    57
 malk                             4.70e-03  60_[-1(1.64e-05)]_26
 malt                             1.60e-03  40_[-1(1.12e-06)]_46
 ompa                             1.60e-03  50_[+1(1.12e-06)]_36
@@ -380,6 +385,6 @@
 Stopped because nmotifs = 2 reached.
 ********************************************************************************
 
-CPU: tlb-sayonara.imb.uq.edu.au
+CPU: tlb-squirrel
 
 ********************************************************************************
diff -r 5836e70b6834 -r 81f90e1597b4 tests/meme/meme.crp0.zoops
--- a/tests/meme/meme.crp0.zoops	Wed Feb 22 12:48:03 2012 +1000
+++ b/tests/meme/meme.crp0.zoops	Wed Feb 22 14:46:22 2012 +1000
@@ -1,7 +1,7 @@
 ********************************************************************************
 MEME - Motif discovery tool
 ********************************************************************************
-MEME version 4.0.0 (Release date: 2008-07-12 05:23:09 +1000 (Sat, 12 Jul 2008))
+MEME version 4.8.1 (Release date: Wed Feb 22 11:51:06 EST 2012)
 
 For further information on how to interpret these results or to get
 a copy of the MEME software please access http://meme.nbcr.net.
@@ -28,7 +28,7 @@
 ********************************************************************************
 TRAINING SET
 ********************************************************************************
-DATAFILE= /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/crp0.s
+DATAFILE= /home/james/dist/scripts/../tests/common/crp0.s
 ALPHABET= ACGT
 Sequence name            Weight Length  Sequence name            Weight Length  
 -------------            ------ ------  -------------            ------ ------  
@@ -49,7 +49,7 @@
 This information can also be useful in the event you wish to report a
 problem with the MEME software.
 
-command: meme /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/crp0.s -text -mod zoops -dna -revcomp -nostatus -nmotifs 2 -minw 8 
+command: meme /home/james/dist/scripts/../tests/common/crp0.s -text -mod zoops -dna -revcomp -nostatus -nmotifs 2 -minw 8 
 
 model:  mod=         zoops    nmotifs=         2    evt=           inf
 object function=  E-value of product of p-values
@@ -232,7 +232,7 @@
 
 
 
-Time  3.66 secs.
+Time  2.57 secs.
 
 ********************************************************************************
 
@@ -331,7 +331,7 @@
 
 
 
-Time  6.04 secs.
+Time  4.11 secs.
 
 ********************************************************************************
 
@@ -352,9 +352,11 @@
 cya                              1.86e-02  49_[+1(1.81e-05)]_38
 deop2                            2.60e-03  59_[+1(2.85e-06)]_28
 gale                             1.73e-02  45_[-1(1.41e-05)]_42
-ilv                              2.14e-06  4_[+2(2.18e-06)]_30_[-1(1.69e-06)]_45
+ilv                              2.14e-06  4_[+2(2.18e-06)]_30_[-1(1.69e-06)]_\
+    45
 lac                              5.79e-04  8_[+1(5.35e-07)]_79
-male                             3.43e-05  13_[+1(1.29e-05)]_9_[+2(5.56e-06)]_57
+male                             3.43e-05  13_[+1(1.29e-05)]_9_[+2(5.56e-06)]_\
+    57
 malk                             4.82e-03  60_[+1(1.67e-05)]_27
 malt                             1.28e-03  40_[+1(8.61e-07)]_47
 ompa                             1.02e-02  47_[+1(9.04e-06)]_40
@@ -372,6 +374,6 @@
 Stopped because nmotifs = 2 reached.
 ********************************************************************************
 
-CPU: tlb-sayonara.imb.uq.edu.au
+CPU: tlb-squirrel
 
 ********************************************************************************
diff -r 5836e70b6834 -r 81f90e1597b4 tests/meme/meme.farntrans5.oops
--- a/tests/meme/meme.farntrans5.oops	Wed Feb 22 12:48:03 2012 +1000
+++ b/tests/meme/meme.farntrans5.oops	Wed Feb 22 14:46:22 2012 +1000
@@ -1,7 +1,7 @@
 ********************************************************************************
 MEME - Motif discovery tool
 ********************************************************************************
-MEME version 4.0.0 (Release date: 2008-07-12 05:23:09 +1000 (Sat, 12 Jul 2008))
+MEME version 4.8.1 (Release date: Wed Feb 22 11:51:06 EST 2012)
 
 For further information on how to interpret these results or to get
 a copy of the MEME software please access http://meme.nbcr.net.
@@ -28,7 +28,7 @@
 ********************************************************************************
 TRAINING SET
 ********************************************************************************
-DATAFILE= /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/farntrans5.s
+DATAFILE= /home/james/dist/scripts/../tests/common/farntrans5.s
 ALPHABET= ACDEFGHIKLMNPQRSTVWY
 Sequence name            Weight Length  Sequence name            Weight Length  
 -------------            ------ ------  -------------            ------ ------  
@@ -43,7 +43,7 @@
 This information can also be useful in the event you wish to report a
 problem with the MEME software.
 
-command: meme /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/farntrans5.s -text -mod oops -protein -nostatus -nmotifs 2 -minw 8 
+command: meme /home/james/dist/scripts/../tests/common/farntrans5.s -text -mod oops -protein -nostatus -nmotifs 2 -minw 8 
 
 model:  mod=          oops    nmotifs=         2    evt=           inf
 object function=  E-value of product of p-values
@@ -237,7 +237,7 @@
 
 
 
-Time  1.24 secs.
+Time  0.89 secs.
 
 ********************************************************************************
 
@@ -390,7 +390,7 @@
 
 
 
-Time  2.20 secs.
+Time  1.61 secs.
 
 ********************************************************************************
 
@@ -404,11 +404,16 @@
 --------------------------------------------------------------------------------
 SEQUENCE NAME            COMBINED P-VALUE  MOTIF DIAGRAM
 -------------            ----------------  -------------
-RAM1_YEAST                       2.49e-40  291_[1(4.70e-27)]_19_[2(3.34e-21)]_67
-PFTB_RAT                         1.93e-40  133_[1(5.68e-09)]_19_[1(4.88e-05)]_16_[1(4.55e-09)]_17_[1(3.49e-29)]_28_[2(3.38e-19)]_74
-BET2_YEAST                       7.54e-48  66_[2(1.77e-05)]_31_[1(4.36e-09)]_16_[1(7.32e-08)]_19_[1(6.27e-34)]_15_[2(1.18e-21)]_38
-RATRABGERB                       1.07e-48  126_[1(2.13e-09)]_16_[1(4.63e-06)]_16_[1(1.37e-32)]_15_[2(7.25e-24)]_40
-CAL1_YEAST                       2.44e-33  270_[1(5.14e-27)]_18_[2(4.81e-14)]_34
+RAM1_YEAST                       2.49e-40  291_[1(4.70e-27)]_19_[2(3.34e-21)]_\
+    67
+PFTB_RAT                         1.93e-40  133_[1(5.68e-09)]_19_[1(4.88e-05)]_\
+    16_[1(4.55e-09)]_17_[1(3.49e-29)]_28_[2(3.38e-19)]_74
+BET2_YEAST                       7.54e-48  66_[2(1.77e-05)]_31_[1(4.36e-09)]_\
+    16_[1(7.32e-08)]_19_[1(6.27e-34)]_15_[2(1.18e-21)]_38
+RATRABGERB                       1.07e-48  126_[1(2.13e-09)]_16_[1(4.63e-06)]_\
+    16_[1(1.37e-32)]_15_[2(7.25e-24)]_40
+CAL1_YEAST                       2.44e-33  270_[1(5.14e-27)]_18_[2(4.81e-14)]_\
+    34
 --------------------------------------------------------------------------------
 
 ********************************************************************************
@@ -418,6 +423,6 @@
 Stopped because nmotifs = 2 reached.
 ********************************************************************************
 
-CPU: tlb-sayonara.imb.uq.edu.au
+CPU: tlb-squirrel
 
 ********************************************************************************
diff -r 5836e70b6834 -r 81f90e1597b4 tests/meme/meme.farntrans5.tcm
--- a/tests/meme/meme.farntrans5.tcm	Wed Feb 22 12:48:03 2012 +1000
+++ b/tests/meme/meme.farntrans5.tcm	Wed Feb 22 14:46:22 2012 +1000
@@ -1,7 +1,7 @@
 ********************************************************************************
 MEME - Motif discovery tool
 ********************************************************************************
-MEME version 4.0.0 (Release date: 2008-07-12 05:23:09 +1000 (Sat, 12 Jul 2008))
+MEME version 4.8.1 (Release date: Wed Feb 22 11:51:06 EST 2012)
 
 For further information on how to interpret these results or to get
 a copy of the MEME software please access http://meme.nbcr.net.
@@ -28,7 +28,7 @@
 ********************************************************************************
 TRAINING SET
 ********************************************************************************
-DATAFILE= /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/farntrans5.s
+DATAFILE= /home/james/dist/scripts/../tests/common/farntrans5.s
 ALPHABET= ACDEFGHIKLMNPQRSTVWY
 Sequence name            Weight Length  Sequence name            Weight Length  
 -------------            ------ ------  -------------            ------ ------  
@@ -43,7 +43,7 @@
 This information can also be useful in the event you wish to report a
 problem with the MEME software.
 
-command: meme /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/farntrans5.s -text -mod tcm -protein -nostatus -nmotifs 2 -minw 8 
+command: meme /home/james/dist/scripts/../tests/common/farntrans5.s -text -mod tcm -protein -nostatus -nmotifs 2 -minw 8 
 
 model:  mod=           tcm    nmotifs=         2    evt=           inf
 object function=  E-value of product of p-values
@@ -274,7 +274,7 @@
 
 
 
-Time  9.37 secs.
+Time  7.64 secs.
 
 ********************************************************************************
 
@@ -443,7 +443,7 @@
 
 
 
-Time 13.92 secs.
+Time 11.39 secs.
 
 ********************************************************************************
 
@@ -457,11 +457,20 @@
 --------------------------------------------------------------------------------
 SEQUENCE NAME            COMBINED P-VALUE  MOTIF DIAGRAM
 -------------            ----------------  -------------
-RAM1_YEAST                       1.09e-19  144_[1(8.68e-17)]_5_[2(1.44e-07)]_4_[1(1.67e-13)]_1_[2(2.07e-08)]_4_[1(4.93e-17)]_1_[2(2.70e-10)]_4_[1(2.87e-16)]_4_[2(4.96e-08)]_5_[1(5.11e-13)]_35_[2(6.96e-09)]_4
-PFTB_RAT                         5.87e-22  72_[2(1.55e-07)]_51_[1(2.44e-19)]_4_[2(4.03e-10)]_3_[1(3.29e-14)]_1_[2(1.26e-08)]_3_[1(1.56e-19)]_1_[2(6.39e-09)]_4_[1(2.62e-16)]_32_[1(7.66e-15)]_60
-BET2_YEAST                       2.36e-26  6_[2(3.17e-09)]_3_[1(2.82e-10)]_1_[2(1.37e-08)]_4_[1(7.21e-14)]_4_[2(1.93e-07)]_3_[1(2.77e-17)]_18_[1(2.53e-18)]_21_[1(6.98e-22)]_1_[2(5.70e-12)]_4_[1(7.19e-17)]_24
-RATRABGERB                       7.64e-26  17_[2(1.15e-07)]_34_[2(2.71e-12)]_3_[1(2.21e-14)]_1_[2(1.27e-09)]_3_[1(8.90e-19)]_1_[2(2.61e-11)]_3_[1(6.47e-19)]_18_[1(4.67e-21)]_1_[2(6.43e-12)]_4_[1(1.27e-17)]_26
-CAL1_YEAST                       5.59e-23  35_[2(5.20e-07)]_76_[2(1.06e-08)]_50_[2(6.30e-11)]_1_[1(1.14e-13)]_40_[1(1.25e-19)]_22_[1(4.42e-13)]_20
+RAM1_YEAST                       1.09e-19  144_[1(8.68e-17)]_5_[2(1.44e-07)]_4_\
+    [1(1.67e-13)]_1_[2(2.07e-08)]_4_[1(4.93e-17)]_1_[2(2.70e-10)]_4_\
+    [1(2.87e-16)]_4_[2(4.96e-08)]_5_[1(5.11e-13)]_35_[2(6.96e-09)]_4
+PFTB_RAT                         5.87e-22  72_[2(1.55e-07)]_51_[1(2.44e-19)]_4_\
+    [2(4.03e-10)]_3_[1(3.29e-14)]_1_[2(1.26e-08)]_3_[1(1.56e-19)]_1_\
+    [2(6.39e-09)]_4_[1(2.62e-16)]_32_[1(7.66e-15)]_60
+BET2_YEAST                       2.36e-26  6_[2(3.17e-09)]_3_[1(2.82e-10)]_1_\
+    [2(1.37e-08)]_4_[1(7.21e-14)]_4_[2(1.93e-07)]_3_[1(2.77e-17)]_18_\
+    [1(2.53e-18)]_21_[1(6.98e-22)]_1_[2(5.70e-12)]_4_[1(7.19e-17)]_24
+RATRABGERB                       7.64e-26  17_[2(1.15e-07)]_34_[2(2.71e-12)]_3_\
+    [1(2.21e-14)]_1_[2(1.27e-09)]_3_[1(8.90e-19)]_1_[2(2.61e-11)]_3_\
+    [1(6.47e-19)]_18_[1(4.67e-21)]_1_[2(6.43e-12)]_4_[1(1.27e-17)]_26
+CAL1_YEAST                       5.59e-23  35_[2(5.20e-07)]_76_[2(1.06e-08)]_\
+    50_[2(6.30e-11)]_1_[1(1.14e-13)]_40_[1(1.25e-19)]_22_[1(4.42e-13)]_20
 --------------------------------------------------------------------------------
 
 ********************************************************************************
@@ -471,6 +480,6 @@
 Stopped because nmotifs = 2 reached.
 ********************************************************************************
 
-CPU: tlb-sayonara.imb.uq.edu.au
+CPU: tlb-squirrel
 
 ********************************************************************************
diff -r 5836e70b6834 -r 81f90e1597b4 tests/meme/meme.farntrans5.zoops
--- a/tests/meme/meme.farntrans5.zoops	Wed Feb 22 12:48:03 2012 +1000
+++ b/tests/meme/meme.farntrans5.zoops	Wed Feb 22 14:46:22 2012 +1000
@@ -1,7 +1,7 @@
 ********************************************************************************
 MEME - Motif discovery tool
 ********************************************************************************
-MEME version 4.0.0 (Release date: 2008-07-12 05:23:09 +1000 (Sat, 12 Jul 2008))
+MEME version 4.8.1 (Release date: Wed Feb 22 11:51:06 EST 2012)
 
 For further information on how to interpret these results or to get
 a copy of the MEME software please access http://meme.nbcr.net.
@@ -28,7 +28,7 @@
 ********************************************************************************
 TRAINING SET
 ********************************************************************************
-DATAFILE= /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/farntrans5.s
+DATAFILE= /home/james/dist/scripts/../tests/common/farntrans5.s
 ALPHABET= ACDEFGHIKLMNPQRSTVWY
 Sequence name            Weight Length  Sequence name            Weight Length  
 -------------            ------ ------  -------------            ------ ------  
@@ -43,7 +43,7 @@
 This information can also be useful in the event you wish to report a
 problem with the MEME software.
 
-command: meme /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/farntrans5.s -text -mod zoops -protein -nostatus -nmotifs 2 -minw 8 
+command: meme /home/james/dist/scripts/../tests/common/farntrans5.s -text -mod zoops -protein -nostatus -nmotifs 2 -minw 8 
 
 model:  mod=         zoops    nmotifs=         2    evt=           inf
 object function=  E-value of product of p-values
@@ -237,7 +237,7 @@
 
 
 
-Time  2.91 secs.
+Time  2.19 secs.
 
 ********************************************************************************
 
@@ -443,7 +443,7 @@
 
 
 
-Time  5.70 secs.
+Time  4.34 secs.
 
 ********************************************************************************
 
@@ -457,11 +457,16 @@
 --------------------------------------------------------------------------------
 SEQUENCE NAME            COMBINED P-VALUE  MOTIF DIAGRAM
 -------------            ----------------  -------------
-RAM1_YEAST                       8.29e-64  205_[2(7.64e-45)]_36_[1(4.70e-27)]_108
-PFTB_RAT                         8.01e-65  133_[1(5.68e-09)]_31_[2(9.48e-44)]_35_[1(3.49e-29)]_30_[1(6.10e-07)]_62
-BET2_YEAST                       1.87e-70  31_[2(1.42e-05)]_50_[2(2.21e-44)]_37_[1(6.27e-34)]_17_[1(9.32e-07)]_26
-RATRABGERB                       1.33e-67  42_[2(3.11e-09)]_46_[2(7.21e-43)]_34_[1(1.37e-32)]_17_[1(2.11e-07)]_28
-CAL1_YEAST                       1.63e-25  212_[2(4.52e-06)]_8_[1(5.14e-27)]_20_[1(5.21e-05)]_22
+RAM1_YEAST                       8.29e-64  205_[2(7.64e-45)]_36_[1(4.70e-27)]_\
+    108
+PFTB_RAT                         8.01e-65  133_[1(5.68e-09)]_31_[2(9.48e-44)]_\
+    35_[1(3.49e-29)]_30_[1(6.10e-07)]_62
+BET2_YEAST                       1.87e-70  31_[2(1.42e-05)]_50_[2(2.21e-44)]_\
+    37_[1(6.27e-34)]_17_[1(9.32e-07)]_26
+RATRABGERB                       1.33e-67  42_[2(3.11e-09)]_46_[2(7.21e-43)]_\
+    34_[1(1.37e-32)]_17_[1(2.11e-07)]_28
+CAL1_YEAST                       1.63e-25  212_[2(4.52e-06)]_8_[1(5.14e-27)]_\
+    20_[1(5.21e-05)]_22
 --------------------------------------------------------------------------------
 
 ********************************************************************************
@@ -471,6 +476,6 @@
 Stopped because nmotifs = 2 reached.
 ********************************************************************************
 
-CPU: tlb-sayonara.imb.uq.edu.au
+CPU: tlb-squirrel
 
 ********************************************************************************
diff -r 5836e70b6834 -r 81f90e1597b4 tests/meme/meme.lipocalin.oops
--- a/tests/meme/meme.lipocalin.oops	Wed Feb 22 12:48:03 2012 +1000
+++ b/tests/meme/meme.lipocalin.oops	Wed Feb 22 14:46:22 2012 +1000
@@ -1,7 +1,7 @@
 ********************************************************************************
 MEME - Motif discovery tool
 ********************************************************************************
-MEME version 4.0.0 (Release date: 2008-07-12 05:23:09 +1000 (Sat, 12 Jul 2008))
+MEME version 4.8.1 (Release date: Wed Feb 22 11:51:06 EST 2012)
 
 For further information on how to interpret these results or to get
 a copy of the MEME software please access http://meme.nbcr.net.
@@ -28,7 +28,7 @@
 ********************************************************************************
 TRAINING SET
 ********************************************************************************
-DATAFILE= /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/lipocalin.s
+DATAFILE= /home/james/dist/scripts/../tests/common/lipocalin.s
 ALPHABET= ACDEFGHIKLMNPQRSTVWY
 Sequence name            Weight Length  Sequence name            Weight Length  
 -------------            ------ ------  -------------            ------ ------  
@@ -43,7 +43,7 @@
 This information can also be useful in the event you wish to report a
 problem with the MEME software.
 
-command: meme /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/lipocalin.s -text -mod oops -protein -nostatus -nmotifs 2 -minw 8 
+command: meme /home/james/dist/scripts/../tests/common/lipocalin.s -text -mod oops -protein -nostatus -nmotifs 2 -minw 8 
 
 model:  mod=          oops    nmotifs=         2    evt=           inf
 object function=  E-value of product of p-values
@@ -211,7 +211,7 @@
 
 
 
-Time  0.63 secs.
+Time  0.53 secs.
 
 ********************************************************************************
 
@@ -360,7 +360,7 @@
 
 
 
-Time  1.13 secs.
+Time  0.92 secs.
 
 ********************************************************************************
 
@@ -374,11 +374,16 @@
 --------------------------------------------------------------------------------
 SEQUENCE NAME            COMBINED P-VALUE  MOTIF DIAGRAM
 -------------            ----------------  -------------
-ICYA_MANSE                       1.22e-30  13_[1(1.35e-18)]_67_[2(4.19e-19)]_70
-LACB_BOVIN                       6.79e-21  21_[1(8.37e-15)]_64_[2(6.21e-13)]_54
-BBP_PIEBR                        2.37e-29  12_[1(1.29e-17)]_64_[2(1.08e-18)]_58
-RETB_BOVIN                       8.72e-26  10_[1(2.09e-16)]_71_[2(2.46e-16)]_63
-MUP2_MOUSE                       3.21e-21  23_[1(4.32e-14)]_62_[2(5.47e-14)]_56
+ICYA_MANSE                       1.22e-30  13_[1(1.35e-18)]_67_[2(4.19e-19)]_\
+    70
+LACB_BOVIN                       6.79e-21  21_[1(8.37e-15)]_64_[2(6.21e-13)]_\
+    54
+BBP_PIEBR                        2.37e-29  12_[1(1.29e-17)]_64_[2(1.08e-18)]_\
+    58
+RETB_BOVIN                       8.72e-26  10_[1(2.09e-16)]_71_[2(2.46e-16)]_\
+    63
+MUP2_MOUSE                       3.21e-21  23_[1(4.32e-14)]_62_[2(5.47e-14)]_\
+    56
 --------------------------------------------------------------------------------
 
 ********************************************************************************
@@ -388,6 +393,6 @@
 Stopped because nmotifs = 2 reached.
 ********************************************************************************
 
-CPU: tlb-sayonara.imb.uq.edu.au
+CPU: tlb-squirrel
 
 ********************************************************************************
diff -r 5836e70b6834 -r 81f90e1597b4 tests/meme/meme.lipocalin.tcm
--- a/tests/meme/meme.lipocalin.tcm	Wed Feb 22 12:48:03 2012 +1000
+++ b/tests/meme/meme.lipocalin.tcm	Wed Feb 22 14:46:22 2012 +1000
@@ -1,7 +1,7 @@
 ********************************************************************************
 MEME - Motif discovery tool
 ********************************************************************************
-MEME version 4.0.0 (Release date: 2008-07-12 05:23:09 +1000 (Sat, 12 Jul 2008))
+MEME version 4.8.1 (Release date: Wed Feb 22 11:51:06 EST 2012)
 
 For further information on how to interpret these results or to get
 a copy of the MEME software please access http://meme.nbcr.net.
@@ -28,7 +28,7 @@
 ********************************************************************************
 TRAINING SET
 ********************************************************************************
-DATAFILE= /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/lipocalin.s
+DATAFILE= /home/james/dist/scripts/../tests/common/lipocalin.s
 ALPHABET= ACDEFGHIKLMNPQRSTVWY
 Sequence name            Weight Length  Sequence name            Weight Length  
 -------------            ------ ------  -------------            ------ ------  
@@ -43,7 +43,7 @@
 This information can also be useful in the event you wish to report a
 problem with the MEME software.
 
-command: meme /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/lipocalin.s -text -mod tcm -protein -nostatus -nmotifs 2 -minw 8 
+command: meme /home/james/dist/scripts/../tests/common/lipocalin.s -text -mod tcm -protein -nostatus -nmotifs 2 -minw 8 
 
 model:  mod=           tcm    nmotifs=         2    evt=           inf
 object function=  E-value of product of p-values
@@ -223,7 +223,7 @@
 
 
 
-Time  3.34 secs.
+Time  2.72 secs.
 
 ********************************************************************************
 
@@ -407,7 +407,7 @@
 
 
 
-Time  6.43 secs.
+Time  5.23 secs.
 
 ********************************************************************************
 
@@ -435,6 +435,6 @@
 Stopped because nmotifs = 2 reached.
 ********************************************************************************
 
-CPU: tlb-sayonara.imb.uq.edu.au
+CPU: tlb-squirrel
 
 ********************************************************************************
diff -r 5836e70b6834 -r 81f90e1597b4 tests/meme/meme.lipocalin.zoops
--- a/tests/meme/meme.lipocalin.zoops	Wed Feb 22 12:48:03 2012 +1000
+++ b/tests/meme/meme.lipocalin.zoops	Wed Feb 22 14:46:22 2012 +1000
@@ -1,7 +1,7 @@
 ********************************************************************************
 MEME - Motif discovery tool
 ********************************************************************************
-MEME version 4.0.0 (Release date: 2008-07-12 05:23:09 +1000 (Sat, 12 Jul 2008))
+MEME version 4.8.1 (Release date: Wed Feb 22 11:51:06 EST 2012)
 
 For further information on how to interpret these results or to get
 a copy of the MEME software please access http://meme.nbcr.net.
@@ -28,7 +28,7 @@
 ********************************************************************************
 TRAINING SET
 ********************************************************************************
-DATAFILE= /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/lipocalin.s
+DATAFILE= /home/james/dist/scripts/../tests/common/lipocalin.s
 ALPHABET= ACDEFGHIKLMNPQRSTVWY
 Sequence name            Weight Length  Sequence name            Weight Length  
 -------------            ------ ------  -------------            ------ ------  
@@ -43,7 +43,7 @@
 This information can also be useful in the event you wish to report a
 problem with the MEME software.
 
-command: meme /home/t.bailey/MEME/SVNROOT/trunk/scripts/../tests/common/lipocalin.s -text -mod zoops -protein -nostatus -nmotifs 2 -minw 8 
+command: meme /home/james/dist/scripts/../tests/common/lipocalin.s -text -mod zoops -protein -nostatus -nmotifs 2 -minw 8 
 
 model:  mod=         zoops    nmotifs=         2    evt=           inf
 object function=  E-value of product of p-values
@@ -225,7 +225,7 @@
 
 
 
-Time  1.84 secs.
+Time  1.49 secs.
 
 ********************************************************************************
 
@@ -374,7 +374,7 @@
 
 
 
-Time  3.27 secs.
+Time  2.64 secs.
 
 ********************************************************************************
 
@@ -389,10 +389,12 @@
 SEQUENCE NAME            COMBINED P-VALUE  MOTIF DIAGRAM
 -------------            ----------------  -------------
 ICYA_MANSE                       2.35e-36  6_[1(2.29e-24)]_67_[2(4.19e-19)]_70
-LACB_BOVIN                       2.62e-24  14_[1(2.92e-18)]_64_[2(6.21e-13)]_54
+LACB_BOVIN                       2.62e-24  14_[1(2.92e-18)]_64_[2(6.21e-13)]_\
+    54
 BBP_PIEBR                        3.76e-36  5_[1(1.76e-24)]_64_[2(1.08e-18)]_58
 RETB_BOVIN                       8.78e-29  3_[1(1.97e-19)]_71_[2(2.46e-16)]_63
-MUP2_MOUSE                       5.29e-24  16_[1(6.60e-17)]_62_[2(5.47e-14)]_56
+MUP2_MOUSE                       5.29e-24  16_[1(6.60e-17)]_62_[2(5.47e-14)]_\
+    56
 --------------------------------------------------------------------------------
 
 ********************************************************************************
@@ -402,6 +404,6 @@
 Stopped because nmotifs = 2 reached.
 ********************************************************************************
 
-CPU: tlb-sayonara.imb.uq.edu.au
+CPU: tlb-squirrel
 
 ********************************************************************************
# HG changeset patch
# User James Johnson <j.johnson@imb.uq.edu.au>
# Date 1330415874 -36000
# Node ID bd2d22b864256dc0b42b6a56bef63becb270d989
# Parent  81f90e1597b487144ea82df256c8b1eccd8a3923
Fixed bug in MAST originally introduced in revision 2337 (aka fc487af14785 ).

That revision added the ambiguity characters J and O to hash_alph.h however the
background frequency tables were not updated leading to wrong values being looked up.
As this bug only effected protein motif searches and the tests in runcheck only
test DNA motif searches this bug was not noticed for a long time...

To fix this bug I added in the missing frequency entries in hash_alph.h.

Also the additiona of the 2 new columns to the internal format in MAST lead to
it calculating slightly different pearson correleation coefficients. I have
changed the correlation calculation to only use the real (not ambiguous) columns.

As I modified the pearson correleation coefficient calculation I had to update
the tests to match. I also updated a MEME test which I had forgotten previously.

Note that mast.INO_up800.zoops changed more dramatically as input motifs changed
since the test had been last generated.

diff -r 81f90e1597b4 -r bd2d22b86425 src/hash_alph.h
--- a/src/hash_alph.h	Wed Feb 22 14:46:22 2012 +1000
+++ b/src/hash_alph.h	Tue Feb 28 17:57:54 2012 +1000
@@ -152,10 +152,12 @@
     0.069259642 /* G */,
     0.022405456 /* H */,
     0.056227000 /* I */,
+    0.0         /* J; added manually */,
     0.058435042 /* K */,
     0.091621836 /* L */,
     0.023044274 /* M */,
     0.046032137 /* N */,
+    0.0         /* O; added manually */,
     0.050623807 /* P */,
     0.040715284 /* Q */,
     0.051846246 /* R */,
@@ -185,10 +187,12 @@
    0.07363406 /* G */,
    0.02911862 /* H */,
    0.04092760 /* I */,
+   0.0        /* J; added manually */,
    0.05187635 /* K */,
    0.09566732 /* L */,
    0.01747826 /* M */,
    0.03216447 /* N */,
+   0.0        /* O; added manually */,
    0.06506016 /* P */,
    0.04180057 /* Q */,
    0.06748940 /* R */,
@@ -214,10 +218,12 @@
    0.05 /* G */,
    0.05 /* H */,
    0.05 /* I */,
+   0.0  /* J (ambiguity character for I or L) */,
    0.05 /* K */,
    0.05 /* L */,
    0.05 /* M */,
    0.05 /* N */,
+   0.0  /* O (ambiguity character for anything) */,
    0.05 /* P */,
    0.05 /* Q */,
    0.05 /* R */,
diff -r 81f90e1597b4 -r bd2d22b86425 src/logodds.c
--- a/src/logodds.c	Wed Feb 22 14:46:22 2012 +1000
+++ b/src/logodds.c	Tue Feb 28 17:57:54 2012 +1000
@@ -432,17 +432,22 @@
   LO *los[]			/* array of logodds structures */
 )
 {
-  int i, j, k, l, m, n, o;
+  int i, j, k, l, m, n, o, alen;
   double *means[MAXLO];			/* means of motif columns */
+  char *alphabet;
+  /* only use non-ambiguous chars in correlation */
+  alphabet = (nmotifs > 0 && los[0]->dna ? DNA0 : PROTEIN0);
+  alen = strlen(alphabet);
 
   /* compute the motif column means */
   for (i=0; i<nmotifs; i++) {
     int w = los[i]->w;			/* width of motif i */
-    int alen = los[i]->alen;		/* alphabet length */
     means[i] = NULL; Resize(means[i], w, double);
     for (j=0; j<w; j++) {		/* motif column */
       means[i][j] = 0;
-      for (k=0; k<alen; k++) means[i][j] += los[i]->logodds(j,k);
+      for (k=0; k<alen; k++) {
+        means[i][j] += los[i]->logodds(j, hash(alphabet[k]));
+      }
       means[i][j] /= alen;
     }
   }
@@ -451,7 +456,6 @@
      motif pairs
   */
   for (i=0; i<nmotifs; i++) {			/* "from" motif */
-    int alen = los[i]->alen;		 	/* alphabet length */
     los[i]->corr = NULL;
     Resize(los[i]->corr, nmotifs, double);	/* create correlation array */
     for (j=0; j<i; j++) {			/* "to" motif */
@@ -481,8 +485,9 @@
 	    double sum1=0, sum2=0, sum3=0;
 	    double r, denom;
 	    for (n=0; n<alen; n++) { 		/* letter */
-	      double a = lo1->logodds(l,n) - mu1[l];
-	      double b = lo2->logodds(m,n) - mu2[m];
+	      int pos = hash(alphabet[n]);
+	      double a = lo1->logodds(l,pos) - mu1[l];
+	      double b = lo2->logodds(m,pos) - mu2[m];
 	      sum1 += a * b;
 	      sum2 += a * a;
 	      sum3 += b * b;
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.INO_up800.oops
--- a/tests/mast/mast.INO_up800.oops	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.INO_up800.oops	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.INO_up800.oops /home/james/memesvn/gomo2/scripts/../tests/common/INO_up800.s -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.INO_up800.oops /home/james/meme/scripts/../tests/common/INO_up800.s -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="combine"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Fri Apr  9 17:08:52 2010</when>
+		<when>Tue Feb 28 17:27:34 2012</when>
 	</model>
 	<alphabet type="nucleotide" bg_source="preset">
 		<letter symbol="A" bg_value="0.274"/>
@@ -82,13 +82,13 @@
 		<letter symbol="G" bg_value="0.225"/>
 		<letter symbol="T" bg_value="0.274"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.INO_up800.oops" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.INO_up800.oops" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.INO_up800.oops" name="/home/james/meme/scripts/../tests/meme/meme.INO_up800.oops" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="17" best_f="GGCGGCATGTGAAAAGT" best_r="ACTTTTCACATGCCGCC"/>
 		<motif id="motif_2" num="2" name="2" width="10" best_f="TCTGGCACAG" best_r="CTGTGCCAGA"/>
-		<correlation motif_a="motif_1" motif_b="motif_2" value="0.25"/>
+		<correlation motif_a="motif_1" motif_b="motif_2" value="0.26"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="/home/james/memesvn/gomo2/scripts/../tests/common/INO_up800.s" name="/home/james/memesvn/gomo2/scripts/../tests/common/INO_up800.s" last_mod_date="Mon Feb 15 12:10:17 2010" seq_count="7" residue_count="5600" type="nucleotide"/>
+		<database id="db_1" num="1" source="/home/james/meme/scripts/../tests/common/INO_up800.s" name="/home/james/meme/scripts/../tests/common/INO_up800.s" last_mod_date="Wed Nov  9 18:52:42 2011" seq_count="7" residue_count="5600" type="nucleotide"/>
 		<sequence id="seq_1_6" db="db_1" num="6" name="INO1" comment="sequence of the region upstream from YJL153C" length="800">
 			<score strand="both" combined_pvalue="8.79e-07" evalue="6.2e-06"/>
 			<seg start="226">
@@ -214,5 +214,5 @@
 			</seg>
 		</sequence>
 	</sequences>
-	<runtime cycles="10000" seconds="0.010"/>
+	<runtime cycles="20001" seconds="0.020"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.INO_up800.tcm
--- a/tests/mast/mast.INO_up800.tcm	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.INO_up800.tcm	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.INO_up800.tcm /home/james/memesvn/gomo2/scripts/../tests/common/INO_up800.s -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.INO_up800.tcm /home/james/meme/scripts/../tests/common/INO_up800.s -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="combine"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Fri Apr  9 17:08:52 2010</when>
+		<when>Tue Feb 28 17:27:34 2012</when>
 	</model>
 	<alphabet type="nucleotide" bg_source="preset">
 		<letter symbol="A" bg_value="0.274"/>
@@ -82,13 +82,13 @@
 		<letter symbol="G" bg_value="0.225"/>
 		<letter symbol="T" bg_value="0.274"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.INO_up800.tcm" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.INO_up800.tcm" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.INO_up800.tcm" name="/home/james/meme/scripts/../tests/meme/meme.INO_up800.tcm" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="13" best_f="TTCACATGCCGCC" best_r="GGCGGCATGTGAA"/>
 		<motif id="motif_2" num="2" name="2" width="29" best_f="TTGTCTCCTTTCTTGCTGTTCTTCACGTC" best_r="GACGTGAAGAACAGCAAGAAAGGAGACAA"/>
-		<correlation motif_a="motif_1" motif_b="motif_2" value="0.36"/>
+		<correlation motif_a="motif_1" motif_b="motif_2" value="0.35"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="/home/james/memesvn/gomo2/scripts/../tests/common/INO_up800.s" name="/home/james/memesvn/gomo2/scripts/../tests/common/INO_up800.s" last_mod_date="Mon Feb 15 12:10:17 2010" seq_count="7" residue_count="5600" type="nucleotide"/>
+		<database id="db_1" num="1" source="/home/james/meme/scripts/../tests/common/INO_up800.s" name="/home/james/meme/scripts/../tests/common/INO_up800.s" last_mod_date="Wed Nov  9 18:52:42 2011" seq_count="7" residue_count="5600" type="nucleotide"/>
 		<sequence id="seq_1_6" db="db_1" num="6" name="INO1" comment="sequence of the region upstream from YJL153C" length="800">
 			<score strand="both" combined_pvalue="3.68e-12" evalue="2.6e-11"/>
 			<seg start="76">
@@ -302,5 +302,5 @@
 			</seg>
 		</sequence>
 	</sequences>
-	<runtime cycles="0" seconds="0.000"/>
+	<runtime cycles="24001" seconds="0.024"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.INO_up800.zoops
--- a/tests/mast/mast.INO_up800.zoops	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.INO_up800.zoops	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.INO_up800.zoops /home/james/memesvn/gomo2/scripts/../tests/common/INO_up800.s -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.INO_up800.zoops /home/james/meme/scripts/../tests/common/INO_up800.s -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="combine"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Fri Apr  9 17:08:52 2010</when>
+		<when>Tue Feb 28 17:27:34 2012</when>
 	</model>
 	<alphabet type="nucleotide" bg_source="preset">
 		<letter symbol="A" bg_value="0.274"/>
@@ -82,57 +82,27 @@
 		<letter symbol="G" bg_value="0.225"/>
 		<letter symbol="T" bg_value="0.274"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.INO_up800.zoops" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.INO_up800.zoops" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.INO_up800.zoops" name="/home/james/meme/scripts/../tests/meme/meme.INO_up800.zoops" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="17" best_f="GGCGGCATGTGAAAAGT" best_r="ACTTTTCACATGCCGCC"/>
-		<motif id="motif_2" num="2" name="2" width="10" best_f="TCTGGCACAG" best_r="CTGTGCCAGA"/>
-		<correlation motif_a="motif_1" motif_b="motif_2" value="0.24"/>
+		<motif id="motif_2" num="2" name="2" width="21" best_f="CACGGCCCCATCACCACTGTC" best_r="GACAGTGGTGATGGGGCCGTG"/>
+		<correlation motif_a="motif_1" motif_b="motif_2" value="0.22"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="/home/james/memesvn/gomo2/scripts/../tests/common/INO_up800.s" name="/home/james/memesvn/gomo2/scripts/../tests/common/INO_up800.s" last_mod_date="Mon Feb 15 12:10:17 2010" seq_count="7" residue_count="5600" type="nucleotide"/>
-		<sequence id="seq_1_1" db="db_1" num="1" name="CHO1" comment="sequence of the region upstream from YER026C" length="800">
-			<score strand="both" combined_pvalue="8.80e-07" evalue="6.2e-06"/>
-			<seg start="526">
-				<data>
-CAATCCCCACTCCTTCTCAATGTGTGCAGACTTCTGTGCCAGACACTGAATATATATCAGTAATTGGTCAAAATC
-				</data>
-				<hit pos="559" gap="558" motif="motif_2" pvalue="7.4e-07" strand="reverse" match="++++++++++"/>
-			</seg>
-			<seg start="601">
-				<data>
-ACTTTGAACGTTCACACGGCACCCTCACGCCTTTGAGCTTTCACATGGACCCATCTAAAGATGAAGATCCGTATT
-				</data>
-				<hit pos="607" gap="38" motif="motif_1" pvalue="3.9e-05" strand="reverse" match="+   ++++++ +++ ++"/>
-				<hit pos="636" gap="12" motif="motif_1" pvalue="2.7e-08" strand="reverse" match="++ ++++++++++ +++"/>
-			</seg>
-		</sequence>
-		<sequence id="seq_1_5" db="db_1" num="5" name="ACC1" comment="sequence of the region upstream from YNR016C" length="800">
-			<score strand="both" combined_pvalue="8.80e-07" evalue="6.2e-06"/>
-			<seg start="76">
-				<data>
-TAAAATCTTCACATGGCCCGGCCGCGCGCGCGTTGTGCCAACAAGTCGCAGTCGAAATTCAACCGCTCATTGCCA
-				</data>
-				<hit pos="79" gap="78" motif="motif_1" pvalue="2.7e-08" strand="reverse" match="+ ++++++++++++++ "/>
-			</seg>
-			<seg start="226">
-				<data>
-TCGTATTCTGGCACAGTATAGCCTAGCACAATCACTGTCACAATTGTTATCGGTTCTACAATTGTTCTGCTCTCT
-				</data>
-				<hit pos="232" gap="136" motif="motif_2" pvalue="7.4e-07" strand="forward" match="++++++++++"/>
-			</seg>
-		</sequence>
+		<database id="db_1" num="1" source="/home/james/meme/scripts/../tests/common/INO_up800.s" name="/home/james/meme/scripts/../tests/common/INO_up800.s" last_mod_date="Wed Nov  9 18:52:42 2011" seq_count="7" residue_count="5600" type="nucleotide"/>
 		<sequence id="seq_1_6" db="db_1" num="6" name="INO1" comment="sequence of the region upstream from YJL153C" length="800">
-			<score strand="both" combined_pvalue="9.47e-07" evalue="6.6e-06"/>
+			<score strand="both" combined_pvalue="3.33e-10" evalue="2.3e-09"/>
 			<seg start="301">
 				<data>
 GTGACCTGGAAGCTCACCCTGCAGAGGAATCTCAAGCACAGCCTCCAGCATATGATGAAGACGATGAGGCCGGTG
+CCGATGTGCCCTTGATGGACAACAAACAACAGCTCTCTTCCGGCCGTACTTAGTGATCGGAACGAGCTCTTTATC
 				</data>
-				<hit pos="332" gap="331" motif="motif_2" pvalue="2.0e-05" strand="forward" match="++  ++++++"/>
+				<hit pos="369" gap="368" motif="motif_2" pvalue="4.7e-09" strand="reverse" match="+ + +++ +++++++++++++"/>
 			</seg>
 			<seg start="526">
 				<data>
 TGAAATACGTGCCGGTGTTCCGGGGTTGGATGCGGAATCGAAAGTGTTGAATGTGAAATATGCGGAGGCCAAGTA
 				</data>
-				<hit pos="570" gap="228" motif="motif_1" pvalue="8.5e-05" strand="forward" match=" +  + ++++++++  +"/>
+				<hit pos="570" gap="180" motif="motif_1" pvalue="8.5e-05" strand="forward" match=" +  + ++++++++  +"/>
 			</seg>
 			<seg start="601">
 				<data>
@@ -141,19 +111,34 @@
 				<hit pos="619" gap="32" motif="motif_1" pvalue="1.1e-09" strand="forward" match=" ++++++++++++++++"/>
 			</seg>
 		</sequence>
+		<sequence id="seq_1_4" db="db_1" num="4" name="FAS2" comment="sequence of the region upstream from YPL231W" length="800">
+			<score strand="both" combined_pvalue="1.21e-09" evalue="8.5e-09"/>
+			<seg start="526">
+				<data>
+GCTTAGCAAAATCCAACCATTTTTTTTTTATCTCCCGCGTTTTCACATGCTACCTCATTCGCCTCGTAACGTTAC
+				</data>
+				<hit pos="563" gap="562" motif="motif_1" pvalue="1.1e-07" strand="reverse" match=" ++++++++++++  ++"/>
+			</seg>
+			<seg start="676">
+				<data>
+TGCCTCATATATAACTTGTTAACTGAAGGTTACACAAGACCACATCACCACTGTCGTGCTTTTCTAATAACCGCT
+				</data>
+				<hit pos="710" gap="130" motif="motif_2" pvalue="1.7e-10" strand="forward" match="++++ ++++++++++++++++"/>
+			</seg>
+		</sequence>
 		<sequence id="seq_1_7" db="db_1" num="7" name="OPI3" comment="sequence of the region upstream from YJR073C" length="800">
-			<score strand="both" combined_pvalue="2.47e-06" evalue="1.7e-05"/>
-			<seg start="151">
+			<score strand="both" combined_pvalue="3.26e-08" evalue="2.3e-07"/>
+			<seg start="451">
 				<data>
-GTTAATCTGATCAACGCTACGCCGATGACAACGGTCTGTGCCAGATCTGGTTTTCCCCACTTATTTGCTACTTCC
+TGTGTATCGGGGACTTCTCTTAGAGTAGAAGCGTCTATAAACCCAGGTGGGACGACAGTAGTGATGGCGCCGCCG
 				</data>
-				<hit pos="186" gap="185" motif="motif_2" pvalue="7.4e-07" strand="reverse" match="++++++++++"/>
+				<hit pos="504" gap="503" motif="motif_2" pvalue="7.8e-09" strand="reverse" match="++++++++++++++ ++++  "/>
 			</seg>
 			<seg start="526">
 				<data>
 TATAATTCGACTTCCTTGTTGTTCATGCTTCCTTGATGACCAGGGTAGGTGTCAATGAGAGTGCATGTGGAAAGT
 				</data>
-				<hit pos="584" gap="388" motif="motif_1" pvalue="8.1e-08" strand="forward" match="+ + +++++++ +++++"/>
+				<hit pos="584" gap="59" motif="motif_1" pvalue="8.1e-08" strand="forward" match="+ + +++++++ +++++"/>
 			</seg>
 			<seg start="601">
 				<data>
@@ -162,51 +147,51 @@
 				<hit pos="633" gap="32" motif="motif_1" pvalue="5.9e-05" strand="reverse" match="+ ++++++ ++++   +"/>
 			</seg>
 		</sequence>
+		<sequence id="seq_1_5" db="db_1" num="5" name="ACC1" comment="sequence of the region upstream from YNR016C" length="800">
+			<score strand="both" combined_pvalue="6.29e-08" evalue="4.4e-07"/>
+			<seg start="76">
+				<data>
+TAAAATCTTCACATGGCCCGGCCGCGCGCGCGTTGTGCCAACAAGTCGCAGTCGAAATTCAACCGCTCATTGCCA
+CTCTCTCTACTGCTTGGTGAACTAGGCTATACGCTCAATCAGCGCCAAGATATATAAGAAGAACAGCACTCCCAG
+				</data>
+				<hit pos="79" gap="78" motif="motif_1" pvalue="2.7e-08" strand="reverse" match="+ ++++++++++++++ "/>
+				<hit pos="135" gap="39" motif="motif_2" pvalue="4.6e-08" strand="forward" match="+++ +++ +++ +++++++++"/>
+			</seg>
+		</sequence>
 		<sequence id="seq_1_3" db="db_1" num="3" name="FAS1" comment="sequence of the region upstream from YKL182W" length="800">
-			<score strand="both" combined_pvalue="7.44e-06" evalue="5.2e-05"/>
+			<score strand="both" combined_pvalue="1.38e-07" evalue="9.7e-07"/>
 			<seg start="1">
 				<data>
 CCGGGTTATAGCAGCGTCTGCTCCGCATCACGATACACGAGGTGCAGGCACGGTTCACTACTCCCCTGGCCTCCA
 				</data>
-				<hit pos="44" gap="43" motif="motif_2" pvalue="1.4e-05" strand="forward" match=" + +++++ +"/>
+				<hit pos="45" gap="44" motif="motif_2" pvalue="2.0e-07" strand="forward" match="++ ++ +   +++++++++ +"/>
 			</seg>
 			<seg start="76">
 				<data>
 ACAAACGACGGCCAAAAACTTCACATGCCGCCCAGCCAAGCATAATTACGCAACAGCGATCTTTCCGTCGCACAA
 				</data>
-				<hit pos="91" gap="37" motif="motif_1" pvalue="1.4e-08" strand="reverse" match="+  ++++++++++++++"/>
+				<hit pos="91" gap="25" motif="motif_1" pvalue="1.4e-08" strand="reverse" match="+  ++++++++++++++"/>
+			</seg>
+		</sequence>
+		<sequence id="seq_1_1" db="db_1" num="1" name="CHO1" comment="sequence of the region upstream from YER026C" length="800">
+			<score strand="both" combined_pvalue="1.94e-07" evalue="1.4e-06"/>
+			<seg start="601">
+				<data>
+ACTTTGAACGTTCACACGGCACCCTCACGCCTTTGAGCTTTCACATGGACCCATCTAAAGATGAAGATCCGTATT
+				</data>
+				<hit pos="615" gap="614" motif="motif_2" pvalue="1.5e-07" strand="forward" match="++++++ ++ ++++  ++ + "/>
+				<hit pos="636" gap="0" motif="motif_1" pvalue="2.7e-08" strand="reverse" match="++ ++++++++++ +++"/>
 			</seg>
 		</sequence>
 		<sequence id="seq_1_2" db="db_1" num="2" name="CHO2" comment="sequence of the region upstream from YGR157W" length="800">
-			<score strand="both" combined_pvalue="1.02e-05" evalue="7.1e-05"/>
+			<score strand="both" combined_pvalue="2.76e-04" evalue="0.0019"/>
 			<seg start="301">
 				<data>
 ATATATATTTTTGCCTTGGTTTAAATTGGTCAAGACAGTCAATTGCCACACTTTTCTCATGCCGCATTCATTATT
 				</data>
 				<hit pos="350" gap="349" motif="motif_1" pvalue="1.5e-08" strand="reverse" match="+++++++ ++++++++ "/>
 			</seg>
-			<seg start="376">
-				<data>
-CGCGAAGTTTTCCACACAAAACTGTGAAAATGAACGGCGATGCCAGAAACGGCAAAACCTCAAATGTTAGATAAC
-				</data>
-				<hit pos="413" gap="46" motif="motif_2" pvalue="1.8e-05" strand="reverse" match="+  +++++++"/>
-			</seg>
-		</sequence>
-		<sequence id="seq_1_4" db="db_1" num="4" name="FAS2" comment="sequence of the region upstream from YPL231W" length="800">
-			<score strand="both" combined_pvalue="6.66e-05" evalue="0.00047"/>
-			<seg start="151">
-				<data>
-AACAGGGTGTCGGTCATACCGATAAAGCCGTCAAGAGTGCCAGAAAAGCAAGAAAGAACAAGATTAGATGTTGGT
-				</data>
-				<hit pos="185" gap="184" motif="motif_2" pvalue="1.8e-05" strand="reverse" match="  ++++++++"/>
-			</seg>
-			<seg start="526">
-				<data>
-GCTTAGCAAAATCCAACCATTTTTTTTTTATCTCCCGCGTTTTCACATGCTACCTCATTCGCCTCGTAACGTTAC
-				</data>
-				<hit pos="563" gap="368" motif="motif_1" pvalue="1.1e-07" strand="reverse" match=" ++++++++++++  ++"/>
-			</seg>
 		</sequence>
 	</sequences>
-	<runtime cycles="0" seconds="0.000"/>
+	<runtime cycles="20001" seconds="0.020"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.adh.oops
--- a/tests/mast/mast.adh.oops	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.adh.oops	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.oops /home/james/memesvn/gomo2/scripts/../tests/common/adh.s -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.adh.oops /home/james/meme/scripts/../tests/common/adh.s -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="protein"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Fri Apr  9 17:08:53 2010</when>
+		<when>Tue Feb 28 17:27:35 2012</when>
 	</model>
 	<alphabet type="amino-acid" bg_source="preset">
 		<letter symbol="A" bg_value="0.073"/>
@@ -98,13 +98,13 @@
 		<letter symbol="W" bg_value="0.013"/>
 		<letter symbol="Y" bg_value="0.033"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.oops" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.oops" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.adh.oops" name="/home/james/meme/scripts/../tests/meme/meme.adh.oops" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="29" best_f="YSASKFAVRMLTRSMAHEYAPHGIRVNCI"/>
 		<motif id="motif_2" num="2" name="2" width="29" best_f="KVVLITGCSSGIGKATAKHLHKEGAWVVL"/>
 		<correlation motif_a="motif_1" motif_b="motif_2" value="0.30"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="/home/james/memesvn/gomo2/scripts/../tests/common/adh.s" name="/home/james/memesvn/gomo2/scripts/../tests/common/adh.s" last_mod_date="Mon Feb 15 12:10:17 2010" seq_count="33" residue_count="9996" type="amino-acid"/>
+		<database id="db_1" num="1" source="/home/james/meme/scripts/../tests/common/adh.s" name="/home/james/meme/scripts/../tests/common/adh.s" last_mod_date="Wed Nov  9 18:52:42 2011" seq_count="33" residue_count="9996" type="amino-acid"/>
 		<sequence id="seq_1_22" db="db_1" num="22" name="YRTP_BACSU" comment="HYPOTHETICAL 25.3 KD PROTEIN IN RTP 5'REGION (ORF238)" length="238">
 			<score strand="both" combined_pvalue="3.05e-35" evalue="1e-33"/>
 			<seg start="1">
@@ -634,5 +634,5 @@
 			</seg>
 		</sequence>
 	</sequences>
-	<runtime cycles="20000" seconds="0.020"/>
+	<runtime cycles="80005" seconds="0.080"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.adh.oops.mini-drosoph.s
--- a/tests/mast/mast.adh.oops.mini-drosoph.s	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.adh.oops.mini-drosoph.s	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.oops - -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus -df stdin -dna -seqp</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.adh.oops - -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus -df stdin -dna -seqp</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="combine"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Fri Apr  9 17:08:53 2010</when>
+		<when>Tue Feb 28 17:27:36 2012</when>
 	</model>
 	<alphabet type="amino-acid" bg_source="preset">
 		<letter symbol="A" bg_value="0.070"/>
@@ -98,13 +98,13 @@
 		<letter symbol="W" bg_value="0.016"/>
 		<letter symbol="Y" bg_value="0.022"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.oops" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.oops" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.adh.oops" name="/home/james/meme/scripts/../tests/meme/meme.adh.oops" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="29" best_f="YSASKFAVRMLTRSMAHEYAPHGIRVNCI"/>
 		<motif id="motif_2" num="2" name="2" width="29" best_f="KVVLITGCSSGIGKATAKHLHKEGAWVVL"/>
 		<correlation motif_a="motif_1" motif_b="motif_2" value="0.30"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="-" name="stdin" last_mod_date="Fri Apr  9 17:08:53 2010" seq_count="4" residue_count="499297" type="nucleotide"/>
+		<database id="db_1" num="1" source="-" name="stdin" last_mod_date="Tue Feb 28 17:27:35 2012" seq_count="4" residue_count="499297" type="nucleotide"/>
 		<sequence id="seq_1_3" db="db_1" num="3" name="gi|7296683|gb|AE003602.1|AE003602" comment="Drosophila melanogaster genomic scaffold 142000013386043 section 3 of 8, complete sequence" length="297266">
 			<score strand="both" combined_pvalue="1.21e-23" evalue="4.8e-23" frame="b"/>
 			<seg start="101626">
@@ -181,5 +181,5 @@
 			<score strand="both" combined_pvalue="1.19e-01" evalue="0.48" frame="a"/>
 		</sequence>
 	</sequences>
-	<runtime cycles="1250000" seconds="1.250"/>
+	<runtime cycles="1220076" seconds="1.220"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.adh.tcm
--- a/tests/mast/mast.adh.tcm	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.adh.tcm	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.tcm /home/james/memesvn/gomo2/scripts/../tests/common/adh.s -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.adh.tcm /home/james/meme/scripts/../tests/common/adh.s -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="protein"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Fri Apr  9 17:08:55 2010</when>
+		<when>Tue Feb 28 17:27:38 2012</when>
 	</model>
 	<alphabet type="amino-acid" bg_source="preset">
 		<letter symbol="A" bg_value="0.073"/>
@@ -98,13 +98,13 @@
 		<letter symbol="W" bg_value="0.013"/>
 		<letter symbol="Y" bg_value="0.033"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.tcm" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.tcm" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.adh.tcm" name="/home/james/meme/scripts/../tests/meme/meme.adh.tcm" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="21" best_f="LITGCSSGIGKAIAKHFHKEG"/>
 		<motif id="motif_2" num="2" name="2" width="22" best_f="YCASKFAVRGFTRSMAMEYAPY"/>
-		<correlation motif_a="motif_1" motif_b="motif_2" value="0.35"/>
+		<correlation motif_a="motif_1" motif_b="motif_2" value="0.34"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="/home/james/memesvn/gomo2/scripts/../tests/common/adh.s" name="/home/james/memesvn/gomo2/scripts/../tests/common/adh.s" last_mod_date="Mon Feb 15 12:10:17 2010" seq_count="33" residue_count="9996" type="amino-acid"/>
+		<database id="db_1" num="1" source="/home/james/meme/scripts/../tests/common/adh.s" name="/home/james/meme/scripts/../tests/common/adh.s" last_mod_date="Wed Nov  9 18:52:42 2011" seq_count="33" residue_count="9996" type="amino-acid"/>
 		<sequence id="seq_1_22" db="db_1" num="22" name="YRTP_BACSU" comment="HYPOTHETICAL 25.3 KD PROTEIN IN RTP 5'REGION (ORF238)" length="238">
 			<score strand="both" combined_pvalue="1.37e-30" evalue="4.5e-29"/>
 			<seg start="1">
@@ -599,5 +599,5 @@
 			</seg>
 		</sequence>
 	</sequences>
-	<runtime cycles="20000" seconds="0.020"/>
+	<runtime cycles="68004" seconds="0.068"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.adh.tcm.mini-drosoph.s
--- a/tests/mast/mast.adh.tcm.mini-drosoph.s	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.adh.tcm.mini-drosoph.s	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.tcm - -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus -df stdin -dna -seqp</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.adh.tcm - -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus -df stdin -dna -seqp</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="combine"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Fri Apr  9 17:08:56 2010</when>
+		<when>Tue Feb 28 17:27:38 2012</when>
 	</model>
 	<alphabet type="amino-acid" bg_source="preset">
 		<letter symbol="A" bg_value="0.070"/>
@@ -98,13 +98,13 @@
 		<letter symbol="W" bg_value="0.016"/>
 		<letter symbol="Y" bg_value="0.022"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.tcm" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.tcm" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.adh.tcm" name="/home/james/meme/scripts/../tests/meme/meme.adh.tcm" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="21" best_f="LITGCSSGIGKAIAKHFHKEG"/>
 		<motif id="motif_2" num="2" name="2" width="22" best_f="YCASKFAVRGFTRSMAMEYAPY"/>
-		<correlation motif_a="motif_1" motif_b="motif_2" value="0.35"/>
+		<correlation motif_a="motif_1" motif_b="motif_2" value="0.34"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="-" name="stdin" last_mod_date="Fri Apr  9 17:08:55 2010" seq_count="4" residue_count="499297" type="nucleotide"/>
+		<database id="db_1" num="1" source="-" name="stdin" last_mod_date="Tue Feb 28 17:27:38 2012" seq_count="4" residue_count="499297" type="nucleotide"/>
 		<sequence id="seq_1_3" db="db_1" num="3" name="gi|7296683|gb|AE003602.1|AE003602" comment="Drosophila melanogaster genomic scaffold 142000013386043 section 3 of 8, complete sequence" length="297266">
 			<score strand="both" combined_pvalue="1.57e-16" evalue="6.3e-16" frame="b"/>
 			<seg start="101626">
@@ -173,5 +173,5 @@
 			<score strand="both" combined_pvalue="3.71e-01" evalue="1.5" frame="a"/>
 		</sequence>
 	</sequences>
-	<runtime cycles="990000" seconds="0.990"/>
+	<runtime cycles="980061" seconds="0.980"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.adh.zoops
--- a/tests/mast/mast.adh.zoops	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.adh.zoops	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.zoops /home/james/memesvn/gomo2/scripts/../tests/common/adh.s -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.adh.zoops /home/james/meme/scripts/../tests/common/adh.s -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="protein"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Fri Apr  9 17:08:54 2010</when>
+		<when>Tue Feb 28 17:27:36 2012</when>
 	</model>
 	<alphabet type="amino-acid" bg_source="preset">
 		<letter symbol="A" bg_value="0.073"/>
@@ -98,13 +98,13 @@
 		<letter symbol="W" bg_value="0.013"/>
 		<letter symbol="Y" bg_value="0.033"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.zoops" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.zoops" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.adh.zoops" name="/home/james/meme/scripts/../tests/meme/meme.adh.zoops" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="21" best_f="GKVVLITGCSSGIGKATAKHL"/>
 		<motif id="motif_2" num="2" name="2" width="29" best_f="SVYCASKFAVRMLTRSMAMEYAPHGIRVN"/>
 		<correlation motif_a="motif_1" motif_b="motif_2" value="0.30"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="/home/james/memesvn/gomo2/scripts/../tests/common/adh.s" name="/home/james/memesvn/gomo2/scripts/../tests/common/adh.s" last_mod_date="Mon Feb 15 12:10:17 2010" seq_count="33" residue_count="9996" type="amino-acid"/>
+		<database id="db_1" num="1" source="/home/james/meme/scripts/../tests/common/adh.s" name="/home/james/meme/scripts/../tests/common/adh.s" last_mod_date="Wed Nov  9 18:52:42 2011" seq_count="33" residue_count="9996" type="amino-acid"/>
 		<sequence id="seq_1_8" db="db_1" num="8" name="BUDC_KLETE" comment="ACETOIN(DIACETYL) REDUCTASE (EC 1.1.1.5) (ACETOIN DEHYDROGENASE)" length="241">
 			<score strand="both" combined_pvalue="3.95e-34" evalue="1.3e-32"/>
 			<seg start="1">
@@ -604,5 +604,5 @@
 			</seg>
 		</sequence>
 	</sequences>
-	<runtime cycles="20000" seconds="0.020"/>
+	<runtime cycles="76004" seconds="0.076"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.adh.zoops.mini-drosoph.s
--- a/tests/mast/mast.adh.zoops.mini-drosoph.s	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.adh.zoops.mini-drosoph.s	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.zoops - -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus -df stdin -dna -seqp</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.adh.zoops - -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus -df stdin -dna -seqp</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="combine"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Fri Apr  9 17:08:55 2010</when>
+		<when>Tue Feb 28 17:27:37 2012</when>
 	</model>
 	<alphabet type="amino-acid" bg_source="preset">
 		<letter symbol="A" bg_value="0.070"/>
@@ -98,13 +98,13 @@
 		<letter symbol="W" bg_value="0.016"/>
 		<letter symbol="Y" bg_value="0.022"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.zoops" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.adh.zoops" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.adh.zoops" name="/home/james/meme/scripts/../tests/meme/meme.adh.zoops" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="21" best_f="GKVVLITGCSSGIGKATAKHL"/>
 		<motif id="motif_2" num="2" name="2" width="29" best_f="SVYCASKFAVRMLTRSMAMEYAPHGIRVN"/>
 		<correlation motif_a="motif_1" motif_b="motif_2" value="0.30"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="-" name="stdin" last_mod_date="Fri Apr  9 17:08:54 2010" seq_count="4" residue_count="499297" type="nucleotide"/>
+		<database id="db_1" num="1" source="-" name="stdin" last_mod_date="Tue Feb 28 17:27:37 2012" seq_count="4" residue_count="499297" type="nucleotide"/>
 		<sequence id="seq_1_3" db="db_1" num="3" name="gi|7296683|gb|AE003602.1|AE003602" comment="Drosophila melanogaster genomic scaffold 142000013386043 section 3 of 8, complete sequence" length="297266">
 			<score strand="both" combined_pvalue="2.10e-22" evalue="8.4e-22" frame="b"/>
 			<seg start="101626">
@@ -181,5 +181,5 @@
 			<score strand="both" combined_pvalue="6.97e-01" evalue="2.8" frame="a"/>
 		</sequence>
 	</sequences>
-	<runtime cycles="1090000" seconds="1.090"/>
+	<runtime cycles="1080067" seconds="1.080"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.crp0.oops
--- a/tests/mast/mast.crp0.oops	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.crp0.oops	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.crp0.oops /home/james/memesvn/gomo2/scripts/../tests/common/crp0.s -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.crp0.oops /home/james/meme/scripts/../tests/common/crp0.s -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="combine"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Mon Apr 12 09:38:55 2010</when>
+		<when>Tue Feb 28 17:27:34 2012</when>
 	</model>
 	<alphabet type="nucleotide" bg_source="preset">
 		<letter symbol="A" bg_value="0.274"/>
@@ -82,13 +82,13 @@
 		<letter symbol="G" bg_value="0.225"/>
 		<letter symbol="T" bg_value="0.274"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.crp0.oops" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.crp0.oops" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.crp0.oops" name="/home/james/meme/scripts/../tests/meme/meme.crp0.oops" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="15" best_f="GTGACCCGGTTCACA" best_r="TGTGAACCGGGTCAC"/>
 		<motif id="motif_2" num="2" name="2" width="11" best_f="CGCATAACAAA" best_r="TTTGTTATGCG"/>
-		<correlation motif_a="motif_1" motif_b="motif_2" value="0.34"/>
+		<correlation motif_a="motif_1" motif_b="motif_2" value="0.36"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="/home/james/memesvn/gomo2/scripts/../tests/common/crp0.s" name="/home/james/memesvn/gomo2/scripts/../tests/common/crp0.s" last_mod_date="Mon Feb 15 12:10:17 2010" seq_count="18" residue_count="1890" type="nucleotide"/>
+		<database id="db_1" num="1" source="/home/james/meme/scripts/../tests/common/crp0.s" name="/home/james/meme/scripts/../tests/common/crp0.s" last_mod_date="Wed Nov  9 18:52:42 2011" seq_count="18" residue_count="1890" type="nucleotide"/>
 		<sequence id="seq_1_2" db="db_1" num="2" name="ara" comment="17 55" length="105">
 			<score strand="both" combined_pvalue="1.96e-06" evalue="3.5e-05"/>
 			<seg start="1">
@@ -277,5 +277,5 @@
 			</seg>
 		</sequence>
 	</sequences>
-	<runtime cycles="0" seconds="0.000"/>
+	<runtime cycles="8000" seconds="0.008"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.crp0.tcm
--- a/tests/mast/mast.crp0.tcm	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.crp0.tcm	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.crp0.tcm /home/james/memesvn/gomo2/scripts/../tests/common/crp0.s -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.crp0.tcm /home/james/meme/scripts/../tests/common/crp0.s -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="combine"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Mon Apr 12 09:38:55 2010</when>
+		<when>Tue Feb 28 17:27:34 2012</when>
 	</model>
 	<alphabet type="nucleotide" bg_source="preset">
 		<letter symbol="A" bg_value="0.274"/>
@@ -82,13 +82,13 @@
 		<letter symbol="G" bg_value="0.225"/>
 		<letter symbol="T" bg_value="0.274"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.crp0.tcm" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.crp0.tcm" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.crp0.tcm" name="/home/james/meme/scripts/../tests/meme/meme.crp0.tcm" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="19" best_f="TGTGAGCGACGTCACACTT" best_r="AAGTGTGACGTCGCTCACA"/>
 		<motif id="motif_2" num="2" name="2" width="8" best_f="CGGCGGGG" best_r="CCCCGCCG"/>
 		<correlation motif_a="motif_1" motif_b="motif_2" value="0.31"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="/home/james/memesvn/gomo2/scripts/../tests/common/crp0.s" name="/home/james/memesvn/gomo2/scripts/../tests/common/crp0.s" last_mod_date="Mon Feb 15 12:10:17 2010" seq_count="18" residue_count="1890" type="nucleotide"/>
+		<database id="db_1" num="1" source="/home/james/meme/scripts/../tests/common/crp0.s" name="/home/james/meme/scripts/../tests/common/crp0.s" last_mod_date="Wed Nov  9 18:52:42 2011" seq_count="18" residue_count="1890" type="nucleotide"/>
 		<sequence id="seq_1_8" db="db_1" num="8" name="ilv" comment="39" length="105">
 			<score strand="both" combined_pvalue="2.22e-05" evalue="0.0004"/>
 			<seg start="1">
@@ -264,5 +264,5 @@
 			</seg>
 		</sequence>
 	</sequences>
-	<runtime cycles="10000" seconds="0.010"/>
+	<runtime cycles="16001" seconds="0.016"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.crp0.zoops
--- a/tests/mast/mast.crp0.zoops	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.crp0.zoops	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.crp0.zoops /home/james/memesvn/gomo2/scripts/../tests/common/crp0.s -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.crp0.zoops /home/james/meme/scripts/../tests/common/crp0.s -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="combine"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Mon Apr 12 09:38:55 2010</when>
+		<when>Tue Feb 28 17:27:34 2012</when>
 	</model>
 	<alphabet type="nucleotide" bg_source="preset">
 		<letter symbol="A" bg_value="0.274"/>
@@ -82,13 +82,13 @@
 		<letter symbol="G" bg_value="0.225"/>
 		<letter symbol="T" bg_value="0.274"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.crp0.zoops" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.crp0.zoops" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.crp0.zoops" name="/home/james/meme/scripts/../tests/meme/meme.crp0.zoops" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="18" best_f="AATTGTGACGTCGATCAC" best_r="GTGATCGACGTCACAATT"/>
 		<motif id="motif_2" num="2" name="2" width="8" best_f="CGGCGGGG" best_r="CCCCGCCG"/>
-		<correlation motif_a="motif_1" motif_b="motif_2" value="0.40"/>
+		<correlation motif_a="motif_1" motif_b="motif_2" value="0.41"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="/home/james/memesvn/gomo2/scripts/../tests/common/crp0.s" name="/home/james/memesvn/gomo2/scripts/../tests/common/crp0.s" last_mod_date="Mon Feb 15 12:10:17 2010" seq_count="18" residue_count="1890" type="nucleotide"/>
+		<database id="db_1" num="1" source="/home/james/meme/scripts/../tests/common/crp0.s" name="/home/james/meme/scripts/../tests/common/crp0.s" last_mod_date="Wed Nov  9 18:52:42 2011" seq_count="18" residue_count="1890" type="nucleotide"/>
 		<sequence id="seq_1_8" db="db_1" num="8" name="ilv" comment="39" length="105">
 			<score strand="both" combined_pvalue="6.47e-06" evalue="0.00012"/>
 			<seg start="1">
@@ -260,5 +260,5 @@
 			</seg>
 		</sequence>
 	</sequences>
-	<runtime cycles="0" seconds="0.000"/>
+	<runtime cycles="12000" seconds="0.012"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.farntrans5.oops
--- a/tests/mast/mast.farntrans5.oops	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.farntrans5.oops	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.farntrans5.oops /home/james/memesvn/gomo2/scripts/../tests/common/farntrans5.s -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.farntrans5.oops /home/james/meme/scripts/../tests/common/farntrans5.s -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="protein"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Fri Apr  9 17:08:52 2010</when>
+		<when>Tue Feb 28 17:27:34 2012</when>
 	</model>
 	<alphabet type="amino-acid" bg_source="preset">
 		<letter symbol="A" bg_value="0.073"/>
@@ -98,13 +98,13 @@
 		<letter symbol="W" bg_value="0.013"/>
 		<letter symbol="Y" bg_value="0.033"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.farntrans5.oops" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.farntrans5.oops" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.farntrans5.oops" name="/home/james/meme/scripts/../tests/meme/meme.farntrans5.oops" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="32" best_f="QQPEGGFNGRPNKLPDVCYSWWVLGSLPIIGR"/>
 		<motif id="motif_2" num="2" name="2" width="22" best_f="CQDEETGGFSDKPGNMVDFYHT"/>
-		<correlation motif_a="motif_1" motif_b="motif_2" value="0.46"/>
+		<correlation motif_a="motif_1" motif_b="motif_2" value="0.45"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="/home/james/memesvn/gomo2/scripts/../tests/common/farntrans5.s" name="/home/james/memesvn/gomo2/scripts/../tests/common/farntrans5.s" last_mod_date="Mon Feb 15 12:10:17 2010" seq_count="5" residue_count="1900" type="amino-acid"/>
+		<database id="db_1" num="1" source="/home/james/meme/scripts/../tests/common/farntrans5.s" name="/home/james/meme/scripts/../tests/common/farntrans5.s" last_mod_date="Wed Nov  9 18:52:42 2011" seq_count="5" residue_count="1900" type="amino-acid"/>
 		<sequence id="seq_1_4" db="db_1" num="4" name="RATRABGERB" comment="Rat rab geranylgeranyl transferase beta-subunit" length="331">
 			<score strand="both" combined_pvalue="2.97e-49" evalue="1.5e-48"/>
 			<seg start="76">
@@ -178,5 +178,5 @@
 			</seg>
 		</sequence>
 	</sequences>
-	<runtime cycles="20000" seconds="0.020"/>
+	<runtime cycles="76004" seconds="0.076"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.farntrans5.tcm
--- a/tests/mast/mast.farntrans5.tcm	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.farntrans5.tcm	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.farntrans5.tcm /home/james/memesvn/gomo2/scripts/../tests/common/farntrans5.s -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.farntrans5.tcm /home/james/meme/scripts/../tests/common/farntrans5.s -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="protein"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Fri Apr  9 17:08:53 2010</when>
+		<when>Tue Feb 28 17:27:34 2012</when>
 	</model>
 	<alphabet type="amino-acid" bg_source="preset">
 		<letter symbol="A" bg_value="0.073"/>
@@ -98,13 +98,13 @@
 		<letter symbol="W" bg_value="0.013"/>
 		<letter symbol="Y" bg_value="0.033"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.farntrans5.tcm" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.farntrans5.tcm" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.farntrans5.tcm" name="/home/james/meme/scripts/../tests/meme/meme.farntrans5.tcm" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="30" best_f="GGFQGRPNKEVHTCYTYWALAALAILNKLH"/>
 		<motif id="motif_2" num="2" name="2" width="14" best_f="INREKHIQYIKSCQ"/>
 		<correlation motif_a="motif_1" motif_b="motif_2" value="0.27"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="/home/james/memesvn/gomo2/scripts/../tests/common/farntrans5.s" name="/home/james/memesvn/gomo2/scripts/../tests/common/farntrans5.s" last_mod_date="Mon Feb 15 12:10:17 2010" seq_count="5" residue_count="1900" type="amino-acid"/>
+		<database id="db_1" num="1" source="/home/james/meme/scripts/../tests/common/farntrans5.s" name="/home/james/meme/scripts/../tests/common/farntrans5.s" last_mod_date="Wed Nov  9 18:52:42 2011" seq_count="5" residue_count="1900" type="amino-acid"/>
 		<sequence id="seq_1_3" db="db_1" num="3" name="BET2_YEAST" comment="YPT1/SEC4 PROTEINS GERANYLGERANYLTRANSFERASE BETA SUBUNIT (EC 2." length="325">
 			<score strand="both" combined_pvalue="1.66e-26" evalue="8.3e-26"/>
 			<seg start="1">
@@ -224,5 +224,5 @@
 			</seg>
 		</sequence>
 	</sequences>
-	<runtime cycles="10000" seconds="0.010"/>
+	<runtime cycles="56003" seconds="0.056"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.farntrans5.zoops
--- a/tests/mast/mast.farntrans5.zoops	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.farntrans5.zoops	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.farntrans5.zoops /home/james/memesvn/gomo2/scripts/../tests/common/farntrans5.s -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.farntrans5.zoops /home/james/meme/scripts/../tests/common/farntrans5.s -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="protein"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Fri Apr  9 17:08:53 2010</when>
+		<when>Tue Feb 28 17:27:34 2012</when>
 	</model>
 	<alphabet type="amino-acid" bg_source="preset">
 		<letter symbol="A" bg_value="0.073"/>
@@ -98,13 +98,13 @@
 		<letter symbol="W" bg_value="0.013"/>
 		<letter symbol="Y" bg_value="0.033"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.farntrans5.zoops" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.farntrans5.zoops" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.farntrans5.zoops" name="/home/james/meme/scripts/../tests/meme/meme.farntrans5.zoops" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="32" best_f="QQPEGGFNGRPNKLPDVCYSWWVLGSLPIIGR"/>
 		<motif id="motif_2" num="2" name="2" width="50" best_f="GEVDTRFVYCALSVASLLNILTPELVEGAIEFVLRCQNFDGGFGCCPGAE"/>
 		<correlation motif_a="motif_1" motif_b="motif_2" value="0.30"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="/home/james/memesvn/gomo2/scripts/../tests/common/farntrans5.s" name="/home/james/memesvn/gomo2/scripts/../tests/common/farntrans5.s" last_mod_date="Mon Feb 15 12:10:17 2010" seq_count="5" residue_count="1900" type="amino-acid"/>
+		<database id="db_1" num="1" source="/home/james/meme/scripts/../tests/common/farntrans5.s" name="/home/james/meme/scripts/../tests/common/farntrans5.s" last_mod_date="Wed Nov  9 18:52:42 2011" seq_count="5" residue_count="1900" type="amino-acid"/>
 		<sequence id="seq_1_3" db="db_1" num="3" name="BET2_YEAST" comment="YPT1/SEC4 PROTEINS GERANYLGERANYLTRANSFERASE BETA SUBUNIT (EC 2." length="325">
 			<score strand="both" combined_pvalue="4.46e-71" evalue="2.2e-70"/>
 			<seg start="1">
@@ -177,5 +177,5 @@
 			</seg>
 		</sequence>
 	</sequences>
-	<runtime cycles="30000" seconds="0.030"/>
+	<runtime cycles="116007" seconds="0.116"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.lipocalin.oops
--- a/tests/mast/mast.lipocalin.oops	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.lipocalin.oops	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.lipocalin.oops /home/james/memesvn/gomo2/scripts/../tests/common/lipocalin.s -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.lipocalin.oops /home/james/meme/scripts/../tests/common/lipocalin.s -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="protein"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Fri Apr  9 17:08:53 2010</when>
+		<when>Tue Feb 28 17:27:35 2012</when>
 	</model>
 	<alphabet type="amino-acid" bg_source="preset">
 		<letter symbol="A" bg_value="0.073"/>
@@ -98,13 +98,13 @@
 		<letter symbol="W" bg_value="0.013"/>
 		<letter symbol="Y" bg_value="0.033"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.lipocalin.oops" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.lipocalin.oops" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.lipocalin.oops" name="/home/james/meme/scripts/../tests/meme/meme.lipocalin.oops" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="19" best_f="PMRNFDIQKFAGTWHEIAK"/>
 		<motif id="motif_2" num="2" name="2" width="20" best_f="NNVFWILDTDYKNYLIQYMC"/>
-		<correlation motif_a="motif_1" motif_b="motif_2" value="0.24"/>
+		<correlation motif_a="motif_1" motif_b="motif_2" value="0.23"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="/home/james/memesvn/gomo2/scripts/../tests/common/lipocalin.s" name="/home/james/memesvn/gomo2/scripts/../tests/common/lipocalin.s" last_mod_date="Mon Feb 15 12:10:17 2010" seq_count="5" residue_count="903" type="amino-acid"/>
+		<database id="db_1" num="1" source="/home/james/meme/scripts/../tests/common/lipocalin.s" name="/home/james/meme/scripts/../tests/common/lipocalin.s" last_mod_date="Wed Nov  9 18:52:42 2011" seq_count="5" residue_count="903" type="amino-acid"/>
 		<sequence id="seq_1_1" db="db_1" num="1" name="ICYA_MANSE" comment="" length="189">
 			<score strand="both" combined_pvalue="1.02e-31" evalue="5.1e-31"/>
 			<seg start="1">
@@ -181,5 +181,5 @@
 			</seg>
 		</sequence>
 	</sequences>
-	<runtime cycles="10000" seconds="0.010"/>
+	<runtime cycles="56003" seconds="0.056"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.lipocalin.tcm
--- a/tests/mast/mast.lipocalin.tcm	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.lipocalin.tcm	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.lipocalin.tcm /home/james/memesvn/gomo2/scripts/../tests/common/lipocalin.s -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.lipocalin.tcm /home/james/meme/scripts/../tests/common/lipocalin.s -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="protein"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Fri Apr  9 17:08:53 2010</when>
+		<when>Tue Feb 28 17:27:35 2012</when>
 	</model>
 	<alphabet type="amino-acid" bg_source="preset">
 		<letter symbol="A" bg_value="0.073"/>
@@ -98,13 +98,13 @@
 		<letter symbol="W" bg_value="0.013"/>
 		<letter symbol="Y" bg_value="0.033"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.lipocalin.tcm" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.lipocalin.tcm" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.lipocalin.tcm" name="/home/james/meme/scripts/../tests/meme/meme.lipocalin.tcm" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="28" best_f="HDGRCPDVKPVDNFDWSRFAGTWWEIAK"/>
 		<motif id="motif_2" num="2" name="2" width="42" best_f="VFWVLATDNKNYIIGYNCDYDPDKKGHQDHVWILSRSKVLEG"/>
 		<correlation motif_a="motif_1" motif_b="motif_2" value="0.23"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="/home/james/memesvn/gomo2/scripts/../tests/common/lipocalin.s" name="/home/james/memesvn/gomo2/scripts/../tests/common/lipocalin.s" last_mod_date="Mon Feb 15 12:10:17 2010" seq_count="5" residue_count="903" type="amino-acid"/>
+		<database id="db_1" num="1" source="/home/james/meme/scripts/../tests/common/lipocalin.s" name="/home/james/meme/scripts/../tests/common/lipocalin.s" last_mod_date="Wed Nov  9 18:52:42 2011" seq_count="5" residue_count="903" type="amino-acid"/>
 		<sequence id="seq_1_3" db="db_1" num="3" name="BBP_PIEBR" comment="" length="173">
 			<score strand="both" combined_pvalue="1.06e-73" evalue="5.3e-73"/>
 			<seg start="1">
@@ -157,5 +157,5 @@
 			<score strand="both" combined_pvalue="5.98e-02" evalue="0.3"/>
 		</sequence>
 	</sequences>
-	<runtime cycles="20000" seconds="0.020"/>
+	<runtime cycles="92005" seconds="0.092"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/mast/mast.lipocalin.zoops
--- a/tests/mast/mast.lipocalin.zoops	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/mast/mast.lipocalin.zoops	Tue Feb 28 17:57:54 2012 +1000
@@ -62,9 +62,9 @@
 <!ELEMENT runtime EMPTY>
 <!ATTLIST runtime cycles CDATA #REQUIRED seconds CDATA #REQUIRED>
 ]>
-<mast version="4.3.2" release="Fri Apr 09 12:00:00 EST 2009">
+<mast version="4.8.1" release="Tue Feb 28 17:11:35 EST 2012">
 	<model>
-		<command_line>mast /home/james/memesvn/gomo2/scripts/../tests/meme/meme.lipocalin.zoops /home/james/memesvn/gomo2/scripts/../tests/common/lipocalin.s -oc /home/james/memesvn/gomo2/scripts/../tests/results/mast -nohtml -nostatus</command_line>
+		<command_line>mast /home/james/meme/scripts/../tests/meme/meme.lipocalin.zoops /home/james/meme/scripts/../tests/common/lipocalin.s -oc /home/james/meme/scripts/../tests/results/mast -nohtml -nostatus</command_line>
 		<max_correlation>0.60</max_correlation>
 		<remove_correlated value="n"/>
 		<strand_handling value="protein"/>
@@ -74,7 +74,7 @@
 		<max_hit_pvalue>0.0001</max_hit_pvalue>
 		<max_weak_pvalue>0.0001</max_weak_pvalue>
 		<host>tlb-squirrel</host>
-		<when>Fri Apr  9 17:08:53 2010</when>
+		<when>Tue Feb 28 17:27:35 2012</when>
 	</model>
 	<alphabet type="amino-acid" bg_source="preset">
 		<letter symbol="A" bg_value="0.073"/>
@@ -98,13 +98,13 @@
 		<letter symbol="W" bg_value="0.013"/>
 		<letter symbol="Y" bg_value="0.033"/>
 	</alphabet>
-	<motifs source="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.lipocalin.zoops" name="/home/james/memesvn/gomo2/scripts/../tests/meme/meme.lipocalin.zoops" last_mod_date="Mon Feb 15 12:10:16 2010">
+	<motifs source="/home/james/meme/scripts/../tests/meme/meme.lipocalin.zoops" name="/home/james/meme/scripts/../tests/meme/meme.lipocalin.zoops" last_mod_date="Tue Feb 28 17:06:39 2012">
 		<motif id="motif_1" num="1" name="1" width="26" best_f="GACPAVRPMRNFDIQKFAGTWHEIAK"/>
 		<motif id="motif_2" num="2" name="2" width="20" best_f="NNVFWILDTDYKNYLIQYMC"/>
 		<correlation motif_a="motif_1" motif_b="motif_2" value="0.25"/>
 	</motifs>
 	<sequences>
-		<database id="db_1" num="1" source="/home/james/memesvn/gomo2/scripts/../tests/common/lipocalin.s" name="/home/james/memesvn/gomo2/scripts/../tests/common/lipocalin.s" last_mod_date="Mon Feb 15 12:10:17 2010" seq_count="5" residue_count="903" type="amino-acid"/>
+		<database id="db_1" num="1" source="/home/james/meme/scripts/../tests/common/lipocalin.s" name="/home/james/meme/scripts/../tests/common/lipocalin.s" last_mod_date="Wed Nov  9 18:52:42 2011" seq_count="5" residue_count="903" type="amino-acid"/>
 		<sequence id="seq_1_1" db="db_1" num="1" name="ICYA_MANSE" comment="" length="189">
 			<score strand="both" combined_pvalue="3.19e-37" evalue="1.6e-36"/>
 			<seg start="1">
@@ -181,5 +181,5 @@
 			</seg>
 		</sequence>
 	</sequences>
-	<runtime cycles="0" seconds="0.000"/>
+	<runtime cycles="64004" seconds="0.064"/>
 </mast>
diff -r 81f90e1597b4 -r bd2d22b86425 tests/meme/meme.psp_test.zoops
--- a/tests/meme/meme.psp_test.zoops	Wed Feb 22 14:46:22 2012 +1000
+++ b/tests/meme/meme.psp_test.zoops	Tue Feb 28 17:57:54 2012 +1000
@@ -1,7 +1,7 @@
 ********************************************************************************
 MEME - Motif discovery tool
 ********************************************************************************
-MEME version 4.0.0 (Release date: 2008-07-12 05:23:09 +1000 (Sat, 12 Jul 2008))
+MEME version 4.8.1 (Release date: Tue Feb 28 17:11:35 EST 2012)
 
 For further information on how to interpret these results or to get
 a copy of the MEME software please access http://meme.nbcr.net.
@@ -28,7 +28,7 @@
 ********************************************************************************
 TRAINING SET
 ********************************************************************************
-DATAFILE= psp_test.s
+DATAFILE= /home/james/meme/scripts/../tests/common/psp_test.s
 ALPHABET= ACGT
 Sequence name            Weight Length  Sequence name            Weight Length  
 -------------            ------ ------  -------------            ------ ------  
@@ -49,7 +49,7 @@
 This information can also be useful in the event you wish to report a
 problem with the MEME software.
 
-command: meme psp_test.s -psp psp_test.psp -minsites 5 -dna -revcomp -minw 7 -maxw 12 -text 
+command: meme /home/james/meme/scripts/../tests/common/psp_test.s -psp /home/james/meme/scripts/../tests/common/psp_test.psp -minsites 5 -dna -revcomp -minw 7 -maxw 12 -nostatus -text 
 
 model:  mod=         zoops    nmotifs=         1    evt=           inf
 object function=  E-value of product of p-values
@@ -210,7 +210,7 @@
 
 
 
-Time 11.14 secs.
+Time 10.79 secs.
 
 ********************************************************************************
 
@@ -240,7 +240,8 @@
 iYER045C-0                       2.54e-01  835
 iYER072W                         3.01e-02  673_[-1(1.83e-05)]_161
 iYFL005W                         3.33e-03  479_[+1(1.97e-06)]_365
-iYGR035C                         4.66e-02  215_[+1(6.30e-05)]_33_[-1(3.29e-05)]_466
+iYGR035C                         4.66e-02  215_[+1(6.30e-05)]_33_\
+    [-1(3.29e-05)]_466
 --------------------------------------------------------------------------------
 
 ********************************************************************************
@@ -250,6 +251,6 @@
 Stopped because nmotifs = 1 reached.
 ********************************************************************************
 
-CPU: tlb-kamikaze-lt.imb.uq.edu.au
+CPU: tlb-squirrel
 
 ********************************************************************************
# HG changeset patch
# User James Johnson <j.johnson@imb.uq.edu.au>
# Date 1330380661 -36000
# Node ID 10a2fb9e9f44718ea1f1b2cb7ee713dd426db6c0
# Parent  81f90e1597b487144ea82df256c8b1eccd8a3923
Added SpaMo to the tarred folders list.

diff -r 81f90e1597b4 -r 10a2fb9e9f44 scripts/meme-chip.pl.in
--- a/scripts/meme-chip.pl.in	Wed Feb 22 14:46:22 2012 +1000
+++ b/scripts/meme-chip.pl.in	Tue Feb 28 08:11:01 2012 +1000
@@ -343,7 +343,7 @@
       'seqs-discarded', 'seqs-centered_w_bg', 'index.html');
   my @outdirs = ('meme_out', 'meme_tomtom_out', 'meme_mast_out', 
       'meme_ama_out', 'dreme_out', 'dreme_tomtom_out', 'dreme_mast_out', 
-      'dreme_ama_out', 'ame_out', 'centrimo_out');
+      'dreme_ama_out', 'ame_out', 'centrimo_out', 'meme_spamo_out', 'dreme_spamo_out');
   foreach my $dir (@outdirs) {
     push(@outfiles, $dir, $dir . '_stderr.txt');
   }
# HG changeset patch
# User James Johnson <j.johnson@imb.uq.edu.au>
# Date 1330906505 -36000
# Node ID 3666f6ec7cc7073e96815fe1d1a2eca4b99f4018
# Parent  02c88ea9dffad1f224d07b82c33b4d902c8307a6
Fixed nmica2meme so it accepts input with only one motif. Made outer <motifset> tag optional.

diff -r 02c88ea9dffa -r 3666f6ec7cc7 scripts/nmica2meme.pl.in
--- a/scripts/nmica2meme.pl.in	Tue Feb 28 17:59:26 2012 +1000
+++ b/scripts/nmica2meme.pl.in	Mon Mar 05 10:15:05 2012 +1000
@@ -40,6 +40,7 @@
   -h                            print usage message
 
   Read a nestedMICA (BioTiffin/XMS) matrix file and convert to MEME format.
+  Note only DNA motifs are supported.
 
   Reads standard input.
   Writes standard output
@@ -72,42 +73,56 @@
 pod2usage(1) if $help;
 
 # Get the background model.
-my %bg = &read_background_file(1, $bg_file); #DNA background file
+my $is_dna = 1;
+my %bg = &read_background_file($is_dna, $bg_file); #DNA background file
 
 # Read the input file.
-my $xml = new XML::Simple;
-my $data = $xml->XMLin('-');		# read from standard input
+my $xml = new XML::Simple(KeepRoot => 1, ForceArray => ['motif', 'column'], 
+    KeyAttr => {'motif' => 'name', 'weight' => 'symbol'}, 
+    ContentKey => '-content');
+my $data;
+eval {
+  $data = $xml->XMLin('-');		# read from standard input
+};
+if ($@) {
+  pod2usage("Bad file on standard input.");
+}
+#print STDERR Dumper($data);
 
-#print Dumper($data);
+$data = $data->{'motifset'} if (defined($data->{motifset}));
+my $motifs = $data->{motif};
+
 
 my $n = @bases;
 my $num_motifs = 0;
-foreach my $motif_name (sort keys %{$data->{motif}}) {
-  my $weight_matrix = $data->{motif}->{$motif_name}->{weightmatrix};
+my $num_skipped = 0;
+foreach my $motif_name (sort keys %{$motifs}) {
+  my $weight_matrix = $motifs->{$motif_name}->{weightmatrix};
+  if ($weight_matrix->{'alphabet'} ne 'DNA') {
+    print(STDERR "Skipped $motif_name as only DNA motifs are supported.\n");
+    $num_skipped++;
+    next;
+  }
   my $w = $weight_matrix->{columns};
-  my $alt = "";
+  my $cols = $weight_matrix->{column};
   my $matrix = '';
   # loop over columns of motif
-  foreach my $column (@{$weight_matrix->{column}}) {
-   # get the frequencies for this column
-    my %freqs;
-    foreach my $entry (@{$column->{weight}}) {
-      $freqs{$entry->{symbol}} = $entry->{content};
-    }
+  foreach my $col (@{$cols}) {
+    # get the frequencies for this column
+    my $freqs = $col->{weight};
     # create an ascii matrix
-    for (my $i=0; $i<$n; $i++) {
-      my $base = $bases[$i];
-      $matrix .= " " . $freqs{$base}; 
+    for (my $i = 0; $i < scalar(@bases); $i++) {
+      $matrix .= " " . $freqs->{$bases[$i]}; 
     }
     $matrix .= "\n";
   }
   # convert and print ascii matrix
-  my ($motif, $errors) = matrix_to_intern(\%bg, $matrix, 'row', $num_seqs, $pseudo_total, id => $motif_name, alt => $alt, url => '');
+  my ($motif, $errors) = matrix_to_intern(\%bg, $matrix, 'row', $num_seqs, 
+      $pseudo_total, id => $motif_name);
   print intern_to_meme($motif, $print_logodds, 1, !($num_motifs++)) if $motif;
   print(STDERR join("\n", @{$errors}), "\n") if @{$errors};
 }
 
-my $num_skipped = 0;
 
 print(STDERR "Converted $num_motifs motifs.\n");
 print(STDERR "Skipped $num_skipped motifs.\n");
# HG changeset patch
# User James Johnson <j.johnson@imb.uq.edu.au>
# Date 1330908206 -36000
# Node ID 97e881234622e65f9befe38e6140e3b55ee76eb1
# Parent  52d97c9bc3e27fb530ae27a0b0c185857f8a0c32
Fixed bug in Glam2 CGI - was reading value for max aligned columns as the value for initial aligned columns.

diff -r 52d97c9bc3e2 -r 97e881234622 website/cgi-bin/glam2.pl
--- a/website/cgi-bin/glam2.pl	Mon Mar 05 10:17:22 2012 +1000
+++ b/website/cgi-bin/glam2.pl	Mon Mar 05 10:43:26 2012 +1000
@@ -284,7 +284,7 @@
       ') must be &le; to the maximum number of aligned columns (' . 
       $d{MAX_COLS} .').');
   }
-  $d{INITIAL_COLS} = $utils->param_int($q, '-b', 'initial number of aligned columns', 
+  $d{INITIAL_COLS} = $utils->param_int($q, '-w', 'initial number of aligned columns', 
     (defined($d{MIN_COLS}) ? $d{MIN_COLS} : 2), 
     (defined($d{MAX_COLS}) ? $d{MAX_COLS} : 300));
   $d{RUNS} = $utils->param_int($q, '-r', 'number of alignment replicates', 1, 100);
# HG changeset patch
# User James Johnson <j.johnson@imb.uq.edu.au>
# Date 1330991023 -36000
# Node ID 59ed92581a3475cd31fb7ca2e26f42957d983bc4
# Parent  97e881234622e65f9befe38e6140e3b55ee76eb1
Fixed a bug in meme_webservice where psp-gen was getting the wrong keyword for the protein alphabet. It expected prot but was getting protein.

diff -r 97e881234622 -r 59ed92581a34 scripts/meme_webservice.pl.in
--- a/scripts/meme_webservice.pl.in	Mon Mar 05 10:43:26 2012 +1000
+++ b/scripts/meme_webservice.pl.in	Tue Mar 06 09:43:43 2012 +1000
@@ -189,6 +189,7 @@
 
 # Run PSPGen
 if (defined($negfile)) { 
+  my $psp_alph = ($alphabet eq 'protein' ? 'prot' : 'dna');
   # use the minw and maxw settings for MEME for finding the PSP but
   # trim to the allowed range for PSPs
   # the actual width set by the PSP finder is that with the highest
@@ -196,9 +197,9 @@
   # codes (but score any sites containing them as zero)
   my $psp_minw = $minw < $MINPSPW ? $MINPSPW : $minw;
   my $psp_maxw = $maxw > $MAXPSPW ? $MAXPSPW : $maxw;
-  my @pspgen_args = ('-pos', $sequences, '-neg', $negfile, '-alpha', $alphabet, 
+  my @pspgen_args = ('-pos', $sequences, '-neg', $negfile, '-alpha', $psp_alph, 
     '-minw', $psp_minw, '-maxw', $psp_maxw, '-arbitraryOK');
-  push(@pspgen_args, '-maxrange', '-triples') if ($alphabet eq 'prot');
+  push(@pspgen_args, '-maxrange', '-triples') if ($psp_alph eq 'prot');
   run_prog(
     PROG => 'psp-gen', 
     ARGS => \@pspgen_args,
diff -r dd34c00ca339 -r 629ed6e19fbc scripts/metatest.pl.in
--- a/scripts/metatest.pl.in	Wed Feb 08 13:58:31 2012 -0800
+++ b/scripts/metatest.pl.in	Thu Feb 09 09:34:58 2012 +1000
@@ -304,7 +304,9 @@
     print("Updating reference files.\n");
     for (my $i = 0; $i < $comparison_count; $i++) {
       $comparison = @{$comparisons}[$i];
-      copy($comparison->{output}, $comparison->{reference});
+      my $output = $comparison->{output};
+      $output = $stdout_fn if ($output eq '-');
+      copy($output, $comparison->{reference});
     }
   }
 CLEANUP:
diff -r 59ed92581a34 -r b2c55b0470c4 src/alphtype.c
--- a/src/alphtype.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/alphtype.c	Thu Mar 08 16:12:32 2012 +1000
@@ -29,7 +29,7 @@
 #include "macros.h"
 #include "hash_alph.h"
 
-extern int main(
+int main(
   int argc,
   char **argv
 )
diff -r 59ed92581a34 -r b2c55b0470c4 src/background.c
--- a/src/background.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/background.c	Thu Mar 08 16:12:32 2012 +1000
@@ -92,7 +92,7 @@
 
 */
 /***************************************************************************/
-extern double *read_markov_model( 
+double *read_markov_model( 
   char *pfile, 					/* name of probability file */
   double *freq,					/* letter frequencies */
   char *alpha,					/* alphabet expected */
@@ -103,18 +103,20 @@
 {
   int i;					/* index into array */
   double a_p[MAX_BACK_SIZE];			/* tuple-prob array */
-  double *a_cp=NULL; 				/* conditional prob. array */
+  double *a_cp; 				/* conditional prob. array */
   FILE *pfilep;					/* file pointer to file */
-  char *line=NULL;				/* line buffer */
-  char **fields=NULL;				/* fields of line */
+  char *line;				/* line buffer */
+  char **fields;				/* fields of line */
   int nfields;					/* number of fields in line */
-  int line_no=0;				/* line number */
+  int line_no = 0;				/* line number */
   char *tuple;					/* the tuple */
   double p;					/* the probability */
-  int maxw=0;					/* maximum tuple width */
-  int alen=strlen(alpha);			/* length of alphabet */
+  int maxw = 0;					/* maximum tuple width */
+  int alen = strlen(alpha);			/* length of alphabet */
   int ntuples;					/* number of tuples */
-
+  a_cp = NULL;
+  line = NULL;
+  fields = NULL;
   /* check input */
   if (!pfile && !freq) {
     fprintf(stderr, "read_markov_model error: specify pfile or freq\n");
@@ -141,6 +143,8 @@
     if (add_x) a_cp[i] = 1.0;			/* Pr(X) */
     /* average reverse complement probabilities together if requested */
     if (rc) average_rc(add_x, a_cp, 1, "", 0, alpha); 
+    // cleanup before return
+    if (add_x) free(alpha);
     return(a_cp);
   }
 
@@ -211,6 +215,9 @@
   print_prob(a_cp, maxw, "", 0, alpha);
 #endif
 
+  // cleanup before return
+  if (add_x) free(alpha);
+
   return(a_cp);					/* return conditionals */
 } /* read_markov_model */
 
@@ -229,7 +236,7 @@
         Warning this function modifies the seq parameter.
 */
 /***************************************************************************/
-extern double *get_markov_from_sequence(
+double *get_markov_from_sequence(
   char *seq,            // the raw ASCII sequence
   const char *alpha,    // alphabet expected
   BOOLEAN rc,           // average reverse complements if TRUE
@@ -530,7 +537,7 @@
 
 */
 /***************************************************************************/
-extern double log_cum_back(
+double log_cum_back(
   char *seq,					/* the sequence */
   double *a_cp,					/* the conditional probs */
   int order,					/* the order of the model */
@@ -605,7 +612,7 @@
 	Returns the index or -1 if the string contains illegal characters.
 */
 /***************************************************************************/
-extern int s2i(
+int s2i(
   char *string					/* the string to index */
 )
 {
@@ -632,7 +639,7 @@
 	Return -1 if prefix to long or if it contains illegal characters.
 */
 /***************************************************************************/
-extern int p2i(
+int p2i(
   char *string,					/* the string to index */
   int w						// length of prefix
 )
@@ -660,7 +667,7 @@
 	Returns the string.
 */
 /***************************************************************************/
-extern char *i2s(
+char *i2s(
   int index
 )
 {
diff -r 59ed92581a34 -r b2c55b0470c4 src/banner.c
--- a/src/banner.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/banner.c	Thu Mar 08 16:12:32 2012 +1000
@@ -24,7 +24,7 @@
 #include "meme.h"
 #include "projrel.h"
 
-extern void banner(
+void banner(
   char *program, /* name of program */
   FILE *outfile  /* destination for output */
 ) 
diff -r 59ed92581a34 -r b2c55b0470c4 src/branching_search.c
--- a/src/branching_search.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/branching_search.c	Thu Mar 08 16:12:32 2012 +1000
@@ -110,7 +110,7 @@
  *    with the novel seeds
  *
  */
-extern void branching_search (
+void branching_search (
   BRANCH_PARAMS *branch_params, ///< The parameters controlling branching search
   MODEL *model,      ///< The motif model (nascent)
   DATASET *dataset,  ///< The dataset of sequences
diff -r 59ed92581a34 -r b2c55b0470c4 src/calculate_p_y.c
--- a/src/calculate_p_y.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/calculate_p_y.c	Thu Mar 08 16:12:32 2012 +1000
@@ -121,7 +121,7 @@
  * of int pointers, lmotif, so that each pointer points to an array in lmap.
  *
  */
-extern void create_lmotif (
+void create_lmotif (
   char *seed_str,    ///< The seed as a string
   int lmap[MAXALPH][MAXALPH], ///< Matrix representing a seq-to-theta mapping fn
   int *lmotif[MAXSITE], ///< The resulting lmotif - OUT
@@ -160,7 +160,7 @@
  * Memory must be pre-allocated for theta_1.
  *
  */
-extern void init_lmotif (
+void init_lmotif (
   int w,             ///< width of site
   char *res,         ///< Integer encoded letters of subsequence
   int *theta_1[MAXSITE], ///< theta_1
@@ -189,7 +189,7 @@
  * substring search, although this approach has not yet been implemented.
  *
  */
-extern void evaluate_seed_DP (
+void evaluate_seed_DP (
   char *new_seed,    ///< The string representing the new seed object.
   SEED_DIFFS *s_diffs, ///< An object representing the differences between the
                      ///< seed of interest and the "previous" seed.
@@ -300,7 +300,7 @@
  * substring search, although this approach has not yet been implemented.
  *
  */
-extern void next_pY_branching(
+void next_pY_branching(
   int *lmotif_new[MAXSITE], ///< The lmotif corresponding to the new seed.
   SEED_DIFFS *s_diffs, ///< The differences between the new and old seeds.
   DATASET *dataset,  ///< The dataset of sequences. Contains the pY arrays.
diff -r 59ed92581a34 -r b2c55b0470c4 src/discretize.c
--- a/src/discretize.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/discretize.c	Thu Mar 08 16:12:32 2012 +1000
@@ -116,7 +116,7 @@
 	Set the z to 1/0 using list of sites (maxima).
 */
 /***********************************************************************/
-extern void set_z (
+void set_z (
   MODEL *model,					/* the model */
   DATASET *dataset 				/* the dataset */
 )
@@ -243,7 +243,7 @@
 	Returns the optimum number of sites.
 */
 /***********************************************************************/
-extern double discretize(
+double discretize(
   MODEL *model,				/* the model */
   DATASET *dataset			/* the dataset */
 )
diff -r 59ed92581a34 -r b2c55b0470c4 src/display.c
--- a/src/display.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/display.c	Thu Mar 08 16:12:32 2012 +1000
@@ -306,7 +306,7 @@
   Doesn't support negative datasets.
 */
 /**********************************************************************/
-extern void record_results(
+void record_results(
   DATASET *dataset,              /* the dataset IN */
   MODEL *model,                  /* the model IN */
   MOTIF_SUMMARY *motif_summaries /* summaries of final motifs IN */
@@ -354,6 +354,10 @@
       motif_summaries[imotif].pssm[i][j] = logodds(i, j);
     }
   }
+  // destroy logodds matrix
+  for (i = 0; i < w; i++) free(((LOGODDSB**)logodds)[i]);
+  free(logodds);
+
   create_2array(motif_summaries[imotif].psfm, double, w + 1, alength + 1);
   for (i = 0; i < w; i++) {
     for (j = 0; j < alength; j++) {
@@ -372,7 +376,7 @@
   Print the results of EM
 */
 /**********************************************************************/
-extern void print_results(
+void print_results(
   DATASET *dataset,      /* the dataset IN */
   DATASET *neg_dataset,  /* negative examples IN */
   MODEL *model,          /* the model */
@@ -381,6 +385,7 @@
   FILE* outfile          /* file for text output IN */
 )
 {
+  char *regexp;
   int i;
   int max_w = model->max_w;     /* maximum width tried */
   int nstrands = model->invcomp ? 2 : 1;  /* # of strands to use */
@@ -528,6 +533,9 @@
   print_log_odds(
     model->imotif, dataset, w, FALSE, logodds, thresh, model->logev, outfile
   );
+  // destroy logodds matrix
+  for (i = 0; i < w; i++) free(((LOGODDSB**)logodds)[i]);
+  free(logodds);
 
   /* print the observed frequency matrix */
   print_theta(
@@ -552,7 +560,9 @@
     fputc('-', outfile);
   }
   fputc('\n', outfile);
-  fprintf(outfile, "%s\n", get_regexp(model, dataset, 0));
+  regexp = get_regexp(model, dataset, 0);
+  fprintf(outfile, "%s\n", regexp);
+  free(regexp);
   for (i=0; i<PAGEWIDTH; i++) {
     fputc('-', outfile);
   }
@@ -994,7 +1004,7 @@
   Print the probability array.
 */
 /**********************************************************************/
-extern void print_theta(
+void print_theta(
   int imotif,   /* number of motif */
   int format,   /* 1 = floating point
                      2 = integer */
@@ -1070,7 +1080,7 @@
   print_zij
 */
 /**********************************************************************/
-extern void print_zij(
+void print_zij(
   DATASET *dataset,     /* the dataset */
   MODEL *model        /* the model */
 )
@@ -1119,7 +1129,7 @@
   print_wij
 */
 /**********************************************************************/
-extern void print_wij(
+void print_wij(
   DATASET *dataset      /* the dataset */
 )
 {
@@ -1154,7 +1164,7 @@
   written for the remaining letters.
 */
 /**********************************************************************/
-extern char *get_consensus(
+char *get_consensus(
   THETA theta,      /* motif theta */
   int w,      /* width of motif */
   DATASET *dataset,   /* the dataset */
@@ -1241,6 +1251,7 @@
   }
   if (prosite==1) re[pos++] = '.';
   re[pos++] = '\0';
+  free(pcons);
 
   return re;
 } /* get_regexp */
@@ -1299,7 +1310,7 @@
   print_dataset_summary
 */
 /**********************************************************************/
-extern void print_dataset_summary (
+void print_dataset_summary (
   DATASET *dataset, /* the dataset IN */
   FILE *outfile     /* where to print IN */
 )
@@ -1385,7 +1396,7 @@
   Print the command line summary
 */
 /**********************************************************************/
-extern void print_command_summary(
+void print_command_summary(
   MODEL *model,     /* the model IN */
   DATASET *dataset, /* the dataset IN */
   FILE *outfile     /* where to print IN */
@@ -1816,7 +1827,7 @@
   Print the summary of all the motifs.
 */
 /**********************************************************************/
-extern void print_summary(
+void print_summary(
   MODEL *model,     /* the model IN */
   DATASET *dataset, /* the dataset IN */
   LO **los,         /* the LO structures IN */
@@ -1837,7 +1848,7 @@
   Print MEME results in XML format. See DTD embeded in
   meme-dtd.h for description of MEME document.
  **********************************************************************/
-extern void print_meme_file_xml(
+void print_meme_file_xml(
   MODEL *model,                   /* the model IN */
   DATASET *dataset,               /* the dataset IN */
   LO *los[MAXG],                  /* logodds structures for motifs */
@@ -2557,6 +2568,10 @@
   /* print a final line of hyphens */
   for (i=0; i<PAGEWIDTH; i++) fputc('-', outfile); fprintf(outfile, "\n\n");
 
+  // cleanup
+  free(hits);
+  free(pvalues);
+
   myfree(seqlist);
 
 } /* print_site_diagrams */
diff -r 59ed92581a34 -r b2c55b0470c4 src/dpalign.c
--- a/src/dpalign.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/dpalign.c	Thu Mar 08 16:12:32 2012 +1000
@@ -77,7 +77,7 @@
 
 */
 /******************************************************************************/
-extern char *dp_align(
+char *dp_align(
   int alength,					/* length of alphabet */
   int n,					/* length of logodds matrix */
   LOGODDS logodds,				/* logodds matrix */
@@ -246,7 +246,7 @@
 	Returns and an array of sequences.    
 */
 /******************************************************************************/
-extern char **dp_ma_motif_seqs(
+char **dp_ma_motif_seqs(
   int alength,				/* length of sequence alphabet */
   int w,				/* length of motif */
   LOGODDS logodds,			/* motif log-odds matrix */
@@ -368,7 +368,7 @@
 	off, the offset of the starting point of the g-alignment.
 */
 /******************************************************************************/
-extern int g_align(
+int g_align(
   char **ma,				/* the multiple alignment */
   int nseq,				/* number of sequences in alignment 
 					   (including the key sequence) */
@@ -454,7 +454,7 @@
 	Returns an array of null terminated, aligned sequences.
 */
 /******************************************************************************/
-extern char **dp_multi_align(
+char **dp_multi_align(
   P_PROB sites,					/* the sites */
   int nsites,					/* the number of sites */
   int w,					/* width of sites */
diff -r 59ed92581a34 -r b2c55b0470c4 src/em.c
--- a/src/em.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/em.c	Thu Mar 08 16:12:32 2012 +1000
@@ -43,7 +43,7 @@
 
 */
 /**********************************************************************/
-extern void em(
+void em(
   MODEL *model,			/* the model */
   DATASET *dataset 		/* the dataset */
 )
diff -r 59ed92581a34 -r b2c55b0470c4 src/fitevd.c
--- a/src/fitevd.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/fitevd.c	Thu Mar 08 16:12:32 2012 +1000
@@ -201,7 +201,7 @@
   for use in computing the score distribution.
 */
 /**********************************************************************/
-extern SCORE_SET *set_up_score_set(
+SCORE_SET *set_up_score_set(
   PROB_T p_threshold,       // P-value threshold for motif hits.
   PROB_T dp_threshold,      // Score threshold for DP.
   int    max_gap,           // Maximum gap length to allow in matches.
@@ -1440,7 +1440,7 @@
   Returns n, the number of non-outliers.
 */
 /******************************************************************************/
-extern int get_n(
+int get_n(
   SCORE_SET score_set,      /* the set of scores and lens/gcs */
   EVD_SET evd_set       // Distribution.
 ) 
@@ -1491,7 +1491,7 @@
   See fitexp() and ml_evd() for meanings of parameters.
 */
 /******************************************************************************/
-extern EVD_SET fit_score_distribution(
+EVD_SET fit_score_distribution(
   BOOLEAN_T exponential,      // Fit exponential distribution?
   SCORE_SET score_set,        /* the set of scores and lens */
   double H,          /* initial estimate for H */
diff -r 59ed92581a34 -r b2c55b0470c4 src/getsize.c
--- a/src/getsize.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/getsize.c	Thu Mar 08 16:12:32 2012 +1000
@@ -38,7 +38,7 @@
 */
 /**********************************************************************/
 
-extern int main(
+int main(
   int argc,
   char *argv[]
 )
diff -r 59ed92581a34 -r b2c55b0470c4 src/hash_alph.c
--- a/src/hash_alph.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/hash_alph.c	Thu Mar 08 16:12:32 2012 +1000
@@ -50,7 +50,7 @@
 	the BLAST alphabet are hashed to 'X'.
 */
 /**********************************************************************/
-extern int setup_hash_alph(
+int setup_hash_alph(
   char *alphabet			/* the alphabet to set up hashing for */
 )
 {
@@ -116,7 +116,7 @@
 	Convert integer-coded sequence to ascii.
 */
 /**********************************************************************/
-extern void r2seq(
+void r2seq(
   char *seq,
   char *res,
   int len
@@ -145,7 +145,7 @@
 	Updates p.
 */
 /***********************************************************************/
-extern char *get_blast_alphabet(
+char *get_blast_alphabet(
   char *old_alph, 		/* old alphabet IN (but converted to uppercase) */
   int *p[MAXASCII]		/* permutation and substitution matrix OUT */
 )
@@ -226,7 +226,7 @@
 	
 */
 /**********************************************************************/
-extern void setup_hash_dnab2protb()
+void setup_hash_dnab2protb()
 {
   int i, j;
   int i0, i1, i2;		/* index in DNAB alphabet of codon */
@@ -305,7 +305,7 @@
         Convert a DNA sequence in place to its reverse complement.
 */
 /**********************************************************************/
-extern void invcomp_dna(
+void invcomp_dna(
   char *sequence,                       /* DNA sequence */
   long length                            /* length of sequence */
 )
@@ -331,7 +331,7 @@
 
 */
 /**********************************************************************/
-extern int *dhash_it(
+int *dhash_it(
   BOOLEAN xlate_dna,			/* database is DNA and motifs protein */
   int alen,				/* length of alphabet */
   char *sequence,			/* sequence of sample */
diff -r 59ed92581a34 -r b2c55b0470c4 src/hash_table.c
--- a/src/hash_table.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/hash_table.c	Thu Mar 08 16:12:32 2012 +1000
@@ -71,7 +71,7 @@
 	Get the number of entries in the hash table.
 */
 /**********************************************************************/
-extern int get_num_entries(
+int get_num_entries(
   HASH_TABLE ht
 )
 {
diff -r 59ed92581a34 -r b2c55b0470c4 src/heap.c
--- a/src/heap.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/heap.c	Thu Mar 08 16:12:32 2012 +1000
@@ -397,7 +397,7 @@
  * Print the contents of the heap to the specified file.
  *
  */
-extern void print_heap(
+void print_heap(
   FILE *outfile,     ///< The file to print to
   HEAP *heap         ///< The heap being printed
 )
diff -r 59ed92581a34 -r b2c55b0470c4 src/init.c
--- a/src/init.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/init.c	Thu Mar 08 16:12:32 2012 +1000
@@ -131,12 +131,11 @@
         Set up all the stuff for meme.
 */
 /**********************************************************************/
-extern void init_meme(
+void init_meme(
   int argc,                /* number of input arguments */
   char **argv,             /* input arguments */
   MODEL **model_p,         /* the model */
   MODEL **best_model_p,    /* the best model */
-  MODEL **scratch_model_p, /* the best model */
   MODEL **neg_model_p,     /* model of negative examples */
   DATASET **dataset_p,     /* the dataset */
   DATASET **neg_dataset_p, /* dataset of negative examples */
@@ -153,7 +152,7 @@
   P_POINT *p_point;   /* previously learned starting points */
   char *alphabet;   /* alphabet for dataset */
   int alength;      /* length of alphabet */
-  MODEL *model=NULL, *best_model=NULL, *scratch_model=NULL, *neg_model=NULL;
+  MODEL *model=NULL, *best_model=NULL, *neg_model=NULL;
   DATASET *dataset=NULL, *neg_dataset=NULL;
   double evt = BIG;   /* no E-value cutoff */
   BOOLEAN no_print = FALSE;     /* turn off printing if parallel and not main */
@@ -813,7 +812,6 @@
   /* create the model */
   model = create_model(mtype, revcomp, max_w, alength);
   best_model = create_model(mtype, revcomp, max_w, alength);
-  scratch_model = create_model(mtype, revcomp, max_w, alength);
 
   /* create the negative dataset and negative model if negative file given */
   if (negfile) {
@@ -840,15 +838,16 @@
   init_llr_pv_tables(2, max_nsites, alength, dataset->back, dataset->pal);
 
   /* set up scratch models */
+  model->pal = pal; //FIXME jj - this was uninitialised
   model->min_w = min_w;
   model->max_w = max_w;
   model->all_widths = all_widths;
   model->min_nsites = min_nsites;
   model->max_nsites = max_nsites;
   copy_model(model, best_model, alength);
-  copy_model(model, scratch_model, alength);
 
   /* put meme parameters in dataset */
+  dataset->use_llr = 0; // FIXME jj: this wasn't defined
   dataset->priors = priors;
   dataset->p_point = p_point;
   dataset->wg = wg;
@@ -904,7 +903,6 @@
 
   /* set up return values */
   *model_p = model;
-  *scratch_model_p = scratch_model;
   *best_model_p = best_model;
   *neg_model_p = neg_model;
   *dataset_p = dataset;
@@ -1000,7 +998,7 @@
   int alength = (dataset ? dataset->alength : 0);
   double *back = (dataset ? dataset->back : (double *)NULL);
   PRIORS *priors = (PRIORS *) mymalloc(sizeof(PRIORS));
-
+  memset(priors, 0, sizeof(PRIORS));
   priors->ptype = ptype;
 
   /* set up the prior counts */
diff -r 59ed92581a34 -r b2c55b0470c4 src/io.c
--- a/src/io.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/io.c	Thu Mar 08 16:12:32 2012 +1000
@@ -29,7 +29,7 @@
 	Returns a pointer to the line or NULL if at EOF when called.
 */
 /******************************************************************************/
-extern char *getline2(
+char *getline2(
   FILE *stream 				/* input stream */
 ) {
   char *s = NULL;			/* string to return */
diff -r 59ed92581a34 -r b2c55b0470c4 src/justlike.c
--- a/src/justlike.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/justlike.c	Thu Mar 08 16:12:32 2012 +1000
@@ -36,7 +36,7 @@
 
 */
 /**********************************************************************/
-extern double like_e_step(
+double like_e_step(
   MODEL *model,					/* the model */
   DATASET *dataset 				/* the dataset */
 )
diff -r 59ed92581a34 -r b2c55b0470c4 src/likelihood.c
--- a/src/likelihood.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/likelihood.c	Thu Mar 08 16:12:32 2012 +1000
@@ -32,7 +32,7 @@
 /*
   functions
 */
-extern int int_compare(
+int int_compare(
   const void *v1,
   const void *v2
 );
@@ -55,7 +55,7 @@
 	If N==0, returns log p-value.
 */
 /**********************************************************************/
-extern double get_log_sig(
+double get_log_sig(
   double score,					/* score of alignment */
   MOTYPE mtype,					/* type of model */
   int w,					/* width of motif */
@@ -92,7 +92,7 @@
 		model->ic
 */
 /**********************************************************************/
-extern void calc_entropy (
+void calc_entropy (
   MODEL *model,			/* the model */
   DATASET *dataset  		/* the dataset */
 )
@@ -156,7 +156,7 @@
 */
 /**********************************************************************/
  
-extern double log_comb(
+double log_comb(
   int m,
   int n
 ) 
@@ -207,7 +207,7 @@
 	of segments of length w.
 */
 /**********************************************************************/
-extern double get_log_nalign(
+double get_log_nalign(
   MOTYPE mtype,					/* type of model */
   int w,	 				/* width of motif */
   int N,					/* number of occurrences */
@@ -264,7 +264,7 @@
 
 */
 /**********************************************************************/
-extern double log_qfast(
+double log_qfast(
   int n,			/* number of random variables in product */
   double logk			/* product of random variables */
 )
@@ -292,7 +292,7 @@
 	For sorting with qsort in decreasing order.
 */
 /**********************************************************************/
-extern int int_compare(
+int int_compare(
   const void *v1,
   const void *v2
 )
diff -r 59ed92581a34 -r b2c55b0470c4 src/llr.c
--- a/src/llr.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/llr.c	Thu Mar 08 16:12:32 2012 +1000
@@ -93,7 +93,7 @@
 
 */
 /************************************************************************/
-extern void init_llr_pv_tables(
+void init_llr_pv_tables(
   int min,				/* minimum number of sites */
   int max,				/* maximum number of sites */
   int alength,				/* alphabet length */
@@ -490,7 +490,7 @@
 	Returns the p-value.
 */
 /******************************************************************************/
-extern double get_llr_pv(
+double get_llr_pv(
   double llr,				/* log likelihood ratio */
   double n,				/* wgtd number sequences in alignment */
   int w,				/* width of alignment */
@@ -598,7 +598,7 @@
 	Assumes get_llr_pv has already been called.
 */
 /******************************************************************************/
-extern double get_llr_mean(
+double get_llr_mean(
   double n 				/* wgt. number sequences in alignment */
 )
 {
@@ -616,7 +616,7 @@
 	are used to speed the calculation.
 */
 /************************************************************************/
-extern int main(
+int main(
   int argc,
   char** argv
 )
diff -r 59ed92581a34 -r b2c55b0470c4 src/logodds.c
--- a/src/logodds.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/logodds.c	Thu Mar 08 16:12:32 2012 +1000
@@ -52,7 +52,7 @@
 	See (install-path>/bin/make_logodds for format of logodds file.
 */
 /**********************************************************************/
-extern int convert_2_log_odds(
+int convert_2_log_odds(
   BOOLEAN translate_dna,// DNA sequences and protein motifs 
   ARRAYLST_T *meme_io_motifs, // meme-io motifs 
   int meme_io_num_motifs, // meme-io num motifs 
@@ -211,7 +211,7 @@
 	See (install-path>/bin/make_logodds for format of logodds file.
 */
 /**********************************************************************/
-extern int read_log_odds(
+int read_log_odds(
   BOOLEAN translate_dna,/* DNA sequences and protein motifs */
   char *filename,	/* file name (output of make_logodds) */
   char *alphabet,	/* alphabet of log-odds matrices */
@@ -427,7 +427,7 @@
 	and lower-numbered motifs.
 */
 /***********************************************************************/
-extern void motif_corr(
+void motif_corr(
   int nmotifs,			/* number of motifs */
   LO *los[]			/* array of logodds structures */
 )
@@ -511,7 +511,7 @@
 	Create a double-letter logodds matrix for efficiency.
 */
 /**********************************************************************/
-extern void make_double_lo(
+void make_double_lo(
   LO *los[],		/* array of pointers to log-odds matrices */
   int nmotifs 		/* number of log-odds matrices in los */
 )
@@ -568,7 +568,7 @@
 		score_bit = (score/scale) + (w*offset)
 */
 /**********************************************************************/
-extern void scale_lo(
+void scale_lo(
   LO *los[],		/* array of pointers to log-odds matrices */
   int nmotifs,		/* number of log-odds matrices in los */
   int range  		/* set entries in matrices to [0..range] */
@@ -653,7 +653,7 @@
 	Shuffle the columns of each motif.
 */
 /**********************************************************************/
-extern void shuffle_cols(
+void shuffle_cols(
   LO *los[],		/* array of pointers to log-odds matrices */
   int nmotifs 		/* number of log-odds matrices in los */
 )
@@ -710,7 +710,7 @@
  * frequencies. The psfm parameter for storing the output must point to
  * a matrix that has had memory allocated prior to the call to this function.
  */
-extern void convert_to_psfm(
+void convert_to_psfm(
   LO *lo,            ///< Matrix of residue log-odds
   double *back,      ///< Background frequencies for determining freqs from los
   double psfm[MAXSITE][MAXALPH]  ///< Matrix in which to store the position
diff -r 59ed92581a34 -r b2c55b0470c4 src/logs.c
--- a/src/logs.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/logs.c	Thu Mar 08 16:12:32 2012 +1000
@@ -32,7 +32,7 @@
 	Setup lookup table for log(x), 0 < x <= 2
 */
 /**********************************************************************/
-extern void init_log(void)
+void init_log(void)
 {
   int i;
   double x;
@@ -51,7 +51,7 @@
 	Setup lookup table for exp(x), -BITS <= x < 0 
 */
 /**********************************************************************/
-extern void init_exp(void)
+void init_exp(void)
 {
   int i;
   double x;
diff -r 59ed92581a34 -r b2c55b0470c4 src/mast-util.c
--- a/src/mast-util.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/mast-util.c	Thu Mar 08 16:12:32 2012 +1000
@@ -109,7 +109,7 @@
         Returns *scores[] : scores[i][j].ic = score on - strand
 */
 /**********************************************************************/
-extern SCORE **score_sequence(
+SCORE **score_sequence(
   STYPE stype,          /* how to treat different strands of DNA */
   BOOLEAN neg_strand,   /* the strand to score */
   BOOLEAN xlate_dna,    /* database is DNA and motifs protein */
@@ -316,7 +316,7 @@
                 weak            otherwise.
 */
 /**********************************************************************/
-extern char *create_diagram(
+char *create_diagram(
   BOOLEAN dna,                          /* database is DNA */
   STYPE stype,                          /* treatment of strands of DNA */
   BOOLEAN xlate_dna,                    /* database is DNA and motifs protein */
@@ -397,7 +397,7 @@
         Print the motif block diagram.
 */
 /**********************************************************************/
-extern void print_diagram(
+void print_diagram(
   char *dia,                            /* motif diagram string */
   char *hdr,                            /* prefix for each line of diagram */
   FILE *file                            /* destination file */
@@ -567,7 +567,7 @@
                         (p)     p-value (optional)      
 */
 /**********************************************************************/
-extern void make_block(
+void make_block(
   int m,                        /* motif number */
   char *strand,                 /* strand */
   int f,                        /* frame number; f=0 not translating DNA */
@@ -612,7 +612,7 @@
         Caller is responsible for deallocating contents of TILING.
 */
 /**********************************************************************/
-extern TILING score_tile_diagram(
+TILING score_tile_diagram(
   FILE *mast_out,                       /* output */
   char *sequence,                       /* sequence to score and tile */
   long length,                          /* length of sequence */
@@ -737,7 +737,7 @@
 
 */
 /**********************************************************************/
-extern double qfast(
+double qfast(
   int n,                        /* number of random variables in product */
   double k                      /* product of random variables */
 )
@@ -780,7 +780,7 @@
         Returns the background frequencies for the BLAST alphabet.
 */
 /**********************************************************************/
-extern double *init_mast_background(
+double *init_mast_background(
   char *bfile,                          /* name of background file */
   const char *alphabet,                 /* motif alphabet */
   STYPE stype,                          /* handling of DNA strands */
@@ -872,10 +872,11 @@
         Free a tiling structure.
 */
 /**********************************************************************/
-extern void free_tiling(
+void free_tiling(
   TILING tiling
 ) 
 {
+    myfree(tiling.hits);
     myfree(tiling.pvalues);
     myfree(tiling.svalues);
     myfree(tiling.diagram);
diff -r 59ed92581a34 -r b2c55b0470c4 src/mast.c
--- a/src/mast.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/mast.c	Thu Mar 08 16:12:32 2012 +1000
@@ -1601,7 +1601,7 @@
   main routine
 */
 /**********************************************************************/
-extern int main (int argc, char *argv[])
+int main (int argc, char *argv[])
 {
   /* declarations */
   /*{{{*/
diff -r 59ed92581a34 -r b2c55b0470c4 src/meme-print-html.c
--- a/src/meme-print-html.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/meme-print-html.c	Thu Mar 08 16:12:32 2012 +1000
@@ -24,7 +24,7 @@
 Print MEME results in HTML format.
 Format XML as HTML using a stylesheet and an XSLT
 **********************************************************************/
-extern void print_meme_file_html(
+void print_meme_file_html(
     char* stylesheet_file_path,   /* path to MEME XSL stylesheet IN */
     char* input_file_path,        /* path to XML input file IN */
     char* output_file_path        /* path to HTML output file IN */
diff -r 59ed92581a34 -r b2c55b0470c4 src/meme.c
--- a/src/meme.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/meme.c	Thu Mar 08 16:12:32 2012 +1000
@@ -119,7 +119,7 @@
 */
 /**********************************************************************/
 
-extern int main(
+int main(
   int argc,
   char *argv[]
 )
@@ -130,7 +130,6 @@
   MODEL *model;			/* the model */
   MODEL *neg_model;		/* the model of negatives */
   MODEL *best_model;		/* the best model found (so far) */
-  MODEL *scratch_model;		/* a scratch model */
   CANDIDATE *candidates = NULL;	/* list of candidate models */
   MOTIF_SUMMARY *motif_summaries = NULL; /* properties of final motifs */
   int n_starts = 0;		/* number of starting points */
@@ -165,9 +164,9 @@
 
   /* initialize everything from the command line */
   char *output_dirname = NULL;
-  BOOLEAN all_widths;
+  //BOOLEAN all_widths;
   init_meme(
-    argc, argv, &model, &best_model, &scratch_model, &neg_model,
+    argc, argv, &model, &best_model, &neg_model,
     &dataset, &neg_dataset, text_filename, &output_dirname, &text_output
   );
   if (model->all_widths)
@@ -385,6 +384,7 @@
     for (sp_idx = 0; sp_idx < n_starts; sp_idx++) {
       free_s_point(&(s_points[sp_idx]));
     }
+    free(s_points);
     
 #ifdef DEBUG_PARALLEL
     fprintf(stderr, "%d: past check time\n", mpMyID()); fflush(stderr);
@@ -522,11 +522,35 @@
 
     // Free arrays in motif_summaries
     for (i = 0; i < imotif; i++) {
-      free_2array(motif_summaries[i].pssm, motif_summaries[i].width);
-      free_2array(motif_summaries[i].psfm, motif_summaries[i].width);
+      // FIXME jj:
+      // it is width + 1 on the call to create_2array in display.c:record_results
+      // I don't think the +1 is used but I've choosen to leave it in case
+      // I've missed something
+      free_2array(motif_summaries[i].pssm, motif_summaries[i].width + 1);
+      free_2array(motif_summaries[i].psfm, motif_summaries[i].width + 1);
+      free(motif_summaries[i].sites);
+      free(motif_summaries[i].regexp);
     }
+    free(motif_summaries);
   } // !no_print
 
+  free_model(model);  
+  free_model(neg_model);
+  free_model(best_model);
+  free(candidates);
+  free_2array(dataset->map, dataset->alength + 1);
+  free_2array(dataset->lomap, dataset->alength + 1);
+  free(dataset->command);
+  for (i = 0; i < dataset->p_point->c; i++) free(dataset->p_point->e_cons0);
+  free(dataset->p_point);
+  free_PriorLib(dataset->priors->plib);
+  free(dataset->priors);
+  free(dataset->back);
+  free(dataset->branch_params);
+  free(dataset->res_freq);
+  free(dataset->samples);
+  free(dataset);
+
 #ifdef PARALLEL
 #ifdef DEBUG_PARALLEL
   fprintf(stderr, "%d: At mpFinalize\n", mpMyID()); fflush(stderr);
diff -r 59ed92581a34 -r b2c55b0470c4 src/meme.h
--- a/src/meme.h	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/meme.h	Thu Mar 08 16:12:32 2012 +1000
@@ -504,12 +504,14 @@
   MODEL *m2,        /* destination */
   int alength       /* length of alphabet */
 );
+void free_model(
+    MODEL *model    /* model */
+);
 extern void init_meme(
   int argc,                /* number of input arguments */
   char **argv,             /* input arguments */
   MODEL **model_p,         /* the model OUT */
   MODEL **best_model_p,    /* the best model OUT */
-  MODEL **scratch_model_p, /* the best model OUT */
   MODEL **neg_model_p,     /* model of negative examples OUT */
   DATASET **dataset_p,     /* the dataset OUT */
   DATASET **neg_dataset_p, /* dataset of negative examples OUT */
diff -r 59ed92581a34 -r b2c55b0470c4 src/meme_util.c
--- a/src/meme_util.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/meme_util.c	Thu Mar 08 16:12:32 2012 +1000
@@ -44,7 +44,7 @@
 
 */
 /**********************************************************************/
-extern void copy_theta(
+void copy_theta(
   THETA s,	 		/* source */
   THETA d,			/* destination */
   int w,			/* width of motif */
@@ -73,7 +73,7 @@
 
 */
 /**********************************************************************/
-extern void get_not_o(
+void get_not_o(
   DATASET *dataset,		// the dataset
   int w				// motif width
 )
@@ -114,7 +114,7 @@
 	Create a model structure.
 */
 /**********************************************************************/
-extern MODEL *create_model(
+MODEL *create_model(
   MOTYPE mtype,				/* type of model */
   BOOLEAN invcomp,			/* use inv comp strand  */
   int max_w,				/* maximum width of motif */
@@ -133,6 +133,7 @@
   create_2array(model->obs, double, max_w+1, alength);
   model->maxima = NULL;
   model->w = 0;
+  model->max_w = max_w;
   model->cons[0] = 0;
   model->cons0[0] = 0;
 
@@ -147,7 +148,7 @@
   Copy a model structure.
 */
 /**********************************************************************/
-extern void copy_model(
+void copy_model(
   MODEL *m1, 				/* source */
   MODEL *m2,				/* destination */
   int alength				/* length of alphabet */
@@ -155,6 +156,7 @@
 {
   int i;
 
+  m2->all_widths = m1->all_widths; // FIXME jj - this was left uncopied
   m2->mtype = m1->mtype;
   m2->min_w = m1->min_w;
   m2->max_w = m1->max_w;
@@ -198,6 +200,23 @@
 
 /**********************************************************************/
 /*
+  free_model
+
+  Free a model structure.
+*/
+/**********************************************************************/
+void free_model(MODEL *model) {
+  if (!model) return;
+  free_2array(model->theta, model->max_w + 1);
+  free_2array(model->logtheta, model->max_w+1);
+  free_2array(model->logtheta_rc, model->max_w+1);
+  free_2array(model->obs, model->max_w+1);
+  free(model->maxima);
+  free(model);
+}
+
+/**********************************************************************/
+/*
 	get_sites
 
 	Get the principal sites contributing to a motif.
@@ -210,7 +229,7 @@
 	Returns a list consisting of sites and sets n, the number of sites.
 */
 /**********************************************************************/
-extern SITE *get_sites(
+SITE *get_sites(
   DATASET *dataset,			/* the dataset */
   MODEL *model,				/* the model */
   int *n,				/* number of sites found */
@@ -318,7 +337,7 @@
 	column.
 */
 /**********************************************************************/
-extern LOGODDS make_log_odds(
+LOGODDS make_log_odds(
   THETA theta1,			/* positive motif theta */
   THETA theta0,			/* negative motif theta; use 0 if NULL */
   double *back,			/* background frequencies; use 0 if NULL */
@@ -377,7 +396,7 @@
  * \return The number of elements in the array of the most probable sites in the
  * dataset
  */
-extern int get_pred_sites (
+int get_pred_sites (
   P_PROB psites,     ///< An array to contain the predicted sites
   MOTYPE mtype,       ///< Model type
   int w,             ///< Length of seed being evaluated
@@ -420,7 +439,7 @@
  *
  * Prints the specified array of sites to the specified file handle.
  */
-extern void print_site_array(
+void print_site_array(
   P_PROB sites,      ///< An array of sites to be printed
   int nsites,        ///< Length of the array
   FILE *outfile,     ///< The stream for output
@@ -452,7 +471,7 @@
  *
  * /return The location of the first site in the sequence, counting from 0
  */
-extern int get_first_siteloc (
+int get_first_siteloc (
   char *descript     ///< The description of the sequence; contains site info
 )
 {
@@ -499,7 +518,7 @@
  * alignment specified by "offset". Each overhanging character by either string
  * is counted as a single difference.
  */ 
-extern int get_n_strdiffs (
+int get_n_strdiffs (
   char *str1,        ///< A string in the aligned pair
   char *str2,        ///< A string in the aligned pair
   int offset         ///< Number of characters str1 is shifted to the right of
@@ -575,7 +594,7 @@
  *  ith value of difference column =
  *  ith value of the first input column - ith value of second input column
  */
-extern void vector_subtract(
+void vector_subtract(
   int *col_a,        ///< Positive column
   int *col_b,        ///< Negative column
   int *diff_col,     ///< Column in which to store the differences
@@ -598,7 +617,7 @@
  *
  * \return the array of integers in the geometric progression
  */
-extern int *make_geometric_prog (
+int *make_geometric_prog (
   int min_val,       ///< Minimum integer value in the geometric progression
   int max_val,       ///< Maximum integer value in the geometric progression
   double factor,     ///< Factor specifying rate of increase in progression
diff -r 59ed92581a34 -r b2c55b0470c4 src/message.c
--- a/src/message.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/message.c	Thu Mar 08 16:12:32 2012 +1000
@@ -505,7 +505,7 @@
 	Get the precalculated astarting and ending sequences and offsets.
 */
 /**********************************************************************/
-extern void get_start_n_end (
+void get_start_n_end (
   int *start_seq,			/* starting sequence number */
   int *start_off,			/* offset in starting sequence */
   int *end_seq,				/* ending sequence number */
@@ -524,7 +524,7 @@
  * Print some of the contents of a model.
  * (Debugging only.)
  **********************************************************************/
-extern void print_model(
+void print_model(
    char *label,
    MODEL *model
 )
diff -r 59ed92581a34 -r b2c55b0470c4 src/motifs.c
--- a/src/motifs.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/motifs.c	Thu Mar 08 16:12:32 2012 +1000
@@ -54,7 +54,7 @@
 #define DATA_HASH_SIZE 100000
 #define RCHUNK 100
 
-extern int read_motifs (
+int read_motifs (
   FILE *fdata,                          /* opened dataset file */
   char *filename,                       /* motif file */
   MOTIF motif[NMOTIFS],                 /* motif info */
diff -r 59ed92581a34 -r b2c55b0470c4 src/mp.c
--- a/src/mp.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/mp.c	Thu Mar 08 16:12:32 2012 +1000
@@ -27,7 +27,7 @@
 	Wrapper on MPI_Init
 */
 /***********************************************************************/
-extern void mpInit(
+void mpInit(
   int *argc,
   char **argv[]
 )
@@ -60,7 +60,7 @@
 	Wrapper on MPI_Finalize
 */
 /***********************************************************************/
-extern void mpFinalize()
+void mpFinalize()
 {
   MPI_Finalize();
 }
diff -r 59ed92581a34 -r b2c55b0470c4 src/oops.c
--- a/src/oops.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/oops.c	Thu Mar 08 16:12:32 2012 +1000
@@ -315,7 +315,7 @@
 	Create a reverse-complement version, too.
 */
 /**********************************************************************/
-extern void convert_theta_to_log(
+void convert_theta_to_log(
   MODEL *model,				/* the model */
   DATASET *dataset			/* the dataset */
 )
diff -r 59ed92581a34 -r b2c55b0470c4 src/partition.c
--- a/src/partition.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/partition.c	Thu Mar 08 16:12:32 2012 +1000
@@ -19,7 +19,7 @@
  *
  * \return A pointer to the new object.
  */
-extern PARTITION *new_partition(
+PARTITION *new_partition(
   int part_min_w,   ///< Minimum w value in the partition
   int part_max_w,   ///< Maximum w value in the partition
   int central_w,    ///< Central w value of this partition
@@ -49,7 +49,7 @@
  * Print a representation of this partition.
  *
  */
-extern void print_partition (
+void print_partition (
   PARTITION *part,   ///< The partition being printed
   FILE *out          ///< The output destination.
 ) {
diff -r 59ed92581a34 -r b2c55b0470c4 src/prior.c
--- a/src/prior.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/prior.c	Thu Mar 08 16:12:32 2012 +1000
@@ -53,6 +53,35 @@
 }
 
 /* ---------------------------------------------------------------------- */
+void free_PriorLib(PriorLib *plib) 
+/*
+ *    plib    PriorLib struct to deallocate
+ */
+{
+  int i;
+  if (plib == NULL) return;
+  free(plib->Mix);
+  free(plib->B);
+  free(plib->FullUpdate);
+  free(plib->QUpdate);
+  for (i = 0; i < plib->L; i++) {
+    free(plib->Distr[i]);
+    free(plib->StructID[i]);
+    free(plib->Comment[i]);
+  }
+  // set pointers to null
+  memset(plib->Distr, 0, sizeof(Real *) * plib->L);
+  memset(plib->StructID, 0, sizeof(char *) * plib->L);
+  memset(plib->Comment, 0, sizeof(char *) * plib->L);
+  free(plib->Distr);
+  free(plib->StructID);
+  free(plib->Comment);
+  // set pointers to null
+  memset(plib, 0, sizeof(PriorLib));
+  free(plib);
+}
+
+/* ---------------------------------------------------------------------- */
 PriorLib *read_PriorLib(char *plib_name, double desired_beta)
 /*
 	plib_name	name of prior library file
@@ -180,7 +209,7 @@
 }
 
 /* ---------------------------------------------------------------------- */
-extern void mixture_regularizer(
+void mixture_regularizer(
   double *freq, 		/* obs freq */
   PriorLib *Lib,		/* priors */ 
   double *reg			/* pseudo-counts */
diff -r 59ed92581a34 -r b2c55b0470c4 src/psp.c
--- a/src/psp.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/psp.c	Thu Mar 08 16:12:32 2012 +1000
@@ -65,7 +65,7 @@
 
 */
 /**********************************************************************/
-extern void read_psp_file(
+void read_psp_file(
   char *psp_filename,		// PSP file name
   DATASET *dataset,		// the dataset
   BOOLEAN psp_revcomp, 		// PSP file contains both strands
@@ -235,7 +235,7 @@
 
  */
 /**********************************************************************/
-extern void psp_renormalize(
+void psp_renormalize(
   DATASET *dataset,		/* the dataset */
   int new_w,			/* new motif width */
   BOOLEAN revcomp,		/* reverse complement? */
@@ -353,7 +353,7 @@
 	add_psp_to_log_not_o
 */
 /**********************************************************************/
-extern void add_psp_to_log_not_o(
+void add_psp_to_log_not_o(
   DATASET *dataset,		/* the dataset */
   int w,			/* motif width */
   BOOLEAN invcomp,		/* reverse complement? */
diff -r 59ed92581a34 -r b2c55b0470c4 src/pssm-distr.c
--- a/src/pssm-distr.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/pssm-distr.c	Thu Mar 08 16:12:32 2012 +1000
@@ -38,7 +38,7 @@
         for 0 <= x <= range*w.
 */
 /**********************************************************************/
-extern double *calc_pssm_cdf(
+double *calc_pssm_cdf(
   int w,                /* width of PSSM */
   int alen,             /* length of alphabet */
   int range,            /* largest value in PSSM */
diff -r 59ed92581a34 -r b2c55b0470c4 src/read_seq_file.c
--- a/src/read_seq_file.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/read_seq_file.c	Thu Mar 08 16:12:32 2012 +1000
@@ -101,7 +101,7 @@
         Check if sample name is defined in ht_seq_names hash table
 */
 /**********************************************************************/
-extern SAMPLE *get_sample_by_name(
+SAMPLE *get_sample_by_name(
   char *sample_name
 )
 {
@@ -119,7 +119,7 @@
 	setup_hash_alphabet must have been called prior to first call to this.
 */
 /**********************************************************************/
-extern DATASET *read_seq_file(
+DATASET *read_seq_file(
   char *file_name,		/* name of file to open */
   char *alpha,			/* alphabet used in sequences */
   BOOLEAN use_comp,		/* use complementary strands, too */
@@ -236,6 +236,8 @@
       }
       hash_set_entry_value(sample, hash_entry);
     }
+    /* cleanup sequence (create_sample copies it) */
+    myfree(sequence);
     
   } /* sequences */
   if (length < 0) error = TRUE;			/* read_sequence error */
diff -r 59ed92581a34 -r b2c55b0470c4 src/read_sequence.c
--- a/src/read_sequence.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/read_sequence.c	Thu Mar 08 16:12:32 2012 +1000
@@ -25,7 +25,7 @@
         setup_hash_alphabet must have been called prior to first call to this.
 */
 /**********************************************************************/
-extern BOOLEAN read_sequence(
+BOOLEAN read_sequence(
   FILE *data_file,                /* file containing sequences */
   char **sample_name,                /* unique identifier of sequence */
   char **sample_de,                /* descriptor of sequence */
diff -r 59ed92581a34 -r b2c55b0470c4 src/readseq.c
--- a/src/readseq.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/readseq.c	Thu Mar 08 16:12:32 2012 +1000
@@ -714,7 +714,7 @@
 #else
 #define Exit(a)   exit(a)
 
-extern int main( int argc, char *argv[])
+int main( int argc, char *argv[])
 #endif
 {
 boolean   closein = false;
diff -r 59ed92581a34 -r b2c55b0470c4 src/regress.c
--- a/src/regress.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/regress.c	Thu Mar 08 16:12:32 2012 +1000
@@ -17,7 +17,7 @@
 
 	Returns the root mean squared error of the fit.
 */
-extern double regress(
+double regress(
   int n,			/* number of points */
   double *x,			/* x values */
   double *y,			/* y values */
diff -r 59ed92581a34 -r b2c55b0470c4 src/seed.c
--- a/src/seed.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/seed.c	Thu Mar 08 16:12:32 2012 +1000
@@ -317,7 +317,7 @@
  * the length of the seed in the given parameter and returning the integer
  * array.
  */
-extern char *to_e_seed (
+char *to_e_seed (
   char *str_seed,    ///< ASCII representation
   int *seed_len      ///< The length of the resulting e_seed
 )
diff -r 59ed92581a34 -r b2c55b0470c4 src/seed_diffs.c
--- a/src/seed_diffs.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/seed_diffs.c	Thu Mar 08 16:12:32 2012 +1000
@@ -59,7 +59,7 @@
  * \return A SEED_DIFFS object representing the differences between the two
  * seeds under the implicit alignment determined by this function.
  */
-extern SEED_DIFFS *get_seed_diffs (
+SEED_DIFFS *get_seed_diffs (
   char *old_seed,    ///< String representation of the old seed
   char *new_seed,    ///< String representation of the new seed
   int lmap[MAXALPH][MAXALPH] ///< Log freq x letter map (used for generating
@@ -167,7 +167,7 @@
  *
  * "Destructor" method: Free the memory associated with this seed diffs object.
  */
-extern void free_seed_diffs (
+void free_seed_diffs (
   SEED_DIFFS *s_diffs ///< "This" seed_diffs object
 ) {
   // Destroy the diff_columns:
@@ -201,7 +201,7 @@
  *
  * \return The offset
  */
-extern int get_seed_shift(
+int get_seed_shift(
   SEED_DIFFS *diffs  ///< The seed_diffs object
 ) {
   return diffs->old_new_shift;
@@ -219,7 +219,7 @@
  *
  * \return The array of lmotif difference columns
  */
-extern int **get_diff_cols(
+int **get_diff_cols(
   SEED_DIFFS *diffs  ///< The seed_diffs object
 ) {
   return diffs->diff_cols;
@@ -236,7 +236,7 @@
  *
  * \return An array of indices.
  */
-extern int *get_diff_idxs (
+int *get_diff_idxs (
   SEED_DIFFS *diffs  ///< The seed_diffs object
 ) {
   return diffs->diff_idxs;
@@ -250,7 +250,7 @@
  *
  * \return Number of differing characters in the implicit alignment.
  */
-extern int get_n_diffs (
+int get_n_diffs (
   SEED_DIFFS *diffs  ///< The seed_diffs object
 ) {
   return diffs->n_diffs;
@@ -263,7 +263,7 @@
  * Get the lengths of each of the seeds
  *
  */
-extern void get_seed_lengths (
+void get_seed_lengths (
   SEED_DIFFS *diffs, ///< The seed_diffs object
   int *length_old,   ///< The length of the old seed - OUT
   int *length_new    ///< The length of the new seed - OUT
@@ -463,7 +463,7 @@
  *
  * Print a representation of this seed_diffs object to the specified file.
  */
-extern void print_seed_diffs (
+void print_seed_diffs (
   SEED_DIFFS *diffs, ///< Seed diffs object
   FILE *out
 ) {
diff -r 59ed92581a34 -r b2c55b0470c4 src/seq2theta.c
--- a/src/seq2theta.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/seq2theta.c	Thu Mar 08 16:12:32 2012 +1000
@@ -52,7 +52,7 @@
 */
 /**********************************************************************/
 
-extern THETA init_map(
+THETA init_map(
   MAP_TYPE type,		/* type of mapping:
 					Uni	- add n prior
 					Pam	- pam matrix
@@ -235,7 +235,7 @@
  * a vector for mapping an "X" character to a vector of letter probabilities.
  * Those probabilities are uniform across all letters.
  */
-extern void convert_to_lmap (
+void convert_to_lmap (
   THETA map,
   int lmap[MAXALPH][MAXALPH],
   int alength
@@ -270,7 +270,7 @@
 	  there is a row for 'X'.
 */
 /**********************************************************************/
-extern void init_theta(
+void init_theta(
   THETA theta,			/* theta */
   char *start,			/* integer encoded starting sequence */
   int w,			/* width of motif */
@@ -296,7 +296,7 @@
  * Convert the entries in the specified matrix motif model from doubles to INT
  * LOG values.
  */
-extern void convert_to_ltheta (
+void convert_to_ltheta (
   double matrix_ds[MAXSITE][MAXALPH], ///< The input matrix of doubles
   int matrix_il[MAXSITE][MAXALPH], ///< The output matrix of int logs
   int nrows,
diff -r 59ed92581a34 -r b2c55b0470c4 src/sp_matrix.c
--- a/src/sp_matrix.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/sp_matrix.c	Thu Mar 08 16:12:32 2012 +1000
@@ -64,7 +64,7 @@
  * \return An SP_MATRIX object containing the matrix of empty S_POINTS
  * and other information describing the matrix properties.
  */
-extern SP_MATRIX *create_spoint_matrix (
+SP_MATRIX *create_spoint_matrix (
   int *central_ws,   ///< A sorted list of central widths values for the matrix
   int n_ws,          ///< The number of central width values
   int *central_ns,   ///< A sorted list of central nsites values for the matrix
@@ -111,7 +111,7 @@
   return sp_matrix;
 } // create_spoint_matrix
 
-
+int info_cons0_alloc =  0;
 /**      
  * create_spoint_row
  *
@@ -120,7 +120,7 @@
  *
  * \return The newly created row, which can then be added to a matrix.
  */
-extern S_POINT *create_spoint_row (
+S_POINT *create_spoint_row (
   int width,         ///< The width of all s_points in the current row
   int *central_ws,   ///< A sorted list of central widths values for the matrix
   int n_ws,          ///< The number of central width values
@@ -198,6 +198,7 @@
     double factor = dataset->hs_decrease;
     int heap_size = MAX((int)max_hs/(pow(factor, manhattan_dist)), 1);
 
+    info_cons0_alloc++;
     Resize(s_point_row[col_idx].cons0, width+1, char);
     s_point_row[col_idx].cons0[0] = '\0';
     s_point_row[col_idx].seed_heap = create_heap(
@@ -218,7 +219,7 @@
  * free_sp_matrix
  *
  */
-extern void free_sp_matrix (
+void free_sp_matrix (
   SP_MATRIX *sp_mat  ///< The object being destroyed.  
 ) {
   // Free the internal representation of the matrix...
@@ -266,10 +267,16 @@
  * memory leak.
  *
  */
-extern void free_s_point (
+void free_s_point (
   S_POINT *sp        ///< The item being destroyed.
 ) {
   destroy_heap(sp->seed_heap);
+  if (sp->cons0) info_cons0_alloc--;
+  // In an attempt to remove memory leaks I'm going to copy the 
+  // e_cons0 and cons0 every time so I can free it here.
+  free(sp->e_cons0);
+  free(sp->cons0);
+  memset(sp, 0, sizeof(S_POINT));
 } // free_s_point
 
 
@@ -281,7 +288,7 @@
  * if it existed.
  *
  */
-extern void copy_s_point (
+void copy_s_point (
   S_POINT *s_point,  ///< The S_POINT being copied
   S_POINT *sp_copy   ///< The copy of the S_POINT - OUT
 ) {
@@ -317,7 +324,7 @@
  * Print a representation of a specified s_point. This is yet another
  * function that should be a "method" of the s_point class.
  */
-extern void print_s_point (
+void print_s_point (
   S_POINT *s_point,  ///< The object being printed.
   FILE *out          ///< The output destination.
 ) {
@@ -343,7 +350,7 @@
  * Transfer the scores of the best seeds in the S_POINT heaps into the
  * S_POINTs themselves.
  */
-extern void transfer_final_scores (
+void transfer_final_scores (
   SP_MATRIX *sp_matrix ///< This object
 ) {
   // Proceed through the entire matrix, transfering the details for each
@@ -362,7 +369,7 @@
         curr_sp->iseq = -1; // Seed does not correspond to a location in the dataset.
         curr_sp->ioff = -1; // Seed does not correspond to a location in the dataset.
         curr_sp->e_cons0 = get_e_seed(best_seed);
-        curr_sp->cons0 = get_str_seed(best_seed);
+        curr_sp->cons0 = strdup(get_str_seed(best_seed));
       }
 
       /* If the seed heap of the current s_point is empty, then it could
@@ -386,7 +393,7 @@
  * \return The minimum width encompassed by this sp_matrix.
  *
  */
-extern int get_min_width (
+int get_min_width (
   SP_MATRIX *sp_mat  ///< The sp_matrix object.
 ) {
   return sp_mat->central_ws[0];
@@ -399,7 +406,7 @@
  * \return The maximum width of any s_point in the matrix.
  *
  */
-extern int get_max_width (
+int get_max_width (
   SP_MATRIX *sp_mat  ///< The sp_matrix object.
 ) {
   return sp_mat->central_ws[sp_mat->n_ws - 1];
@@ -412,7 +419,7 @@
  * \return An array of the central nsites-values in the matrix.
  *
  */
-extern int *get_central_ws (
+int *get_central_ws (
   SP_MATRIX *sp_mat  ///< The sp_matrix object.
 ) {
   return sp_mat->central_ws;
@@ -425,7 +432,7 @@
  * \return An array of the central nsites values in the matrix.
  *
  */
-extern int *get_central_ns (
+int *get_central_ns (
   SP_MATRIX *sp_mat  ///< The sp_matrix object.
 ) {
   return sp_mat->central_ns;
@@ -438,7 +445,7 @@
  * \return The minimum nsites encompassed by this sp_matrix.
  *
  */
-extern int get_min_nsites (
+int get_min_nsites (
   SP_MATRIX *sp_mat  ///< The sp_matrix object.
 ) {
   return sp_mat->central_ns[0];
@@ -451,7 +458,7 @@
  * \return The maximum nsites of any s_point in the matrix.
  *
  */
-extern int get_max_nsites (
+int get_max_nsites (
   SP_MATRIX *sp_mat  ///< The sp_matrix object.
 ) {
   return sp_mat->central_ns[sp_mat->n_ns - 1];
@@ -465,7 +472,7 @@
  * \return The number of "central" width values in the matrix:
  *
  */
-extern int get_num_central_widths (
+int get_num_central_widths (
   SP_MATRIX *sp_mat  ///< The sp_matrix object.
 ) {
   return sp_mat->n_ws;
@@ -479,7 +486,7 @@
  * \return The number of "central" nsites values in the matrix:
  *
  */
-extern int get_num_central_nsites (
+int get_num_central_nsites (
   SP_MATRIX *sp_mat  ///< The sp_matrix object.
 ) {
   return sp_mat->n_ns;
@@ -494,7 +501,7 @@
  * is equal to the number of rows in the matrix.
  *
  */
-extern int sp_get_num_rows (
+int sp_get_num_rows (
   SP_MATRIX *sp_mat
 ) {
   return (get_max_width(sp_mat) - get_min_width(sp_mat) + 1);
@@ -508,7 +515,7 @@
  * This is equal to the number of columns in the matrix.
  *
  */
-extern int sp_get_num_cols (
+int sp_get_num_cols (
   SP_MATRIX *sp_mat
 ) {
   return (get_max_nsites(sp_mat) - get_min_nsites(sp_mat) + 1);
@@ -522,7 +529,7 @@
  * the matrix itself
  *
  */
-extern S_POINT **get_sp_matrix (
+S_POINT **get_sp_matrix (
   SP_MATRIX *sp_mat
 ) {
   return sp_mat->matrix;
@@ -538,7 +545,7 @@
  * \return An array of all S_POINTS with the specified seed width.
  *
  */
-extern S_POINT *get_sp_arr (
+S_POINT *get_sp_arr (
   SP_MATRIX *sp_mat, ///< The spoint matrix
   int seed_width     ///< The number of the desired row
 ) {
@@ -561,7 +568,7 @@
  * \return A pointer to the apporpriate S_POINT object
  *
  */
-extern S_POINT *get_spoint (
+S_POINT *get_spoint (
   SP_MATRIX *sp_mat, ///< The spoint matrix
   int row_idx,       ///< The row of the desired spoint
   int col_idx        ///< The column of the desired spoint
@@ -578,7 +585,7 @@
  * \return A pointer to the apporpriate S_POINT object
  *
  */
-extern S_POINT *get_s_point (
+S_POINT *get_s_point (
   SP_MATRIX *sp_mat, ///< The s_point matrix
   int width,         ///< The width the desired s_point
   int nsites         ///< The nsites of the desired s_point
@@ -598,7 +605,7 @@
  * possibly different for each S_POINT, and was stored in each of the S_POINTs
  * prior to the calling of this function.
  */
-extern void update_s_point_heaps(
+void update_s_point_heaps(
   S_POINT *s_points, ///< The s_points whose heaps are to be updated.
   char *str_seed,    ///< The ascii representation of the seed being added to
                      ///< each of the S_POINT heaps.
@@ -757,7 +764,7 @@
  * no S_POINT had a score greater than LITTLE
  *
  */
-extern S_POINT *choose_em_starts (
+S_POINT *choose_em_starts (
   SP_MATRIX *sp_matrix, ///< The matrix of S_POINT objects to choose from.
   DATASET *data,     ///< Sequence dataset.
   MODEL *model,      ///< The nascent motif model. Contains parameters needed
@@ -793,6 +800,7 @@
       // chosen s_points:
       int curr_sp_idx = n_spoints - 1;
       copy_s_point(best_sp, &(sp_arr[curr_sp_idx]));
+      info_cons0_alloc++;
     }
   } // part_idx
 
@@ -869,7 +877,7 @@
  * Print a representation of this matrix.
  *
  */
-extern void print_sp_matrix (
+void print_sp_matrix (
   SP_MATRIX *sp_mat, ///< The matrix being printed
   FILE *out          ///< The output destination.
 ) {
@@ -1111,7 +1119,7 @@
  * \return A heap containing the seeds from EVERY s_point heap in the matrix
  */
 
-extern HEAP *create_heap_from_sp_matrix (
+HEAP *create_heap_from_sp_matrix (
   SP_MATRIX *sp_mat    // the matrix of s_points 
 ) {
 
diff -r 59ed92581a34 -r b2c55b0470c4 src/starts.c
--- a/src/starts.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/starts.c	Thu Mar 08 16:12:32 2012 +1000
@@ -79,7 +79,7 @@
  *
  * Returns number of starting points in list.
  */
-extern S_POINT *get_starts(
+S_POINT *get_starts(
   DATASET *dataset,  ///< the dataset
   MODEL *model,      ///< the model
   char *e_cons,      ///< encoded consensus sequence
@@ -127,6 +127,8 @@
 
   // Free memory associated with the sp_matrix, as we no longer need it:
   free_sp_matrix(sp_matrix);
+  free(central_ns);
+  free(central_ws);
 
   return s_points;
 } // get_starts
@@ -156,7 +158,7 @@
 ) {
   assert (max_width >= min_width); // Precondition
 
-  int curr_width;
+  int curr_width, inc_width;
   int *progression = NULL;
   *n_vals = 0;
 
diff -r 59ed92581a34 -r b2c55b0470c4 src/subseq7.c
--- a/src/subseq7.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/subseq7.c	Thu Mar 08 16:12:32 2012 +1000
@@ -102,7 +102,7 @@
         This has not yet been done because "if it ain't broke, don't fix it".
 */
 /**********************************************************************/
-extern void subseq7(
+void subseq7(
   MODEL *model,			// the model
   DATASET *dataset,		/* the dataset */
   int w,			// w to use
@@ -398,7 +398,7 @@
 	For the tcm model, all non-overlapping local maxima are found.
 */
 /**********************************************************************/
-extern int get_max(
+int get_max(
   MOTYPE mtype,		/* the model type */
   DATASET *dataset,	/* the dataset */
   int w,		/* width of sites */ 
@@ -551,7 +551,7 @@
         if the first pY is <, =, > the first pY.
 */
 /**********************************************************************/
-extern int pY_compare(
+int pY_compare(
   const void *v1, 
   const void *v2 
 )
@@ -771,7 +771,7 @@
 	Returns number of values of nsites0 tried.
 */ 
 /**********************************************************************/
-extern int align_top_subsequences(
+int align_top_subsequences(
   MOTYPE mtype,				/* type of model */
   int w,				/* width of motif */
   DATASET *dataset,			/* the dataset */
diff -r 59ed92581a34 -r b2c55b0470c4 src/subst-matrix.c
--- a/src/subst-matrix.c	Tue Mar 06 09:43:43 2012 +1000
+++ b/src/subst-matrix.c	Thu Mar 08 16:12:32 2012 +1000
@@ -156,7 +156,7 @@
 */
 /**********************************************************************/
 
-extern MATRIX_T* gen_pam_matrix(
+MATRIX_T* gen_pam_matrix(
   ALPH_T alph,                  /* alphabet */
   int dist,			/* PAM distance */
   BOOLEAN_T logodds		/* true: generate log-odds matrix 
diff -r 25963a151bde -r 76a9f3473e77 website/cgi-bin/meme.pl
--- a/website/cgi-bin/meme.pl	Fri Mar 23 18:49:52 2012 -0700
+++ b/website/cgi-bin/meme.pl	Mon Mar 26 09:24:50 2012 +1000
@@ -196,7 +196,6 @@
   # optional right fields: bfile, shuffle, dna-only: strand, pal, PSP
 
   my $opt_right .= qq {
-<font style="background-color: yellow">NEW</font>
 Perform <A HREF="../help_psp.html#discriminative"><B>discriminative</B></A>
 motif discovery &ndash; Enter the name of a file containing
 &lsquo;<A HREF="../help_psp.html#negativeset"><B>negative sequences</B>&rsquo;</A>:
diff -r 76a9f3473e77 -r af274e59cb61 etc/centrimo_template.html
--- a/etc/centrimo_template.html	Mon Mar 26 09:24:50 2012 +1000
+++ b/etc/centrimo_template.html	Mon Mar 26 11:35:11 2012 +1000
@@ -22,7 +22,8 @@
       <b>best</b> site of a given motif occuring at a given position in the
       input sequences.  This probability is based only on sequences that
       contain at least one site with score greater than the score threshold 
-      (<script>document.write(data['options']['score'])</script> bits).</p>
+      (<span id="ins_score1"></span> bits).</p>
+      <script>$("ins_score1").innerHTML = data['options']['score'];</script>
       <p>Points (X,Y) on the plot are:<br>
       &nbsp;&nbsp;Y = Pr(best site occurs at position X | sequence contains a site)</p>
       <p><b>Note:</b> The plots are smoothed according to the function 
@@ -142,7 +143,8 @@
     </div>
     <div class="pop_content" id="pop_total_sites">
       <p>The number of sequences containing a match to the motif above the given score threshold
-      (<script>document.write(data['options']['score'])</script> bits).</p>
+      (<span id="ins_score2"></span> bits).</p>
+      <script>$("ins_score2").innerHTML = data['options']['score'];</script>
       <div style="float:right; bottom:0px;">[ 
         <a href="javascript:help_popup()">close</a> ]</div>
     </div>
@@ -155,7 +157,8 @@
     </div>
     <!-- Page starts here -->
     <div id="top" class="pad1">
-      <h1><img src="http://vm2.ucsd.edu:8080/meme/doc/images/centrimo_logo.png" alt="CentriMo" /></h1>
+      <h1><img id="title_img" src="" alt="CentriMo" /></h1>
+      <script>$("title_img").src = site_url + "/doc/images/centrimo_logo.png"</script>
       <p>
         For further information on how to interpret these results or to get a 
         copy of the MEME software please access 
@@ -180,29 +183,40 @@
     </div>
     <!-- alert the user when their browser is not up to the task -->
     <noscript><h1 style="color:red">Javascript is required to view these results!</h1></noscript>
+    <h1 id="html5_warning" style="color:red; display:none;">Your browser does not support canvas!</h1>
     <script>
-      if (!window.HTMLCanvasElement)
-        document.write("<h1 style=\"color:red\">Your browser does not support canvas!</h1>\n");
+      if (!window.HTMLCanvasElement) $("html5_warning").style.display = "block";
     </script>
     <h2 class="mainh pad2">Results</h2>
     <div class="box">
+      <span id="ins_desc"></span>
       <!-- write out the job description -->
       <script>
         if (data['job_description']) {
-          document.write('<h4 id="description">Description</h4>\n');
+          var node = $("ins_desc");
+          while (node.firstChild) node.removeChild(node.firstChild);
+          var header = document.createElement("h4");
+          header.id = "description";
+          header.appendChild(document.createTextNode("Description"));
+          node.appendChild(header);
           var paragraphs = data['job_description'].split("\n\n");
           for (var i = 0; i < paragraphs.length; i++) {
-            document.write('<p>');
-            document.write(paragraphs[i].split("\n").join('<br>'));
-            document.write('</p>\n');
+            var p = document.createElement("p");
+            var lines = paragraphs[i].split("\n");
+            for (var j = 0; j < lines.length; j++) {
+              if (j != 0) p.appendChild(document.createElement('br'));
+              p.appendChild(document.createTextNode(lines[j]));
+            }
+            node.appendChild(p);
           }
         }
       </script>
       <div>
         <div style="float:left; width:70%">
-          <h4 id="graph_sec">Motif Probability Graph (score &ge; 
-            <script>document.write(data['options']['score']);</script> 
-            bits)&nbsp;<div class="help" onclick="help_popup(this, 'pop_prob_graph')"></div></h4>
+          <h4 id="graph_sec">Motif Probability Graph (score &ge; <span 
+              id="ins_score3"></span> bits)&nbsp;<div class="help" 
+              onclick="help_popup(this, 'pop_prob_graph')"></div></h4>
+          <script>$("ins_score3").innerHTML = data['options']['score'];</script>
           <canvas id="graph" width="700" height="400" onclick="move_legend(event)"></canvas>
         </div>
         <div class="graph_options_section">
@@ -237,9 +251,8 @@
             </select>
           </div>
           <div style="margin-top:10px;"> 
-            <script>
-              document.write("<form method='post' action='" + site_url + "/cgi-bin/echo.cgi'>");
-            </script>
+            <form id="eps_form" method="post" action="">
+              <script>$("eps_form").action = site_url + "/cgi-bin/echo.cgi";</script>
               <input type="hidden" name="name" value="centrimo.eps">
               <input type="hidden" name="mime_type" value="application/postscript">
               <input type="hidden" id="eps_content" name="content" value="">
@@ -314,10 +327,11 @@
                 >Database is</label>
               <select id="filter_db" disabled>
                 <script>
+                  var filter_db = $("filter_db");
+                  filter_db.options.length = 0;
                   for (var i = 0; i < data['motif_dbs'].length; i++) {
                     var db = data['motif_dbs'][i];
-                    document.write("<option value=\"" + i + "\">" + 
-                        db['name'] + "</option>\n");
+                    filter_db.add(new Option(db['name'], i));
                   }
                 </script> 
               </select>
@@ -403,40 +417,54 @@
       <table class="inputs">
         <tr><th>Database</th><th>Source</th><th>Sequence Count</th></tr>
         <tr>
-          <script>
-          {
-            var db = data['sequence_db'];
-            document.write("<td>"  + db['name'] + "</td>");
-            document.write("<td>" + db['source'] + "</td>");
-            document.write("<td>" + db['count'] + "</td>");
-          }
-          </script>
+          <td id="ins_seq_name"></td>
+          <td id="ins_seq_source"></td>
+          <td id="ins_seq_count"></td>
         </tr>
       </table>
+      <script>
+      {
+        var db = data['sequence_db'];
+        $("ins_seq_name").innerHTML = db['name'];
+        $("ins_seq_source").innerHTML = db['source'];
+        $("ins_seq_count").innerHTML = db['count'];
+      }
+      </script>
       <h4>Motifs</h4>
-      <table class="inputs">
-        <tr><th>Database</th><th>Source</th><th>Motif Count</th></tr>
-        <script>
-        {
-          var motif_dbs = data['motif_dbs'];
-          for (var i = 0; i < motif_dbs.length; i++) {
-            var db = motif_dbs[i];
-            document.write("<tr>");
-            document.write("<td>"  + db['name'] + "</td>");
-            document.write("<td>" + db['source'] + "</td>");
-            document.write("<td>" + db['count'] + "</td>");
-            document.write("</tr>");
-          }
+      <table id="motif_dbs" class="inputs">
+        <thead>
+          <tr><th>Database</th><th>Source</th><th>Motif Count</th></tr>
+        </thead>
+        <tbody></tbody>
+      </table>
+      <script>
+      {
+        var tbl = $('motif_dbs');
+        var tbody = tbl.tBodies[0];
+        while (tbody.rows.length > 0) {
+          tbody.deleteRow(0);
         }
-        </script>
-      </table>
+        var motif_dbs = data['motif_dbs'];
+        for (var i = 0; i < motif_dbs.length; i++) {
+          var db = motif_dbs[i];
+          var row = tbody.insertRow(tbody.rows.length);
+          add_text_cell(row, db['name']);
+          add_text_cell(row, db['source']);
+          add_text_cell(row, db['count']);
+        }
+      }
+      </script>
     </div>
     <div id="info_sec" class="bar">
       <div class="subsection">
         <a name="version"/>
         <h5>CentriMo version</h5>
-        <script>document.write(data["version"]);</script> 
-        (Release date: <script>document.write(data["release"]);</script>)
+        <span id="ins_version"></span>
+        (Release date: <span id="ins_release"></span>)
+        <script>
+          $("ins_version").innerHTML = data["version"];
+          $("ins_release").innerHTML = data["release"];
+        </script> 
       </div>
       <div class="subsection">
         <a name="reference"/>
diff -r 796d45191383 -r 8768361d0c86 scripts/dreme.py.in
--- a/scripts/dreme.py.in	Mon Mar 26 18:35:16 2012 -0700
+++ b/scripts/dreme.py.in	Mon Apr 02 10:42:16 2012 +1000
@@ -228,7 +228,7 @@
             print >> sys.stderr, ("Failed to create PNG file. "
                     "Have you got ghostscript installed?")
 
-# gets the version of the ghostscript version
+# gets the version of the ghostscript program
 _gs_version = []
 def gs_version():
     global _gs_version
@@ -249,12 +249,12 @@
             _gs_version = [-1]
     return _gs_version
 
-# returns if a version of ghostscript more modern than 9
+# returns if a version of ghostscript more modern than 8.15
 def gs_ok():
     ver = gs_version()
     if ver[0] > 8:
         return True
-    return len(ver) > 1 and ver[1] > 15
+    return ver[0] == 8 and len(ver) > 1 and ver[1] > 15
     
 
 # get array of int zeros (numpy is not standard)
diff -r 912467618292 -r 219a06b1d49a src/background.c
--- a/src/background.c	Fri Apr 06 12:56:01 2012 -0700
+++ b/src/background.c	Tue Apr 10 18:36:42 2012 +1000
@@ -65,7 +65,8 @@
  
 static double *get_cond_prob (
   double *a_p, 					/* tuple->prob array */
-  int n						/* length of array */
+  int n,					/* length of array */
+  BOOLEAN add_x					/* alphabet contains X */
 );
 
 /***************************************************************************/
@@ -105,7 +106,7 @@
   double a_p[MAX_BACK_SIZE];			/* tuple-prob array */
   double *a_cp; 				/* conditional prob. array */
   FILE *pfilep;					/* file pointer to file */
-  char *line;				/* line buffer */
+  char *line;					/* line buffer */
   char **fields;				/* fields of line */
   int nfields;					/* number of fields in line */
   int line_no = 0;				/* line number */
@@ -208,10 +209,15 @@
 
   /* get conditional probabilities */
   for (i=1, ntuples=0; i<=maxw; i++) ntuples+= pow(alen, i);
-  a_cp = get_cond_prob(a_p, ntuples);
+#ifdef DEBUG
+  printf("tuple probs:\n");
+  print_prob(a_p, maxw, "", 0, alpha);
+#endif
+  a_cp = get_cond_prob(a_p, ntuples, add_x);
 
   /* print the probabilities */
 #ifdef DEBUG
+  printf("conditional probs:\n");
   print_prob(a_cp, maxw, "", 0, alpha);
 #endif
 
@@ -299,7 +305,7 @@
   //print_prob(a_p, maxw, "", 0, alpha);
 
   /* get conditional probabilities */
-  double *a_cp = get_cond_prob(a_p, ntuples);
+  double *a_cp = get_cond_prob(a_p, ntuples, FALSE);
 
   //print_prob(a_cp, maxw, "", 0, alpha);
 
@@ -487,10 +493,13 @@
 /***************************************************************************/
 static double *get_cond_prob (
   double *a_p, 					/* tuple->prob array */
-  int n						/* length of array */
+  int n,					/* length of array */
+  BOOLEAN add_x					/* alphabet contains X */
 )
 {
   double *a_cp=NULL;
+  // ignore last letter (X) if present
+  int index_alen_m1 = add_x ? index_alen-1 : index_alen;
 
   Resize(a_cp, n, double);			/* create array */
   
@@ -503,7 +512,8 @@
       // get the total probability of this prefix summed over all suffixes
       if (wa % index_alen == 0) {		
         int j;
-        for (j=0, total_w_prob=0; j<index_alen-1; j++) {	// ignore last letter (X)
+        // ignore last letter (X) if present
+        for (j=0, total_w_prob=0; j<index_alen_m1; j++) {	
           total_w_prob += a_p[wa+j];
         }
       }
diff -r 219a06b1d49a -r 495adf09b40a doc/centrimo.html
--- a/doc/centrimo.html	Tue Apr 10 18:36:42 2012 +1000
+++ b/doc/centrimo.html	Wed Apr 11 13:50:04 2012 +1000
@@ -113,10 +113,10 @@
         <td>Scans with the reverse complement motif.</td>
       </tr>
       <tr>
-        <td>--noflip</td> 
+        <td>--flip</td> 
         <td>&nbsp;</td>   
+        <td>reverse complement matches appear 'reflected' around sequence centers</td>
         <td>do not 'flip' the sequence; use rc of motif instead.</td>
-        <td>reverse complement matches appear 'reflected' around sequence centers</td>
       </tr>
       <tr>
         <th colspan="4">Output filtering</th>
diff -r 219a06b1d49a -r 495adf09b40a etc/centrimo_template.html
--- a/etc/centrimo_template.html	Tue Apr 10 18:36:42 2012 +1000
+++ b/etc/centrimo_template.html	Wed Apr 11 13:50:04 2012 +1000
@@ -264,7 +264,7 @@
       <div>
         <div style="float:left; width:70%">
           <h4 id="data_sec">Centrally Enriched Motifs</h4>
-          <table class="motifs hide_db hide_maxprob hide_tsites" id="motifs">
+          <table class="motifs hide_db hide_maxprob" id="motifs">
             <thead>
             <tr>
               <th class="deselect" onclick="clear_selection()" 
@@ -399,7 +399,7 @@
           </div>
           <div >
             <input type="checkbox" id="show_tsites" value="1" 
-            onclick="toggle_column('hide_tsites')">
+            onclick="toggle_column('hide_tsites')" checked>
             <label for="show_tsites">Show Total Sites</label>
           </div>
           <div >
diff -r 219a06b1d49a -r 495adf09b40a src/centrimo.c
--- a/src/centrimo.c	Tue Apr 10 18:36:42 2012 +1000
+++ b/src/centrimo.c	Wed Apr 11 13:50:04 2012 +1000
@@ -65,8 +65,9 @@
   "     --maxbin <width>         maximum width of the central region (bin) to\n"
   "                               consider; default: use the sequence length\n"
   "     --norc                   do not scan with the reverse complement motif\n"
-  "     --noflip                 do not 'flip' the sequence; use rc of motif instead;\n"
-  "                               default: rc matches appear 'reflected' around center\n"
+  "     --flip                   allow 'fliping' of sequences causing rc matches\n"
+  "                               to appear 'reflected' around center;\n"
+  "                               default: do not flip sequences\n"
   "     --desc <description>     include the description in the output;\n"
   "                               default: no description\n"
   "     --dfile <desc file>      use the file content as the description;\n"
@@ -190,7 +191,7 @@
 ) {
 
   // Define command line options.
-  const int num_options = 12;
+  const int num_options = 13;
   cmdoption const centrimo_options[] = {
     {"bgfile", REQUIRED_VALUE},
     {"o", REQUIRED_VALUE},
@@ -200,6 +201,7 @@
     {"ethresh", REQUIRED_VALUE},
     {"maxbin", REQUIRED_VALUE},
     {"norc", NO_VALUE},
+    {"flip", NO_VALUE},
     {"noflip", NO_VALUE},
     {"desc", REQUIRED_VALUE},
     {"dfile", REQUIRED_VALUE},
@@ -213,7 +215,7 @@
   options->alphabet = DNA_ALPH;
   options->allow_clobber = TRUE;
   options->scan_both_strands = TRUE;
-  options->no_flip = FALSE;
+  options->no_flip = TRUE;
 
   options->description = NULL;
   options->desc_file = NULL;
@@ -276,8 +278,13 @@
     else if (strcmp(option_name, "norc") == 0){
       options->scan_both_strands = FALSE;
     }
-    else if (strcmp(option_name, "noflip") == 0){
-      options->no_flip = TRUE;
+    else if (strcmp(option_name, "flip") == 0) {
+      options->no_flip = FALSE; 
+    }
+    else if (strcmp(option_name, "noflip") == 0) {
+      // this is default now, just leaving this
+      // to avoid error messages with people
+      // running old commands
     }
     else if (strcmp(option_name, "o") == 0){
       // Set output directory with no clobber
diff -r e32e7ace9ff6 -r 649746c87e11 etc/meme-to-html.xsl
--- a/etc/meme-to-html.xsl	Mon Apr 16 18:03:37 2012 -0700
+++ b/etc/meme-to-html.xsl	Tue Apr 17 12:36:30 2012 +1000
@@ -783,7 +783,7 @@
               <xsl:if test="/MEME/model/strands='both'">
                 <td class="strand_side"><xsl:if test="@strand='plus'">+</xsl:if><xsl:if test="@strand='minus'">-</xsl:if></td>
               </xsl:if>
-              <td class="strand_start"><xsl:value-of select="@position"/></td>
+              <td class="strand_start"><xsl:value-of select="@position + 1"/></td>
               <td class="strand_pvalue"><xsl:value-of select="@pvalue"/></td>
               <td class="strand_lflank"><xsl:value-of select="left_flank"/></td>
               <td class="strand_seq">
diff -r 02c88ea9dffa -r a1f63c4bfe3f scripts/prior_utils.pl
--- a/scripts/prior_utils.pl	Tue Feb 28 17:59:26 2012 +1000
+++ b/scripts/prior_utils.pl	Wed Apr 25 22:07:41 2012 +0200
@@ -558,13 +558,20 @@
       $pos_dictionary,  # ref to hash count positive seqs where each w-mer seen
       $neg_dictionary,  # ref to hash count negative seqs where each w-mer seen
       $triples,         # if defined score spaced triples rather than w-mers
-      $alternates       # if defined dictionary of alternatives for given character
+      $alternates,      # if defined dictionary of alternatives for given character
+      $ambigs           # ambiguous characters: count any word containing these once
   ) = @_;
 
     # count the number of times each w-mer occurs first in the positive
     # then in the negative sequences
     &count_all_w_mers($pos_sequences, $revcomp, $width, $pos_dictionary, $triples, $alternates);
+#    print STDERR "pos counts including ambigs: ".Dumper(\$pos_dictionary);
+    &uncount_ambigs  ($pos_dictionary, $ambigs, $revcomp);
+#    print STDERR "pos counts excluding ambigs: ".Dumper(\$pos_dictionary);
     &count_all_w_mers($neg_sequences, $revcomp, $width, $neg_dictionary, $triples, $alternates);
+#    print STDERR "neg counts including ambigs: ".Dumper(\$neg_dictionary);
+    &uncount_ambigs  ($neg_dictionary, $ambigs, $revcomp);
+#    print STDERR "neg counts excluding ambigs: ".Dumper(\$neg_dictionary);
 } # D_prior
 
 
@@ -701,6 +708,45 @@
     return \%prior_values;
 }
 
+
+################################################################################
+# uncount_ambigs
+#
+# find each word that contains letters in the ambigous set and set its count
+# to 1, so it gets the lowest score possible for any word encountered (not strictly
+# true as we should give it the highest possible count in the negative set for that
+# to be literally true).
+# input:  $ambigs: letters in the ambiguous set (string)
+#          $revcomp: undef if reverse complement not required, any other
+#          value otherwise
+# output: $dictionary: reference to hash indexed on w-mer, with entries
+#          each also a hash containing values indexed on "count" (count
+#          of that w-mer) and "last" (index of previous place w-mer seen)
+# NOTE: reverse_complement doesn't correctly reverse ambiguous letters but presence
+# of any one of these should make the count go to 1 so it doesn't matter
+#
+################################################################################
+
+sub uncount_ambigs {
+  my ($dictionary,    # count of sequences where each w-mer seen
+      $ambigs,        # srting of ambiguous characters
+      $revcomp        # if defined fix both strands
+  ) = @_;
+  my $ambigsset = "[".$ambigs."]";
+  foreach my $word (keys %$dictionary) {
+    if ($word =~ /$ambigsset/) {
+      $dictionary->{$word}->{"count"} = 1;
+      if (defined($revcomp)) {
+        my $reverse = &reverse_complement($word);
+        if (exists ($dictionary->{$reverse})) {
+           $dictionary->{$reverse}->{"count"} = 1;
+        }
+      }
+    }
+  }
+}
+
+
 ################################################################################
 #
 #  count_all_w_mers
@@ -1134,6 +1180,7 @@
 
   my $L_wP1 = length($seq) - $width + 1; # L-w+1
   my ($pseudocount_enum, $pseudocount_denom) = (1, 1 + $N_neg/$N_pos);
+  my $ambigsset = "[".$ambigs."]";
   for (my $j = 0; $j < $L_wP1 ; $j++) {
     my $w_mer = substr($seq, $j, $width);
     my @letters = split(//,$w_mer);
@@ -1158,9 +1205,7 @@
         my $k = $width-1;
             for (my $j = $i+1; $j < $width-1; $j++) {
                     my $key = ($j-$i).",".($k-$i).":$letters[$i].$letters[$j].$letters[$k]";
-                    if ($ambigs && $key =~ /$ambigs/) {
-                        $score = 0;
-                    } elsif (exists($pos_dictionary->{$key}) && exists($$score_cache{$key})) {
+                    if (exists($pos_dictionary->{$key}) && exists($$score_cache{$key})) {
                         $score = $$score_cache{$key};
                     } else {
                         my $pos_total =
@@ -1179,14 +1224,10 @@
                 }
         $score = $w_mer_max_score;
     } else {
-        if ($ambigs && $w_mer =~ /$ambigs/) {
-            $score = 0;
-        } else {
-            my $pos_total = (exists($pos_dictionary->{$w_mer})?$pos_dictionary->{$w_mer}{"count"}:0);
-            my $neg_total = (exists($neg_dictionary->{$w_mer})?$neg_dictionary->{$w_mer}{"count"}:0);
-            # add pseudocounts to the pos_total / ($pos_total + $neg_total) score here
-            $score =  ($pos_total + $pseudocount_enum) / ($pos_total + $neg_total + $pseudocount_denom);
-        }
+        my $pos_total = (exists($pos_dictionary->{$w_mer})?$pos_dictionary->{$w_mer}{"count"}:0);
+        my $neg_total = (exists($neg_dictionary->{$w_mer})?$neg_dictionary->{$w_mer}{"count"}:0);
+        # add pseudocounts to the pos_total / ($pos_total + $neg_total) score here
+        $score =  ($pos_total + $pseudocount_enum) / ($pos_total + $neg_total + $pseudocount_denom);
     }
     if (1) { #defined ($scale)
       if ((! defined($$min_score)) || $score < $$min_score) {
diff -r 02c88ea9dffa -r a1f63c4bfe3f scripts/psp-gen.pl.in
--- a/scripts/psp-gen.pl.in	Tue Feb 28 17:59:26 2012 +1000
+++ b/scripts/psp-gen.pl.in	Wed Apr 25 22:07:41 2012 +0200
@@ -2,12 +2,21 @@
 # AUTHOR: Philip Machanick
 # CREATE DATE: 23 July 2009
 
+
+################################################################################
+#
 # Calculate discriminative prior based on Hartemink idea
 # in format for use with MEME
 # options (currently inactive) for other prior formats
-
+# FIXME: only corrected count of ambigous letters for D_prior calculation
+# -- if activating any of the others check this plus in general check they\
+# -- are up to date with the D_priors approach
+#
 # input: positive set (X) and negative set (Y) as FASTA file
 # outout: stdout
+#
+#################################################################################
+
 
 use Scalar::Util qw(looks_like_number);
 use strict;
@@ -70,8 +79,6 @@
                     treated as equivalent in searches; sets
                     may not overlap
                     default: no letters treated as equivalent
-     -arbitraryOK   allow N in DNA or X in protein
-                    default: do not allow N or X
      -revcomp       count reverse complements in computing scores
                     default: only count forward matches
      -scalemin <number>
@@ -121,7 +128,7 @@
 
 my ($pos_filename, $neg_filename);
 my ($priortype, $d_prior, $d_hyper_prior, $hypergeomtric_prior, $hamming_prior,
-   $revcomp, $absolute, $maxrange, $raw, $report, $NorX, $triples, $fixed_start, $equivs);
+   $revcomp, $absolute, $maxrange, $raw, $report, $ambigs, $triples, $fixed_start, $equivs);
 my $verbose; # define to get stats out
 # get input arguments
 my $alpha_choice;
@@ -153,8 +160,6 @@
   } elsif ($_ eq "-equiv") {
     $equivs = shift;
     &print_usage("$usage", 1) unless $equivs;
-  } elsif ($_ eq "-arbitraryOK") {
-    $NorX = "";
   } elsif ($_ eq "-triples") {
     $triples = 1;
   } elsif ($_ eq "-fixedstart") {
@@ -224,13 +229,10 @@
 
 $alpha_choice = "DNA" unless (defined ($alpha_choice));
 my %alternates;
-my $ambigs;
-if (defined ($NorX)) { 
-    $NorX .= $alpha_choice eq "DNA"?"N":"BJZX";
-    $ambigs = '['.$NorX.']';
-} else {
-    $NorX = "";
-}
+$ambigs .= $alpha_choice eq "DNA"?"WSMKRYBDHVN":"BJZX";
+# FIXME: to do this properly will blow up the number of options###############
+# for a word exponentially so easiest if we treat ambigs as if they###########
+# don't count, score them as if they occur once
 # FIXME: ############# NOT IMPLEMENTED YET
 # FIXME: should also do alternates for DNA
 # FIXME: actual matches score 0 for any word or triple containing an ambig
@@ -271,9 +273,9 @@
 # when file is read, if equivalent sets specified, the returned sequences are translated to
 # render all the alternatives as one of the equivalent letters
 # read positive file storing names and FASTA comments and returning total sequence length
-&read_seq_file ($pos_filename, \@pos_sequences, \$L_pos, $ALPHABET.$NorX, \@translations, $verbose);
+&read_seq_file ($pos_filename, \@pos_sequences, \$L_pos, $ALPHABET.$ambigs, \@translations, $verbose);
 # read negative file the same way
-&read_seq_file ($neg_filename, \@neg_sequences, \$L_neg, $ALPHABET.$NorX, \@translations, $verbose);
+&read_seq_file ($neg_filename, \@neg_sequences, \$L_neg, $ALPHABET.$ambigs, \@translations, $verbose);
 
 my $N_pos  = @pos_sequences;
 my $N_neg  = @neg_sequences;
@@ -312,7 +314,7 @@
     my ($min_score, $max_score) = (1, 0);
     if ($d_prior || $d_hyper_prior) {
         &D_prior(\@pos_sequences, \@neg_sequences, $revcomp, $width,
-            \%pos_dictionary, \%neg_dictionary, $triples, \%alternates);
+            \%pos_dictionary, \%neg_dictionary, $triples, \%alternates, $ambigs);
     } elsif ($hypergeomtric_prior) {    # don't normalize for seq length
         &class_prior_norm(\@pos_sequences, \@neg_sequences, $revcomp, $width, undef,
             \%pos_dictionary, \%neg_dictionary);
diff -r a1f63c4bfe3f -r cb74543214b8 doc/psp-gen.xml
--- a/doc/psp-gen.xml	Wed Apr 25 22:07:41 2012 +0200
+++ b/doc/psp-gen.xml	Thu Apr 26 12:49:13 2012 +0200
@@ -136,12 +136,6 @@
 </li>
 
 <li>
-<code>-arbitraryOK</code> &#8211; Allow ambiguous letters (but score any
-sites containing them as zero).<br />
-Default: do not allow ambiguous letters.
-</li>
-
-<li>
 <code>-revcomp</code> &#8211; DNA only: score both strands.<br />
 Default: only score on one strand.
 </li>
@@ -537,7 +531,10 @@
 
 <ul>
 <li>
-Ambiguous letters cause words or triples containing them to be scored as zero.
+Any letters in sequence represening ambiguous bases result in a word
+(<i>w</i>-mer) containing that word (or triple in the case of protein)
+being counted whether in the positive or negative sets as if it
+occurred once.
 </li>
 </ul>
 
diff -r a1f63c4bfe3f -r cb74543214b8 scripts/prior_utils.pl
--- a/scripts/prior_utils.pl	Wed Apr 25 22:07:41 2012 +0200
+++ b/scripts/prior_utils.pl	Thu Apr 26 12:49:13 2012 +0200
@@ -1380,13 +1380,24 @@
 #  reverse_complement
 #
 #  return reverse complement of DNA string: assumes from right alphabet
-#  and all in caps (any other letters reversed without translation).
+#  and all in caps.
+#
+#  IUPAC extended alphabet:
+#    W=A|T, S=C|G, N=all not translated
+#    M=A|C   => T|G=K
+#    K=T|G   => A|C=M
+#    R=A|G   => T|C=Y
+#    Y=C|T   => G|A=R
+#    B=C|G|T => G|C|A=V
+#    D=A|G|T => T|C|A=H
+#    H=A|C|T => T|G|A=D
+#    V=A|C|G => T|G|C=B
 #
 ################################################################################
 
 sub reverse_complement {
   ($_) = @_;
-  tr/ACGT/TGCA/;
+  tr/ACGTMKRYBDHV/TGCAKMYRVHDB/;
   $_ = reverse;
   return $_;
 }
diff -r a1f63c4bfe3f -r cb74543214b8 website/html/help_psp.html
--- a/website/html/help_psp.html	Wed Apr 25 22:07:41 2012 +0200
+++ b/website/html/help_psp.html	Thu Apr 26 12:49:13 2012 +0200
@@ -77,7 +77,7 @@
 		<br><br><br>
 	      If we find any ambiguous letters in a <i>w</i>-mer
 	      (e.g. <code>N</code>, which stands for any base in
-	      DNA), we score that <i>w</i>-mer as zero.
+	      DNA), we count any such <i>w</i>-mer as if it occurs once.
 	      <br><br> 
 	      For protein sequences, instead of requiring an exact
 	      match of a <i>w</i>-wide subsequence, we break the
@@ -91,7 +91,9 @@
 	      peaks in the PSP. Once we have calculated scores, we
 	      scale them to lie between 0.1 and 0.9 inclusive. We
 	      convert the scaled scores to probabilities to complete
-	      the calculation of the PSP.<br>
+	      the calculation of the PSP. As with DNA sequences, we
+	      treat any triple containing an ambiguous symbol as if it
+	      only occurs once.<br>
               <br>More detail follows.<br><hr>
 	      <ul>
 		<li style="list-style: none"><a name= "psp"></a></li>
diff -r 092bd08022c6 -r fa6cce59e767 doc/options.xsl
--- a/doc/options.xsl	Wed May 02 15:06:01 2012 -0700
+++ b/doc/options.xsl	Fri May 04 22:03:45 2012 -0700
@@ -490,17 +490,15 @@
     will determine the effective output filter.
   </xsl:template>
 
-  <xsl:template match="command-option[@name='output-pthresh']">
+ <xsl:template match="command-option[@name='output-pthresh']">
     <code>--output-pthresh <i>&lt;float&gt;</i></code>
     - The p-value threshold for displaying search results.
     If the p-value of a match is greater than this value,
     then the match will not be printed. 
-    By default, a p-value threshold is not used.
-    If any combination of <code>--output-ethresh</code>, 
-    <code>--output-pthresh</code>,
-    or <code>--output-qthresh</code> is given,
-    whichever option occurs last on the command line
-    will determine the effective output filter.
+    If both the <code>--output-pthresh</code> and <code>--output-qthresh</code>
+    options appear on the command line, whichever appears later
+    on the command line will be applied.
+    The default p-value threshold is 1e-4.
   </xsl:template>
 
   <xsl:template match="command-option[@name='output-qthresh']">
@@ -508,12 +506,7 @@
     - The q-value threshold for displaying search results.
     If the q-value of a match is greater than this value,
     then the match will not be printed.
-    By default, a q-value threshold is not used.
-    If any combination of <code>--output-ethresh</code>, 
-    <code>--output-pthresh</code>,
-    or <code>--output-qthresh</code> is given,
-    whichever option occurs last on the command line
-    will determine the effective output filter.
+    By default, no q-value threshold is applied.
   </xsl:template>
 
   <xsl:template match="command-option[@name='p-score']">
diff -r 092bd08022c6 -r fa6cce59e767 src/fimo.c
--- a/src/fimo.c	Wed May 02 15:06:01 2012 -0700
+++ b/src/fimo.c	Fri May 04 22:03:45 2012 -0700
@@ -176,8 +176,8 @@
     "     --norc\n"
     "     --o <output dir> (default=fimo_out)\n"
     "     --oc <output dir> (default=fimo_out)\n"
-    "     --output-pthresh <float> (default 1e-4)\n"
-    "     --output-qthresh <float> (default 1.0)\n"
+    "     --output-pthresh <float> (default = 1e-4)\n"
+    "     --output-qthresh <float> (default = no threshold)\n"
     "     --no-qvalue\n"
     "     --psp <PSP filename> (default none)\n"
     "     --prior-dist <PSP distribution filename> (default none)\n"
diff -r 092bd08022c6 -r b20a9fa4568a src/centrimo.c
--- a/src/centrimo.c	Wed May 02 15:06:01 2012 -0700
+++ b/src/centrimo.c	Tue May 08 16:31:22 2012 +1000
@@ -191,12 +191,13 @@
 ) {
 
   // Define command line options.
-  const int num_options = 13;
+  const int num_options = 14;
   cmdoption const centrimo_options[] = {
     {"bgfile", REQUIRED_VALUE},
     {"o", REQUIRED_VALUE},
     {"oc", REQUIRED_VALUE},
     {"score", REQUIRED_VALUE},
+    {"motif", REQUIRED_VALUE},
     {"motif-pseudo", REQUIRED_VALUE},
     {"ethresh", REQUIRED_VALUE},
     {"maxbin", REQUIRED_VALUE},
diff -r 24619a92bce9 -r 2c18ee5e1d26 etc/centrimo_template.js
--- a/etc/centrimo_template.js	Wed May 30 00:41:54 2012 -0700
+++ b/etc/centrimo_template.js	Fri Jun 08 11:56:30 2012 +1000
@@ -673,8 +673,8 @@
 function make_link(text, url) {
   var textNode = null;
   var link = null;
-  if (text) textNode = document.createTextNode(text);
-  if (url) {
+  if (typeof text !== "undefined" && text !== null) textNode = document.createTextNode(text);
+  if (typeof url === "string") {
     if (url.indexOf("//") == -1) {
       url = "http://" + url;
     }
@@ -707,7 +707,7 @@
 function add_cell(row, node, cls) {
   var cell = row.insertCell(row.cells.length);
   if (node) cell.appendChild(node);
-  if (cls) cell.className = cls;
+  if (typeof cls === "string") cell.className = cls;
 }
 
 /*
@@ -717,7 +717,7 @@
  */
 function add_text_cell(row, text, cls) {
   var node = null;
-  if (text) node = document.createTextNode(text);
+  if (typeof text !== "undefined" && text !== null) node = document.createTextNode(text);
   add_cell(row, node, cls);
 }
 
@@ -1039,7 +1039,10 @@
         sum += sites[j + k] * weights[k];
       }
       var avg = sum / total_weight;
-      var prob = avg / motif['total_sites'];
+      var prob = 0;
+      if (motif['total_sites'] > 0) {
+        prob = avg / motif['total_sites'];
+      }
       y.push(prob);
       x.push(xpos);
     }
@@ -1075,7 +1078,10 @@
         sum += sites[j + k];
       }
       var avg = sum / windo;
-      var prob = avg / motif['total_sites'];
+      var prob = 0;
+      if (motif['total_sites'] > 0) {
+        prob = avg / motif['total_sites'];
+      }
       y.push(prob);
       x.push(xpos);
     }
diff -r 2c18ee5e1d26 -r 7fb10f3c51c6 scripts/centrimo_webservice.pl.in
--- a/scripts/centrimo_webservice.pl.in	Fri Jun 08 11:56:30 2012 +1000
+++ b/scripts/centrimo_webservice.pl.in	Fri Jun 08 14:56:00 2012 +1000
@@ -196,7 +196,7 @@
 push(@centrimo_args, '--bgfile', $bfile) if (defined($bfile));
 push(@centrimo_args, '--score', $score) if (defined($score));
 push(@centrimo_args, '--ethresh', $e_thresh) if (defined($e_thresh));
-push(@centrimo_args, '--maxwin', $max_win) if (defined($max_win));
+push(@centrimo_args, '--maxbin', $max_win) if (defined($max_win));
 push(@centrimo_args, '-dfile', 'description') if (-e 'description');
 push(@centrimo_args, $sequences, @motifs);
 add_status_msg('Starting centrimo<br><code>' . stringify_args('centrimo', @centrimo_args) . '</code>', $msg_list);
diff -r fb056baf2bbe -r 8041784fd840 src/ceqlogo.c
--- a/src/ceqlogo.c	Fri Jun 08 19:50:08 2012 -0700
+++ b/src/ceqlogo.c	Tue Jun 12 16:15:34 2012 +1000
@@ -2471,7 +2471,7 @@
     }
   }
     if(params->l_num == 0)
-      CL_error("Input file is not specified!\n");
+      CL_error("No motifs loaded! Did you specify an input file?\n");
   CL_exit(params, outfile);
   LP_free(params);
 }
diff -r fb056baf2bbe -r 8041784fd840 src/motif-in-meme-text.c
--- a/src/motif-in-meme-text.c	Fri Jun 08 19:50:08 2012 -0700
+++ b/src/motif-in-meme-text.c	Tue Jun 12 16:15:34 2012 +1000
@@ -1231,6 +1231,7 @@
     }
     i++; // step over the newline
   }
+  if (size == 0 && end) dispatch_line(parser, chunk, size, end);
 }
 
 short mtext_has_format_match(void *data) {
diff -r 8041784fd840 scripts/metatest.pl.in
--- a/scripts/metatest.pl.in	Tue Jun 12 16:15:34 2012 +1000
+++ b/scripts/metatest.pl.in	Wed Jun 13 11:32:54 2012 +1000
@@ -378,7 +378,7 @@
   # centrimo smoke test
   $test_results += &smoke_test($update, $continue, $cleanup,
     'centrimo', '',
-    ['-verbosity', 1, '-oc', 'results/centrimo', 
+    ['-verbosity', 1, '-oc', 'results/centrimo', '-flip', 
       '../doc/examples/sample-dna-Klf1.fa', 'centrimo/dreme-Klf1.txt'],
     [
       {
--- a/doc/psp-gen.xml	2012-06-26 15:38:53.000000000 -0700
+++ b/doc/psp-gen.xml	2012-06-22 10:23:30.000000000 -0700
@@ -431,13 +431,9 @@
   ambiguous characters:
   <ul>
     <li><i>ambiguous characters in the sequence data</i>:
-    if you use <code>-arbitraryOK</code>, for
-    DNA, <code>N</code> is recognized as standing for any letter; for
-    protein, <code>B</code>, <code>J</code>, <code>Z</code>
-    and <code>X</code> are recognized as ambiguous. In either case,
-    the effect of encountering any of these letters is to score a word
-    or triple containing them as zero (default: ambiguous characters
-    cause error termination).
+    The effect of encountering any of these letters is to score a word
+    or triple containing them as if it only occurs once, to minimize its
+    score.
     </li>
     <li><i>treat specific letters as equivalent</i>: use
     the <code>-equiv</code> option to treat specific groups of letters
@@ -522,7 +518,7 @@
 command line reproduces this run:
 </p>
 <pre>
-time psp-gen -neg pos60k.fasta -pos neg60k.fasta -alpha prot -minw 3 -maxw 50 -arbitraryOK -triples > priors60kmaxw50.psp
+time psp-gen -neg pos60k.fasta -pos neg60k.fasta -alpha prot -minw 3 -maxw 50 -triples > priors60kmaxw50.psp
 </pre>
 
 <p>
@@ -531,10 +527,10 @@
 
 <ul>
 <li>
-Any letters in sequence represening ambiguous bases result in a word
-(<i>w</i>-mer) containing that word (or triple in the case of protein)
-being counted whether in the positive or negative sets as if it
-occurred once.
+Any letters in sequence represening ambiguous bases or amino acids
+result in a word (<i>w</i>-mer) containing that word (or triple in
+the case of protein) being counted whether in the positive or
+negative sets as if it occurred once, to minimize its score.
 </li>
 </ul>
 
--- a/scripts/meme_webservice.pl.in	2012-06-26 15:38:49.000000000 -0700
+++ b/scripts/meme_webservice.pl.in	2012-06-25 17:05:11.000000000 -0700
@@ -198,7 +198,7 @@
   my $psp_minw = $minw < $MINPSPW ? $MINPSPW : $minw;
   my $psp_maxw = $maxw > $MAXPSPW ? $MAXPSPW : $maxw;
   my @pspgen_args = ('-pos', $sequences, '-neg', $negfile, '-alpha', $psp_alph, 
-    '-minw', $psp_minw, '-maxw', $psp_maxw, '-arbitraryOK');
+    '-minw', $psp_minw, '-maxw', $psp_maxw);
   push(@pspgen_args, '-maxrange', '-triples') if ($psp_alph eq 'prot');
   run_prog(
     PROG => 'psp-gen', 
